{
  "abstractText": "Interpretability and fairness are critical in computer vision and machine learning applications, in particular when dealing with human outcomes, e.g. inviting or not inviting for a job interview based on application materials that may include photographs. One promising direction to achieve fairness is by learning data representations that remove the semantics of protected characteristics, and are therefore able to mitigate unfair outcomes. All available models however learn latent embeddings which comes at the cost of being uninterpretable. We propose to cast this problem as data-to-data translation, i.e. learning a mapping from an input domain to a fair target domain, where a fairness definition is being enforced. Here the data domain can be images, or any tabular data representation. This task would be straightforward if we had fair target data available, but this is not the case. To overcome this, we learn a highly unconstrained mapping by exploiting statistics of residuals \u2013 the difference between input data and its translated version \u2013 and the protected characteristics. When applied to the CelebA dataset of face images with gender attribute as the protected characteristic, our model enforces equality of opportunity by adjusting the eyes and lips regions. Intriguingly, on the same dataset we arrive at similar conclusions when using semantic attribute representations of images for translation. On face images of the recent DiF dataset, with the same gender attribute, our method adjusts nose regions. In the Adult income dataset, also with protected gender attribute, our model achieves equality of opportunity by, among others, obfuscating the wife and husband relationship. Analyzing those systematic changes will allow us to scrutinize the interplay of fairness criterion, chosen protected characteristics, and prediction performance.",
  "authors": [
    {
      "affiliations": [],
      "name": "Novi Quadrianto"
    },
    {
      "affiliations": [],
      "name": "Viktoriia Sharmanska"
    },
    {
      "affiliations": [],
      "name": "Oliver Thomas"
    }
  ],
  "id": "SP:9226698833420942935d488c134c0b6e66051020",
  "references": [
    {
      "authors": [
        "Alekh Agarwal",
        "Alina Beygelzimer",
        "Miroslav Dudik",
        "John Langford",
        "Hanna Wallach"
      ],
      "title": "A reductions approach to fair classification",
      "venue": "In International Conference on Machine Learning (ICML),",
      "year": 2018
    },
    {
      "authors": [
        "Alex Beutel",
        "Jilin Chen",
        "Zhe Zhao",
        "Ed H. Chi"
      ],
      "title": "Data decisions and theoretical implications when adversarially learning fair representations",
      "venue": "CoRR, abs/1707.00075,",
      "year": 2017
    },
    {
      "authors": [
        "Elizabeth Brown",
        "David I Perrett"
      ],
      "title": "What gives a face its gender",
      "venue": "Perception, 22(7):829\u2013840,",
      "year": 1993
    },
    {
      "authors": [
        "V. Bruce",
        "A. Burton",
        "E. Hanna",
        "P. Healey",
        "O. Mason",
        "A. Coombes",
        "R. Fright",
        "A. Linney"
      ],
      "title": "Sex discrimination: how do we tell the difference between male and female",
      "venue": "faces? Perception,",
      "year": 1993
    },
    {
      "authors": [
        "Flavio Calmon",
        "Dennis Wei",
        "Bhanukiran Vinzamuri",
        "Karthikeyan Natesan Ramamurthy",
        "Kush R Varshney"
      ],
      "title": "Optimized pre-processing for discrimination prevention",
      "venue": "In Advances in Neural Information Processing Systems (NIPS),",
      "year": 2017
    },
    {
      "authors": [
        "Yunjey Choi",
        "Minje Choi",
        "Munyoung Kim",
        "Jung-Woo Ha",
        "Sunghun Kim",
        "Jaegul Choo"
      ],
      "title": "Stargan: Unified generative adversarial networks for multi-domain image-to-image translation",
      "venue": "In Computer Vision and Pattern Recognition (CVPR),",
      "year": 2018
    },
    {
      "authors": [
        "A. Chouldechova"
      ],
      "title": "Fair prediction with disparate impact: A study of bias in recidivism prediction instruments",
      "venue": "Big data,",
      "year": 2017
    },
    {
      "authors": [
        "Finale Doshi-Velez",
        "Been Kim"
      ],
      "title": "Towards a rigorous science of interpretable machine learning",
      "venue": "CoRR, abs/1702.08608,",
      "year": 2017
    },
    {
      "authors": [
        "Cynthia Dwork",
        "Christina Ilvento"
      ],
      "title": "Fairness under composition",
      "venue": "In Innovations in Theoretical Computer Science (ITCS),",
      "year": 2019
    },
    {
      "authors": [
        "Harrison Edwards",
        "Amos Storkey"
      ],
      "title": "Censoring representations with an adversary",
      "venue": "In International Conference in Learning Representations (ICLR),",
      "year": 2016
    },
    {
      "authors": [
        "Sorelle A. Friedler",
        "Carlos Scheidegger",
        "Suresh Venkatasubramanian",
        "Sonam Choudhary",
        "Evan P. Hamilton",
        "Derek Roth"
      ],
      "title": "A comparative study of fairness-enhancing interventions in machine learning",
      "venue": "CoRR, abs/1802.04422,",
      "year": 2018
    },
    {
      "authors": [
        "Siyao Fu",
        "Haibo He",
        "Zeng-Guang Hou"
      ],
      "title": "Learning race from face: A survey",
      "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence (TPAMI),",
      "year": 2014
    },
    {
      "authors": [
        "Yaroslav Ganin",
        "Evgeniya Ustinova",
        "Hana Ajakan",
        "Pascal Germain",
        "Hugo Larochelle",
        "Fran\u00e7ois Laviolette",
        "Mario Marchand",
        "Victor Lempitsky"
      ],
      "title": "Domain-adversarial training of neural networks",
      "venue": "Journal of Machine Learning Research (JMLR),",
      "year": 2016
    },
    {
      "authors": [
        "Jacob R Gardner",
        "Paul Upchurch",
        "Matt J Kusner",
        "Yixuan Li",
        "Kilian Q Weinberger",
        "Kavita Bala",
        "John E Hopcroft"
      ],
      "title": "Deep manifold traversal: Changing labels with convolutional features",
      "venue": "In European Conference on Computer Vision (ECCV),",
      "year": 2016
    },
    {
      "authors": [
        "Leon A. Gatys",
        "Alexander S. Ecker",
        "Matthias Bethge"
      ],
      "title": "A neural algorithm of artistic style",
      "venue": "CoRR, abs/1508.06576,",
      "year": 2015
    },
    {
      "authors": [
        "Arthur Gretton",
        "Karsten M. Borgwardt",
        "Malte J. Rasch",
        "Bernhard Sch\u00f6lkopf",
        "Alexander Smola"
      ],
      "title": "A kernel twosample test",
      "venue": "Journal of Machine Learning Research (JMLR),",
      "year": 2012
    },
    {
      "authors": [
        "Arthur Gretton",
        "Olivier Bousquet",
        "Alexander J. Smola",
        "Bernhard Sch\u00f6lkopf"
      ],
      "title": "Measuring statistical dependence with Hilbert-Schmidt norms",
      "venue": "In Algorithmic Learning Theory ALT,",
      "year": 2005
    },
    {
      "authors": [
        "N. Grgic-Hlaca",
        "E. Redmiles",
        "K.P. Gummadi",
        "A. Weller"
      ],
      "title": "Human perceptions of fairness in algorithmic decision making: A case study of criminal risk prediction",
      "venue": "In The Web Conference (WWW),",
      "year": 2018
    },
    {
      "authors": [
        "Moritz Hardt",
        "Eric Price",
        "Nati Srebro"
      ],
      "title": "Equality of opportunity in supervised learning",
      "venue": "In Advances in Neural Information Processing Systems (NIPS) 29,",
      "year": 2016
    },
    {
      "authors": [
        "Kaiming He",
        "Xiangyu Zhang",
        "Shaoqing Ren",
        "Jian Sun"
      ],
      "title": "Deep residual learning for image recognition",
      "venue": "In Computer Vision and Pattern Recognition (CVPR),",
      "year": 2016
    },
    {
      "authors": [
        "P. Isola",
        "J.-Y. Zhu",
        "T. Zhou",
        "A.A. Efros"
      ],
      "title": "Image-to-image translation with conditional adversarial networks",
      "venue": "In Computer Vision and Pattern Recognition (CVPR),",
      "year": 2017
    },
    {
      "authors": [
        "Justin Johnson",
        "Alexandre Alahi",
        "Li Fei-Fei"
      ],
      "title": "Perceptual losses for real-time style transfer and super-resolution",
      "venue": "In European Conference on Computer Vision (ECCV),",
      "year": 2016
    },
    {
      "authors": [
        "Faisal Kamiran",
        "Toon Calders"
      ],
      "title": "Data preprocessing techniques for classification without discrimination",
      "venue": "Knowledge and Information Systems,",
      "year": 2012
    },
    {
      "authors": [
        "Diederik P Kingma",
        "Jimmy Ba"
      ],
      "title": "Adam: A method for stochastic optimization",
      "venue": "In International Conference on Learning Representations (ICLR),",
      "year": 2014
    },
    {
      "authors": [
        "Jon M. Kleinberg",
        "Sendhil Mullainathan",
        "Manish Raghavan"
      ],
      "title": "Inherent trade-offs in the fair determination of risk",
      "venue": "scores. CoRR,",
      "year": 2016
    },
    {
      "authors": [
        "Gil Levi",
        "Tal Hassner"
      ],
      "title": "Age and gender classification using convolutional neural networks",
      "venue": "In Computer Vision and Pattern Recognition Workshops (CVPRW),",
      "year": 2015
    },
    {
      "authors": [
        "Ziwei Liu",
        "Ping Luo",
        "Xiaogang Wang",
        "Xiaoou Tang"
      ],
      "title": "Deep learning face attributes in the wild",
      "venue": "In International Conference on Computer Vision (ICCV),",
      "year": 2015
    },
    {
      "authors": [
        "David Lopez-Paz",
        "Robert Nishihara",
        "Soumith Chintala",
        "Bernhard Sch\u00f6lkopf",
        "L\u00e9on Bottou"
      ],
      "title": "Discovering causal signals in images",
      "venue": "In Computer Vision and Pattern Recognition (CVPR),",
      "year": 2017
    },
    {
      "authors": [
        "Christos Louizos",
        "Kevin Swersky",
        "Yujia Li",
        "Max Welling",
        "Richard Zemel"
      ],
      "title": "The variational fair autoencoder",
      "venue": "In International Conference on Learning Representations (ICLR),",
      "year": 2016
    },
    {
      "authors": [
        "David Madras",
        "Elliot Creager",
        "Toniann Pitassi",
        "Richard S. Zemel"
      ],
      "title": "Learning adversarially fair and transferable representations",
      "venue": "In International Conference on Machine Learning (ICML),",
      "year": 2018
    },
    {
      "authors": [
        "Aravindh Mahendran",
        "Andrea Vedaldi"
      ],
      "title": "Understanding deep image representations by inverting them",
      "venue": "In Computer Vision and Pattern Recognition (CVPR),",
      "year": 2015
    },
    {
      "authors": [
        "Mehdi Mirza",
        "Simon Osindero"
      ],
      "title": "Conditional generative adversarial nets",
      "venue": "CoRR, abs/1411.1784,",
      "year": 2014
    },
    {
      "authors": [
        "Joris Mooij",
        "Dominik Janzing",
        "Jonas Peters",
        "Bernhard Sch\u00f6lkopf"
      ],
      "title": "Regression by dependence minimization and its application to causal inference in additive noise models",
      "venue": "In International Conference on Machine Learning (ICML),",
      "year": 2009
    },
    {
      "authors": [
        "Novi Quadrianto",
        "Viktoriia Sharmanska"
      ],
      "title": "Recycling privileged learning and distribution matching for fairness",
      "venue": "In Advances in Neural Information Processing Systems (NIPS),",
      "year": 2017
    },
    {
      "authors": [
        "Ali Rahimi",
        "Benjamin Recht"
      ],
      "title": "Random features for largescale kernel machines",
      "venue": "In Advances in Neural Information Processing Systems (NIPS),",
      "year": 2008
    },
    {
      "authors": [
        "K. Simonyan",
        "A. Zisserman"
      ],
      "title": "Very deep convolutional networks for large-scale image recognition",
      "venue": "In International Conference on Learning Representations (ICLR),",
      "year": 2015
    },
    {
      "authors": [
        "Le Song",
        "Alex Smola",
        "Arthur Gretton",
        "Justin Bedo",
        "Karsten Borgwardt"
      ],
      "title": "Feature selection via dependence maximization",
      "venue": "Journal of Machine Learning Research (JMLR),",
      "year": 2012
    },
    {
      "authors": [
        "Dmitry Ulyanov",
        "Vadim Lebedev",
        "Andrea Vedaldi",
        "Victor S. Lempitsky"
      ],
      "title": "Texture networks: Feed-forward synthesis of textures and stylized images",
      "venue": "In International Conference on Machine Learning (ICML),",
      "year": 2016
    },
    {
      "authors": [
        "Dmitry Ulyanov",
        "Andrea Vedaldi",
        "Victor Lempitsky"
      ],
      "title": "Improved texture networks: Maximizing quality and diversity in feed-forward stylization and texture synthesis",
      "venue": "In Computer Vision and Pattern Recognition (CVPR),",
      "year": 2017
    },
    {
      "authors": [
        "Sandra Wachter",
        "Brent Mittelstadt",
        "Chris Russell"
      ],
      "title": "Counterfactual explanations without opening the black box: Automated decisions and the gdpr",
      "venue": "Harvard Journal of Law & Technology,",
      "year": 2018
    },
    {
      "authors": [
        "Working Group"
      ],
      "title": "Machine learning: the power and promise of computers that learn by example",
      "venue": "Technical report, The Royal Society,",
      "year": 2017
    },
    {
      "authors": [
        "Muhammad Bilal Zafar",
        "Isabel Valera",
        "Manuel Gomez- Rodriguez",
        "Krishna P. Gummadi"
      ],
      "title": "Fairness beyond disparate treatment & disparate impact: Learning classification without disparate mistreatment",
      "venue": "In International Conference on World Wide Web (WWW),",
      "year": 2017
    },
    {
      "authors": [
        "Richard S. Zemel",
        "Yu Wu",
        "Kevin Swersky",
        "Toni Pitassi",
        "Cynthia Dwork"
      ],
      "title": "Learning fair representations",
      "venue": "In International Conference on Machine Learning (ICML),",
      "year": 2013
    },
    {
      "authors": [
        "Brian Hu Zhang",
        "Blake Lemoine",
        "Margaret Mitchell"
      ],
      "title": "Mitigating unwanted biases with adversarial learning",
      "venue": "In Association for the Advancement of Artificial Intelligence (AAAI),",
      "year": 2018
    },
    {
      "authors": [
        "Jun-Yan Zhu",
        "Taesung Park",
        "Phillip Isola",
        "Alexei A. Efros"
      ],
      "title": "Unpaired image-to-image translation using cycleconsistent adversarial networks",
      "venue": "In International Conference on Computer Vision (ICCV),",
      "year": 2017
    }
  ],
  "sections": [
    {
      "heading": "1. Introduction",
      "text": "Machine learning systems are increasingly used by government agencies, businesses, and other organisations to as-\n\u2217Also with Higher School of Economics, Moscow, Russia\nsist in making life-changing decisions such as whether or not to invite a candidate to a job interview, or whether to give someone a loan. The question is how can we ensure that those systems are fair, i.e. they do not discriminate against individuals because of their gender, disability, or other personal (\u201cprotected\u201d) characteristics? For example, in building an automated system to review job applications, a photograph might be used in addition to other features to make an invite decision. By using the photograph as is, a discrimination issue might arise, as photographs with faces could reveal certain protected characteristics, such as gender, race, or age (e.g. [14, 5, 4, 29]). Therefore, any automated system that incorporates photographs into its decision process is at risk of indirectly conditioning on protected characteristics (indirect discrimination). Recent advances in learning fair representations suggest adversarial training as the means to hide the protected characteristics from the decision/prediction function [2, 49, 33]. All fair representation models, however, learn latent embeddings. Hence, the produced representations cannot be easily interpreted. They do not have the semantic meaning of the input that photographs, or education and training attainments, provide when we have job application data. If we want to encourage public conversations and productive public debates regarding fair machine learning systems [18], interpretability in how fairness is met is an integral yet overlooked ingredient.\nIn this paper we focus on representation learning models that can transform inputs to their fair representations and retain the semantics of the input domain in the transformed space. When we have image data, our method will make a semantic change to the appearance of an image to deliver a certain fairness criterion1. To achieve this, we perform a data-to-data translation by learning a mapping from data in a source domain to a target domain. Mapping from source to target domain is a standard procedure, and many methods are available. For example, in the image domain, if we have aligned source/target as training data, we can use the pix2pix method of [24], which is based on conditional generative adversarial networks (cGANs) [36]. Zhu et al.\u2019s\n1Examples of fairness criteria are equality of true positive rates (TPR), also called equality of opportunity [22, 47], between males and females.\nar X\niv :1\n81 0.\n06 75\n5v 2\n[ cs\n.L G\n] 1\n1 A\npr 2\n01 9\nCycleGAN [50] and Choi et al.\u2019s StarGAN [7] solve a more challenging setting in which only unaligned training examples are available. However, we can not simply reuse existing methods for source-to-target mapping because we do not have data in the target domain (e.g. fair images are not available; images by themselves can not be fair or unfair, it is only when they are coupled with a particular task that the concern of fairness arises).\nTo illustrate the difficulty, consider our earlier example of an automated job review system that uses photographs as part of an input. For achieving fairness, it is tempting to simply use GAN-driven methods to translate female face photos to male. We would require training data of female faces (source domain) and male faces (target domain), and only unaligned training data would be needed. This solution is however fundamentally flawed; who gets to decide that we should translate in this direction? Is it fairer if we translate male faces to female instead? An ethically grounded approach would be to translate both male and female face photos (source domain) to appropriate middle ground face photos (target domain). This challenge is actually multidimensional, it contains at least two sub-problems: a) how to have a general approach that can handle image data as well as tabular data (e.g. work experience, education, or even semantic attribute representations of photographs), and b) how to find a middle-ground with a multi-value (e.g. race) or continuous value (e.g. age) protected characteristic or even multiple characteristics (e.g. race and age).\nWe propose a solution to the multi-dimensional challenge described above by exploiting statistical (in)dependence between translated images and protected characteristics. We use the Hilbert-Schmidt norm of the cross-covariance operator between reproducing kernel Hilbert spaces of image features and protected characteristics (Hilbert-Schmidt independence criterion [20]) as an empirical estimate of statistical independence. This flexible measure of independence allows us to take into account higher order independence, and handle a multi-/continuous value and multiple protected characteristics. Related work We focus on expanding the related topic of learning fair, albeit uninterpretable, representations. The aim of fair representation learning is to learn an intermediate representation of the data that preserves as much information about the data as possible, while simultaneously removing protected characteristic information such as age and gender. Zemel et al. [48] learn a probabilistic mapping of the data point to a set of latent prototypes that is independent of protected characteristic (equality of acceptance rates, also called a statistical parity criterion), while retaining as much class label information as possible. Louizos et al. [32] extend this by employing a deep variational auto-encoder (VAE) framework for finding the fair latent representation. In recent years, we see increased adver-\nsarial learning methods for fair representations. Ganin et al. [15] propose adversarial representation learning for domain adaptation by requiring the learned representation to be indiscriminate with respect to differences in the domains. Multiple data domains can be translated into multiple demographic groups. Edwards and Storkey [12] make this connection and propose adversarial representation learning for the statistical parity criterion. To achieve other notions of fairness such as equality of opportunity, Beutel et al. [2] show that the adversarial learning algorithm of Edwards and Storkey [12] can be reused but we only supply training data with positive outcome to the adversarial component. Madras et al. [33] use a label-aware adversary to learn fair and transferable latent representations for the statistical parity as well as equality of opportunity criteria.\nNone of the above learn fair representations while simultaneously retaining the semantic meaning of the data. There is an orthogonal work on feature selection using human perception of fairness (e.g. [21]), while this approach undoubtedly retains the semantic meaning of tabular data, it has not been generalized to image data. In an independent work to ours, Sattigeri et al. [40] describe a similar motivation of producing fair representations in the input image domain; their focus is on creating a whole new image-like dataset, rather than conditioning on each input image. Hence it is not possible to visualise a fair version for a given image as provided by our method (refer to Figures 2 and 3)."
    },
    {
      "heading": "2. Interpretability in Fairness by Residual Decomposition",
      "text": "We will use the illustrative example of an automated job application screening system. Given input data (photographs, work experience, education and training, personal skills, etc.) xn \u2208 X , output labels of performed well or not well yn \u2208 Y = {+1,\u22121}, and protected characteristic values, such as race or gender, sn \u2208 {A,B,C,D, . . .}, or age, sn \u2208 R, we would like to train a classifier f that decides whether or not to invite a person for an interview. We want the classifier to predict outcomes that are accurate with respect to yn but fair with respect to sn."
    },
    {
      "heading": "2.1. Fairness definitions",
      "text": "Much work has been done on mathematical definitions of fairness (e.g. [28, 8]). It is widely accepted that no single definition of fairness applies in all cases, but will depend on the specific context and application of machine learning models [18]. In this paper, we focus on the equality of opportunity criterion that requires the classifier f and the protected characteristic s be independent, conditional on the label being positive 2, in shorthand notation f \u22a5\u22a5 s | y = +1.\n2With binary labels, it is assumed that positive label is a desirable/advantaged outcome, e.g. expected to perform well at the job.\nExpressing the shorthand notation in terms of a conditional distribution, we have P(f(x)|s, y = +1) = P(f(x)|y = +1). With binary protected characteristic, this reads as equal true positive rates across the two groups, P(f(x) = +1|s = A, y = +1) = P(f(x) = +1|s = B, y = +1). Equivalently, the shorthand notation can also be expressed in terms of joint distributions, resulting in P(f(x), s|y = +1) = P(f(x)|y = +1)P(s|y = +1). The advantage of using the joint distribution expression is that the variable s does not appear as a conditioning variable, making it straightforward to use the expression for a multi- or continuous value or even multiple protected characteristics."
    },
    {
      "heading": "2.2. Residual decomposition",
      "text": "We want to learn a data representation x\u0303n for each input xn such that: a) it is able to predict the output label yn, b) it protects sn according to a certain fairness criterion, c) it lies in the same space as xn, that is x\u0303n \u2208 X . The third requirement ensures the learned representation to have the same semantic meaning as the input. For example, for images of people faces, the goal is to modify facial appearance in order to remove the protected characteristic information. For tabular data, we desire systematic changes in values of categorical features such as education (bachelors, masters, doctorate, etc.). Visualizing those systematic changes will give evidence on how our algorithm enforces a certain fairness criterion. This will be a powerful tool, albeit all the powers hinge on observational data, to scrutinize the interplay between fairness criterion, protected characteristics, and classification accuracy. We proceed by making the following decomposition assumption on x:\n\u03c6(x) = \u03c6(x\u0303) + \u03c6(x\u0302), (1)\nwith x\u0303 to be the component that is independent of s, x\u0302 denoting the component of x that is dependent on s, and \u03c6(\u00b7) is some pre-trained feature map. We will discuss about the specific choice of this pre-trained feature map for both image and tabular data later in the section. What we want is to learn a mapping from a source domain (input features) to a target domain (fair features with the semantics of the input domain), i.e. T : x \u2192 x\u0303, and we will parameterize this mapping T = T\u03c9 where \u03c9 is a class of autoencoding transformer network. For our architectural choice of transformer network, please refer to Section 3.\nTo enforce the decomposition structure in (1), we need to satisfy two conditions: a) x\u0303 to be independent of s, and b) x\u0302 to be dependent of s. Given a particular statistical dependence measure, the first condition can be achieved by minimizing the dependence measure between P = {\u03c6(x\u03031), . . . , \u03c6(x\u0303N )} = {\u03c6(T\u03c9(x1)), . . . , \u03c6(T\u03c9(xN ))} and S = {s1, . . . , sN}; N is the number of training data points. For the second condition, we first define a residual:\n\u03c6(x)\u2212 \u03c6(x\u0303) = \u03c6(x)\u2212 \u03c6(T\u03c9(x)) = \u03c6(x\u0302), (2)\nwhere the last term is the data component that is dependent on a protected characteristic s. We can then enforce the second condition by maximizing the dependence measure between R = {\u03c6(x\u03021), . . . , \u03c6(x\u0302N )} = {\u03c6(x1) \u2212 \u03c6(T\u03c9(x\n1)), . . . , \u03c6(xN ) \u2212 \u03c6(T\u03c9(xN ))} and S. We use the decomposition property as a guiding mechanism to learn the parameters \u03c9 of the transformer network T\u03c9 .\nIn the fair and interpretable representation learning task, we believe using residual is well-motivated because we know that our generated fair features should be somewhat similar to our input features. Residuals will make learning the transformer network easier. Taking into consideration that we do not have training data about the target fair features x\u0303, we should not desire the transformer network to take the input feature x and generate a new output x\u0303. Instead, it should just learn how to adjust our input x to produce the desired output x\u0303. The concept of residuals is universal, for example, a residual block has been used to speed up and to prevent over-fitting of a very deep neural network [23], and a residual regression output has been used to perform causal inference in additive noise models [37].\nFormally, given the N training triplets (X,S, Y ), to find a fair and interpretable representation x\u0303 = T\u03c9(x), our optimization problem is given by:\nminimize T\u03c9 N\u2211 n=1\nL(T\u03c9(xn), yn)\ufe38 \ufe37\ufe37 \ufe38 prediction loss +\u03bb1\nN\u2211 n=1\n\u2016xn \u2212 T\u03c9(xn)\u201622\ufe38 \ufe37\ufe37 \ufe38 reconstruction loss +\n+ \u03bb2 \u2212HSIC(R,S|Y = +1) + HSIC(P, S|Y = +1)\ufe38 \ufe37\ufe37 \ufe38 decomposition loss  (3)\nwhere HSIC(\u00b7, \u00b7) is the statistical dependence measure, and \u03bbi are trade-off parameters. HSIC is the Hilbert-Schmidt norm of the cross-covariance operator between reproducing kernel Hilbert spaces. This is equivalent to a nonparametric distance measure of a joint distribution and the product of two marginal distributions using the Maximum Mean Discrepancy (MMD) criterion[19]; MMD has been successfully used in fairnesss literature in it\u2019s own right [32, 38]. Section 2.1 discusses defining statistical independence based on a joint distribution, contrasting this with a conditional distribution. We use the biased estimator of HSIC [20, 42]: HSICemp. = (N \u2212 1)\u22122 trHKHL, where K,L \u2208 RN\u00d7N are the kernel matrices for the residual set R and the protected characteristic set S respectively, i.e. Kij = k(r\ni, rj) and Lij = l(si, sj) (similar definition for measuring independence between sets P and S). We use a Gaussian RBF kernel function for both k(\u00b7, \u00b7) and l(\u00b7, \u00b7). Moreover, Hij = \u03b4ij \u2212N\u22121 centres the observations of set R and set S in RKHS feature space. The prediction loss\nis defined using a softmax layer on the output of the transformer network. While in image data we add the total variation (TV) penalty [34] on the fair representation to ensure spatial smoothness, we do not enforce any regularization term for tabular data. In summary, we learn a new representation x\u0303 that removes statistical dependence on the protected characteristic s (by minimizing HSIC(P, S|Y = +1)) and enforces the dependence of the residual x \u2212 x\u0303 and s (by maximizing HSIC(R,S|Y = +1)). We can then train any classifier f using this new representation, and it will inherently satisfy the fairness criterion [33].\nNeural style transfer and pre-trained feature space Neural style transfer (e.g. [17, 25]) is a popular approach to perform an image-to-image translation. Our decomposition loss in (3) is reminiscent of a style loss used in neural style transfer models. The style loss is defined as the distance between second-order statistics of a style image and the translated image. Excellent results [17, 25, 43, 44] on neural style transfer rely on pre-trained features. Following this spirit, we also use a \u201cpre-trained\u201d feature mapping \u03c6(\u00b7) in defining our decomposition loss. For image data, we take advantage of the powerful representation of deep convolutional neural networks (CNN) to define the mapping function [17]. The feature maps of x in the layer l of a CNN are denoted by F lx \u2208 RNl\u00d7Ml where Nl is the number of the feature maps in the layer l and Ml is the height times the width of the feature map. We use the vectorization of F lx as the required mapping \u03c6(x) = vec(F l x). Several layers of a CNN will be used to define the full mapping (see Section 3). For tabular data, we use the following random Fourier feature [39] mapping \u03c6(x) = \u221a 2/D cos(\u3008\u03b8,x\u3009+ b) with a bias vector b \u2208 RD that is uniformly sampled in [0, 2\u03c0], and a matrix \u03b8 \u2208 Rd\u00d7D where \u03b8ij is sampled from a Gaussian distribution. We have assumed the input data lies in a d-dimensional space, and we transform them to a D-dimensional space."
    },
    {
      "heading": "3. Experiments",
      "text": "We gave an illustrative example about screening job applications, however, no such data is publicly available. We will instead use publicly available data to simulate the setting. We conduct the experiments using three datasets: the CelebA image dataset3 [30], the Diversity in Faces (DiF) dataset 4 [35], and the Adult income dataset5 from the UCI repository [9]. The CelebA dataset has a total of 202, 599 celebrity images. The images are annotated with 40 attributes that reflect appearance (hair color and style, face shape, makeup, for example), emotional state (smiling),\n3http://mmlab.ie.cuhk.edu.hk/projects/CelebA.html 4https://www.research.ibm.com/\nartificial-intelligence/trusted-ai/diversity-in-faces/ 5https://archive.ics.uci.edu/ml/datasets/adult\ngender, attractiveness, and age. For this dataset, we use gender as a binary protected characteristic, and attractiveness as the proxy measure of getting invited for a job interview in the world of fame. We randomly select 20K images for testing and use the rest for training the model. The DiF dataset has only been introduced very recently and contains nearly a million human face images reflecting diversity in ethnicity, age and gender. We include preliminary results using 200K images for training and 200K images for testing our model on this dataset. The images are annotated with attributes such as race, gender and age (both continual and discretized into seven age groups) as well as facial landmarks and facial symmetry features. For this dataset, we use gender as a binary protected characteristic, and the discretized age groups as a predictive task. The Adult income dataset is frequently used to assess fairness methods. It comes from the Census bureau and the binary task is to predict whether or not an individual earns more than $50K per year. It has a total of 45, 222 data instances, each with 14 features such as gender, marital status, educational level, number of work hours per week. For this dataset, we follow [48] and consider gender as a binary protected characteristic. We use 28, 222 instances for training, and 15, 000 instances for testing. We enforce equality of opportunity as the fairness criteria throughout for the three experiments."
    },
    {
      "heading": "3.1. The Adult Income dataset",
      "text": "The focus is to investigate whether (Q1) our proposed fair and interpretable learning method performs on a par with state-of-the-art fairness methods, and whether (Q2) performing a tabular-to-tabular translation brings us closer to achieving interpretability in how fairness is being satisfied. We compare our method against an unmodified x using the following classifiers: 1) logistic regression (LR) and 2) support vector machine with linear kernel (SVM), We select the regularization parameter of LR and SVM over 6 possible values (10i for i \u2208 [0, 6]) using 3-fold cross validation. We then train classifiers 1\u20132 with the learned representation x\u0303 and with the latent embedding z of a state-of-the-art adversarial model described in Beutel et al. [2]. We also apply methods which reweigh the samples to simulate a balanced dataset with regard to the protected characteristic FairLearn [1] Fair Reduction 3-4 and Kamiran & Calders [26] Kamiran & Calders 5-6, optimized with both the cross-validated LR and SVM (1-2), giving (Fair Reduction LR), (Fair Reduction SVM), (Kamiran & Calders LR) and (Kamiran & Calders SVM) respectively. As a reference, we also compare with: 7) Zafar et al.\u2019s [47] fair classification method (Zafar et al.) that adds equality of opportunity directly as a constraint to the learning objective function. It has been shown that applying fairness constraints in succession as \u2018fair pipelines\u2019 do not enforce fairness [11, 3], as\nsuch, we only demonstrate (fair) classifier 7 on the unmodified x.\nBenchmarking We train our model for 50, 000 iterations using a network with 1 hidden layer of 40 nodes for both the encoder and decoder, with the encoded representation being 40 nodes. The predictor acts on the decoded output of this network. We set the trade-off parameters of the reconstruction loss (\u03bb1) and decomposition loss (\u03bb2) to 10\u22124 and 100 respectively. We then use this model to translate 10 different training and test sets into x\u0303. Using a modified version of the framework provided by Friedler et al. [13] we evaluate methods 1\u20136 using x and x\u0303 representations. To ensure consistency, we train the model of Beutel et al. [2] with the same architecture and number of iterations as our model.\nTable 1 shows the results of these experiments. Our interpretable representation, x\u0303 achieves similar fairness level to Beutel\u2019s state-of-the-art approach (Q1). Consistently, our representation x\u0303 promoted the fairness criterion (Eq. Opp. close to 0), with only a small penalty in accuracy.\nInterpretability We promote equality of opportunity for the positive class (actual salary > $50K). In Figure 1 we show the effect of learning a fair representation, showing\nchanges in the \u2018Relationship Status\u2019 and \u2018Race\u2019 features of samples that were incorrectly classified by an SVM as earning < $50K in x, but were correctly classified in x\u0303. The visualization can be used for understanding how representation methods adjust the data for fairness. For example in Figure 1 (left) we can see that our method deals with the notorious problem of a husband or wife relationship status being a direct proxy for gender (Q2). Our method recognises this across all repeats in an unsupervised manner and reduces the wife category which is associated with a negative prediction. Other categories that have less correlation with the protected characteristic, such as race, largely remain unmodified (Figure 1 (right))."
    },
    {
      "heading": "3.2. The CelebA dataset",
      "text": "Our intention here is to investigate whether (Q3) performing an image-to-image translation brings us closer to achieving interpretability in how fairness is being satisfied, and whether (Q4) using semantic attribute representations of images reinforces similar interpretability conclusions as using image features directly.\nImage-to-image translation Our autoencoder network\ntranslated\nresidual\nFigure 2. Examples of the translated and residual images on CelebA from the protected group of males (minority group) that have been classified correctly (as attractive) after transformation. These results are obtained with the transformer network for imageto-image translation. Best viewed in color.\ndomain Acc. Eq. Opp. TPR TPR X \u2191 \u2193 female male\n1: orig. x images 80.6 33.8 90.8 57.0 2: orig. x attributes 79.1 39.9 90.8 50.9 3: fair x\u0303 images a: \u03bb2 = 1.00, biased HSIC 79.4 23.8 85.2 61.4 b: \u03bb2 = 10.0, biased HSIC 80.3 22.8 85.6 62.7 c: \u03bb2 = 10.0, unbiased HSIC 80.2 18.7 84.3 65.6 4: fair x\u0303 attributes 75.9 12.4 87.2 74.8 5: fair x\u0303 fake images 78.5 23.0 87.5 64.5\nTable 2. Results on CelebA dataset using a variety of input domains. Prediction performance is measured by accuracy, and we use equality of opportunity, TPRs difference, as the fairness criterion. Here, domain of fake images (last row) denotes images synthesized by the StarGAN[7] model from the original images and their fair attribute representations. We boldface Eq. Opp. since this is the fairness criterion.\nis based on the architecture of the transformer network for neural style transfer [25] with three convolutional layers, five residual layers and three deconvolutional/upsampling layers in combination with instance weight normalization [44]. The transformer network produces the residual image using a non-linear tanh activation, which is then subtracted from the input image to form the translated fair image x\u0303. Similarly to neural style transfer [17, 16, 25], for computing the loss terms, we use the activations in the deeper layers of the 19-layered VGG19 network [41] as feature representations of both input and translated images. Specifically, we use activations in the conv3 1, conv4 1 and conv5 1 layers for computing the decomposition loss, the conv3 1 layer activations for the reconstruction loss, and the activations in the last convolutional layer pool 5 for the prediction loss and when evaluating the performance. Given a 176x176 color input image, we compute the activations at each layer mentioned earlier after ReLU, then we flatten and l2 normalize them to form features for the loss terms. In the HSIC estimates of the decomposition loss, we use a Gaussian RBF\nkernel k(x1, x2) = exp(\u2212\u03b3\u2016x1 \u2212 x2\u20162) width \u03b3 = 1.0 for image features, and \u03b3 = 0.5 for protected characteristics (as one over squared distance in the binary space). To compute the decomposition loss, we add the contributions across the three feature layers. We set the trade-off parameters \u03bb1 and \u03bb2 of the reconstruction loss and the decomposition loss, respectively, to 1.06, and the TV regularization strength to 10\u22123. Training was carried out for 50 epochs with a batch size of 80 images. We use minibatch SGD and apply the Adam solver [27] with learning rate 10\u22123; our TensorFlow implementation is publicly available7.\nBenchmarking and interpretability We enforce equality of opportunity as the fairness criterion, and we consider attractiveness as the positive label. Attractiveness is what could give someone a job opportunity or an advantaged outcome as defined in [22]. To test the hypothesis that we have learned a fairer image representation, we compare the performance and fairness of a standard SVM classifier trained using original images and the translated fair images. We use activation in the pool 5 layer of the VGG19 network as features for training and evaluating the classifier8.\nWe report the quantitative results of this experiment in Table 2 (first and third rows) and the qualitative evaluations of image-to-image translations in Figure 2. From the Table 2 it is clear that the classifier trained on fair/translated images x\u0303 has improved over the classifier trained on the original images x in terms of equality of opportunity (reduction from 33.8 to 23.8) while maintaining the prediction accuracy (79.4 comparing to 80.6). The reduction in equality of opportunity can be further improved by increasing the parameter \u03bb2 to 10.0 (third row (b)), and by using unbiased estimator of HSIC (third row (c)). Looking at the TPR values across protected features (females and males), we can see that the male TPR value has increased, but it has an opposite effect for females. In the CelebA dataset, the proportion of attractive to unattractive males is around 30% to 70%, and it is opposite for females; male group is therefore the minority group in this problem. Our method achieves better equality of opportunity measure than the baseline by increasing the minority group TPR value while decreasing the majority group TPR value. To understand the balancing mechanism of TPR values (Q3), we visualize a subset of test male images that have been classified correctly as attractive after transformation (those examples were misclassified in the original domain) in Figure 2.\n6We also try \u03bb2 = 10.0 to further enforce equality of opportunity, and use the unbiased estimator of HSIC [42].\n7https://github.com/predictive-analytics-lab/ Data-Domain-Fairness\n8We deliberately evaluate the performance (accuracy and fairness) using an auxiliary classifier instead of using the predictor of the transformer network. Since the emphasis of this work is on representation learning, we should not prescribe what classifier the user chooses on top of learned representation.\ninput\noutput\nFigure 3. Results of our approach (image-to-image translation via attributes). Given N i.i.d. samples {(xn, yn)}Nn=1, our method transforms them into a new fair dataset {(x\u0303n, yn)}Nn=1 where (x\u0303n, yn) is the fair version of (xn, yn). The synthesized images are produced by the StarGAN model [7] conditioned on the original images and their fair attribute representation.\nFigure 4. Results of Fainess GAN [40] (Fig.2) of non-attractive (left) and attractive (right) males after pre-processing. Given N i.i.d. samples {(xn, yn)}Nn=1, Fainess GAN transforms them into a new fair dataset {(x\u0303n, y\u0303n)}N \u2032 n=1 where N \u2032 6= N and (x\u0303n, y\u0303n) has no correspondence to (xn, yn).\nWe observe a consistent localized area in face, specifically lips and eyes regions. The CelebA dataset has a large diversity in visual appearance of females and males (hair style, hair color) and their ethnic groups, so more localized\nfacial areas have to be discovered to equalize TPR values across groups. Lips are very often coloured in female (the majority group) celebrity faces, hence our method, to increase the minority group TPR value, colorizes the lip regions of the minority group (males). Interestingly, female faces without prominent lipstick often got this transformation as well, prompting the decrease in the majority group TPR value. Regarding eye regions, several studies (e.g. [4] and references therein) have shown their importance in gender identification. Also, a heavy makeup that is often applied to female celebrity eyes can also support our visualization in Figure 2.\nThe image-to-image translation using transformer network learns to produce coarse-grained changes, i.e. masking/colorizing face regions. This is expected as we learn a highly unconstrained mapping from source to target domain, in which the target data is unavailable. To enable fine-grained changes and semantic transformation of the images, we now explore semantic attributes; attributes are well-established interpretable mid-level representations for images. We show how an attribute-to-attribute translation provides an alternative way in analysing and performing an image-to-image translation.\nAttribute-to-attribute translation Images in the CelebA dataset come with 40 dimensional binary attribute annotations. We use all but two attributes (gender and attractiveness) as semantic attribute representation of images. We then perform attribute-to-attribute translation with the transformer network and consider the same attractive versus not attractive task and gender protected characteristic as with the image data. We report the results of this experiment in Table 2 (second and forth rows correspond to the domain of attributes). First, we observe that the predictive performance of the classifier trained on attribute representation is only slightly lower than the performance of the classifier trained on the image data (79.1 versus 80.6), which enables sensible comparison of the results in these two settings. Second, we observe better gain in equality of opportunity when using the transformed attribute representation comparing to transformed images (12.4 is the best Eq. Opp. result in this experiment). This comes at the cost of a drop in accuracy performance. The TPR rates for both groups are higher when using translated attribute representation than when using translated image representation (third row versus fourth row). The largest improvement of the TPR is observed in the group of males (from 50.9 in the original attribute to 74.8 in the translated attribute space). Further analysis of changes in attribute representation reveals that equality of opportunity is achieved by putting lipstick and heavy-makeup to the male group (Figure 5). These top 2 features have been mostly changed in the group of males. Very few changes happened in the group of females. This is encouraging as\nwe have just arrived at the same conclusion (Figures 2 and 5), be it using images or using semantic attributes (Q4).\nImage-to-image translation via attributes Given the remarkable progress that has been made in the field towards image synthesis with the conditional GAN models, we attempt to synthesize images with respect to the attribute description. Specifically, we use the StarGAN model [7], the state-of-the-art model for image synthesis with multi-attribute transformation, to synthesize images with our learned fair attribute representation. For this, we pre-train the StarGAN model to perform image transformations with 38 binary attributes (excluding gender and attractive attributes) using training data. We then translate all images in CelebA with respect to their fair attribute representation. We evaluate the performance of this approach and report the results in Table 2 (last row). We also include the qualitative evaluations of image-to-image translations via attributes in Figure 3. These visualizations essentially generalize counterfactual explanations in the sense of [45] to the image domain. We have just shown the \u201cclosest synthesized world\u201d, i.e. the smallest change to the world that can be made to obtain a desirable outcome. Overall, the classifier trained using this fair representation shows similar Eq. Opp. performance and comparable accuracy to the classifier trained on representation learned with the transformer network. However, the TPR rates for both protected groups are higher (last row versus third row), especially in the group of males, when using this representation.\nPre-processing approaches The aim of the preprocessing approaches such as [40, 6] is to transform the given dataset of N i.i.d. samples {(xn, yn)}Nn=1 into a new fair dataset {(x\u0303n, y\u0303n)}N \u2032n=1. It is important to note that N \u2032 is not necessarily equal to N , and therefore (x\u0303n, y\u0304n) has no correspondence to (xn, yn). [6] has proposed this approach for tabular (discrete) data, while [40] has explored image data. Here, we offer a unified framework for tabular (continuous and discrete) and image data that transforms the given dataset {(xn, yn)}Nn=1 into a new fair dataset {(x\u0303n, yn)}Nn=1 where (x\u0303n, yn) is the fair version of (xn, yn). What is the advantage of creating a fair representation per sample (our method) rather than on the whole dataset at once [40, 6]? The first can be used to provide an individual-level explanation of fair systems, while the latter can only be used to provide a system-level explanation. For comparison, we include here a snapshot of results presented in [40] using the CelebA dataset in Figure 4. The figure shows eigenfaces/eigensketches with the mean image of the new fair dataset {(x\u0303n)}N \u2032n=1 (in the center) of the 3 \u00d7 3 grid. No per sample visualisation (x\u0303n) was provided. Left/right/top/bottom images in Fig. 4 show variations along the first/second principal components. In contrast, Figure 3 shows a per sample visualisation (x\u0303n) using our proposed method."
    },
    {
      "heading": "3.3. The Diversity in Faces dataset",
      "text": "We extract and align face crops from the images and use 128x128 facial images as the inputs. Our preliminary experiment has similar setup to the image-to-image translation on the CelebA dataset except that the prediction task has seven age groups to be classified. As the fairness criterion we enforce equality of opportunity considering the middle age group (31-45) to be desirable (as the positive label when conditioning). As before, to test the hypothesis that we have learned a fairer image representation, we compare the performance and fairness of the SVM classifier trained using original images and the translated fair images (with features as activations in the pool 5 layer of the VGG19 network). We achieve 52.85 as the overall classification accuracy over seven age groups when using original image features and an increased 60.26 accuracy when using translated images. The equality of opportunity improved from 27.21 using original image representation to 9.85 using fair image representation. Similarly to the CelebA dataset, the image-toimage translation using transformer network learns to produce coarse-grained changes, i.e. masking/colorizing nose regions (as opposed to lips and eyes regions on CelebA). These preliminary results are encouraging and further analysis will be addressed as a future extension."
    },
    {
      "heading": "4. Discussion and Conclusion",
      "text": "It is not clear if fairness and interpretability\nare conflicting requirements. Reviewer #1\nThey are not, however interpretability in how fairness is enforced has so far been overlooked despite being an integral ingredient for encouraging productive public debates regarding fair machine learning systems. Interpretability in machine learning models can help to ascertain qualitatively whether fairness is met [46, 10]. This paper takes a step further and advocates interpretability to ascertain qualitatively how fairness is met, once we have agreed to enforce fairness (e.g. equality of opportunity) in machine learning models. We specifically focus on enforcing fairness in representation learning. Unlike other fair representation learning methods that learn latent embeddings, our method learns a representation that is in the same space as the original input data, therefore retaining the semantics of the input domain. Our method picks up consistently in 10 out of 10 repeated experiments whether a person is a husband or wife as a direct proxy for gender, and subsequently reduces the wife category which is associated with a negative prediction. In our experiments with people\u2019s faces, eyes and lips are considered to be the direct proxy for gender attractiveness, and nose regions for being in a certain age group. As a potential future direction, we plan to further analyze the interpretability in fairness using causal reasoning [31]."
    },
    {
      "heading": "Acknowledgments",
      "text": "NQ is supported by the UK EPSRC project EP/P03442X/1 and the Russian Academic Excellence Project\u2018 5-100\u2019. VS is supported by the Imperial College Research Fellowship. We gratefully acknowledge NVIDIA for GPUs donation and Amazon for AWS Cloud Credits."
    }
  ],
  "title": "Discovering Fair Representations in the Data Domain",
  "year": 2020
}
