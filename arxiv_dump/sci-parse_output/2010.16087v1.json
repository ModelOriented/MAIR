{
  "abstractText": "Clinical decision making about treatments and interventions based on personal characteristics leads to effective health improvement. Machine learning (ML) has been the central concern of the diagnosis support and disease prediction based on comprehensive patient information. Because the black-box problem in ML is serious for medical applications, explainable artificial intelligence (XAI) techniques to explain the reasons for ML models predictions have been focused. A remaining important issue in clinical situations is discovery of concrete and realistic treatment processes. This paper proposes an innovative framework to plan concrete treatment processes based on an ML model. A key point of our proposed framework is to evaluate an \u201cactionability\u201d of the treatment process using a stochastic surrogate model constructed through hierarchical Bayesian modeling. The actionability is an essential concept for suggesting a realistic treatment process, which leads to clinical applications for personal health improvement. This paper also presents two experiments to evaluate our framework. We first demonstrate the feasibility of our framework from the viewpoint of the methodology using a synthetic dataset. Subsequently, our framework is applied to an actual health checkup dataset, which comprises 3,132 participants, considering an application to improve systolic blood pressure values at a personal level. We confirmed that the computed treatment processes are actionable and consistent with clinical knowledge for lowering blood pressure. These results demonstrate that our framework can contribute to decision making in the medical field. Our framework can be expected to provide clinicians deeper insights by proposing concrete and actionable treatment process based on the ML model. * Address correspondence to: Kazuki Nakamura (nakamura.kazuki.88m@st.kyoto-u.ac.jp) or Yasushi Okuno (okuno.yasushi.4c@kyoto-u.ac.jp).",
  "authors": [
    {
      "affiliations": [],
      "name": "Kazuki Nakamura"
    },
    {
      "affiliations": [],
      "name": "Ryosuke Kojima"
    },
    {
      "affiliations": [],
      "name": "Eiichiro Uchino"
    },
    {
      "affiliations": [],
      "name": "Koichi Murashita"
    },
    {
      "affiliations": [],
      "name": "Ken Itoh"
    },
    {
      "affiliations": [],
      "name": "Shigeyuki Nakaji"
    },
    {
      "affiliations": [],
      "name": "Yasushi Okuno"
    }
  ],
  "id": "SP:91c1ccc6cdbce425f51dd05410923c35ff1d691f",
  "references": [
    {
      "authors": [
        "I.C. Yeh",
        "T.K. Hsu"
      ],
      "title": "Building real estate valuation models with comparative approach through case-based reasoning",
      "venue": "Applied Soft Computing Journal",
      "year": 2018
    },
    {
      "authors": [
        "R. Tibshirani",
        "I. Johnstone",
        "T. Hastie",
        "B. Efron"
      ],
      "title": "Least angle regression",
      "venue": "The Annals of Statistics 32,",
      "year": 2004
    },
    {
      "authors": [
        "T. Hastie",
        "Efron",
        "B. lars"
      ],
      "title": "Least Angle Regression, Lasso and Forward Stagewise",
      "venue": "R package version 1.2",
      "year": 2013
    }
  ],
  "sections": [
    {
      "text": "effective health improvement. Machine learning (ML) has been the central concern of the diagnosis support and disease prediction based on comprehensive patient information. Because the black-box problem in ML is serious for medical applications, explainable artificial intelligence (XAI) techniques to explain the reasons for ML models predictions have been focused. A remaining important issue in clinical situations is discovery of concrete and realistic treatment processes. This paper proposes an innovative framework to plan concrete treatment processes based on an ML model. A key point of our proposed framework is to evaluate an \u201cactionability\u201d of the treatment process using a stochastic surrogate model constructed through hierarchical Bayesian modeling. The actionability is an essential concept for suggesting a realistic treatment process, which leads to clinical applications for personal health improvement. This paper also presents two experiments to evaluate our framework. We first demonstrate the feasibility of our framework from the viewpoint of the methodology using a synthetic dataset. Subsequently, our framework is applied to an actual health checkup dataset, which comprises 3,132 participants, considering an application to improve systolic blood pressure values at a personal level. We confirmed that the computed treatment processes are actionable and consistent with clinical knowledge for lowering blood pressure. These results demonstrate that our framework can contribute to decision making in the medical field. Our framework can be expected to provide clinicians deeper insights by proposing concrete and actionable treatment process based on the ML model.\n* Address correspondence to: Kazuki Nakamura (nakamura.kazuki.88m@st.kyoto-u.ac.jp) or Yasushi Okuno (okuno.yasushi.4c@kyoto-u.ac.jp)."
    },
    {
      "heading": "Introduction",
      "text": "In health improvement, medically appropriate and also patient-acceptable decision making is beneficial for enhancing the quality of care1\u20133. Personal characteristics such as health, social environment, and preferences are promising clues for medical decisions about treatments and interventions4\u20136. Clinicians need to understand personal unique health conditions and make appropriate health improvement plans. Although decision making through patient\u2013clinician communication is important for early risk assessment and diagnosis7,8, it is difficult for time-constrained clinicians to consider personal complex factors; hence, tools to support clinical decision-making are desired9,10. Machine learning (ML) technology has been widely used in the medical field, especially for diagnosis support and disease prediction based on comprehensive patient information11\u201313. Unlike interpretable techniques such as classical statistical analysis and linear models, the black-box nature of high-predictive ML models, including ensemble learning and deep learning, is often a barrier to clinical decision-making applications14. Explainable artificial intelligence (XAI) has been increasing attention recently in the field of ML15. XAI is a research field on techniques that explain black-box ML predictions. A successful application of XAI in the medical field is to identify contributed factors of personal disease prediction using LIME and SHAP16\u201321. These methods achieve both predictive performance and individual interpretation by using an additional individual model, called surrogate model. Another important issue in clinical decision making is the development of personalized treatment plans for rational treatment22. However, these conventional methods merely explain the prediction reasons and cannot provide concrete treatment processes. For example, in the case of the hypertension prediction, although we can understand important features in the prediction, it is unclear what kind of actions will effectively improve the personal blood pressure in a set of candidate actions related to blood test data and body composition.\nThis paper proposes a novel framework for planning a concrete and actionable path for personal treatment based on predictions of an ML model. A key idea of our framework is to use a hierarchical Bayesian model as a surrogate model of a specified ML model. We call this surrogate model stochastic surrogate model. Our framework can evaluate the \u201cactionability\u201d of treatment processes, which was not considered in the conventional methods, by computing a probability of path using the stochastic surrogate model. Also, this stochastic surrogate model can assist high-predictive models to evaluate actionability while maintaining the predictive performance. The simultaneous computation of prediction and evaluating actionability yields an actionable treatment process, which leads to clinical applications for personal health improvement.\nThis paper also presents two experiments from different aspects. We first evaluated our proposed framework from the viewpoint of the methodology using a synthetic dataset related to a regression task. After that, we assessed our framework as a clinical application using an actual health checkup dataset. In this experiment, assuming a scenario for lowering blood pressure in individuals with high blood pressure, we calculated personal level paths and confirmed the consistency with clinical knowledge. To the best of our knowledge, this is the first study that made it possible to present concrete improvement paths based on the ML model using an actual health checkup dataset."
    },
    {
      "heading": "Results",
      "text": "Path planning framework using surrogate Bayesian model\nThis section describes the proposed framework (Fig. 1, Supplementary Figure S1). Our framework consisted of three steps. First, we built a regression model using ML methods. Note that we could select arbitrary high-performance models in this step. Next, the surrogate model of the regression model was constructed using hierarchical Bayesian modeling. Finally, path planning to find an actionable path for treatment was performed using the surrogate model."
    },
    {
      "heading": "Construction of regression model",
      "text": "In Step 1, a regression model was built from a dataset expressed as a table format, where columns consist of multiple explanatory variables and a response variable and rows represent instances (Fig. 1a). For example, a regression model for blood pressure value could be used to estimate the value of the response variable, i.e., blood pressure, from the value of explanatory variables such as the body composition data and blood test data. In our framework, we can use arbitrary algorithms, such as high-performance nonlinear algorithms, to construct the regression model.\nSurrogate model with hierarchical Bayesian modeling\nBased on the original data and the values predicted by the regression model in Step 1, a stochastic surrogate model was constructed in Step 2 using hierarchical Bayesian modeling (Fig. 1b, 2). This model was used to compute the probability of given values of explanatory and response variables to evaluate actionability in the next step. Note that this stochastic surrogate model represents a probability density on not only a given dataset but also virtually changed values, i.e., counterfactual values.\nPath planning using surrogate model In Step 3, an optimal health-improving treatment path was calculated for each instance using the surrogate model (Fig. 1c). The explanatory variables of an instance, such as body composition and blood test data, were hypothetically changed to improve the response variable predicted using the regression model. By using the surrogate model constructed in Step 2, we could calculate the probability of counterfactual values. In our framework, the optimal path was defined as a sequence of the counterfactual values with high probability in the surrogate model. This model therefore can avoid the non-optimal health-improving paths, e.g., shown in the red line in (Fig. 1c), where intermediate situations might be unrealistic.\nNodes in the graphical model are represented as follows: xcont, continuous explanatory variables; xdisc, discrete explanatory variables; y, response\nvariable predicted by regression model; z, mixture components; and others, prior distributions. Sk is a diagonal matrix with elements following\nCauchy distributions. RMSEtest in the equation represents a root-mean-squared error of the regression model. ymean and ystd represent mean and\nstandard deviation values of the predicted response variable, respectively.\nConsidering real applications, explanatory variables contain variables that cannot be changed by interventions like age. The appropriate subset of variables for the application should be determined. The explanatory variables for setting the counterfactual values were called intervention variables in this study. In our setting for path planning, the intervention variables were regarded as a grid graph, and a path is constituted by connecting the grid points (nodes). We defined a probability of the node as the probability of taking the node calculated using the surrogate model. Furthermore, the actionability was defined as the product of node probabilities on a specified path. Based on a breadth-first search, we obtained the most actionable path to the destination node, which achieves the most improved predictive value within the search iteration count L (detailed in the method section). Validation of framework on synthetic dataset\nWe evaluated our framework using a synthetic dataset to confirm that improvement paths with high actionability were planned. This synthetic dataset is generated from three 3D-normal distributions (Supplementary Figure S2). We built a regression model and subsequently constructed a surrogate model using hierarchical Bayesian modeling (Supplementary Figure S3a, b). The lowest widely applicable Bayesian information criterion (WBIC) value23 was obtained when the number of mixture components in the hierarchical Bayesian model was two. Details of the setting related to this model are given in the method section. Subsequently, we planned paths to decrease the value of the response variable using this surrogate model. All explanatory variables were selected for intervention variables and planned paths were more actionable than the baseline path (Supplementary Figure S3c). This baseline method for the baseline path is defined in the method section. The planned paths of two randomly selected instances are shown in Figure 3. We successfully demonstrated that our framework could plan paths to improve response variable values with high probabilities in our framework. These results showed the planned paths with high probabilities were discovered rather than the na\u00efve straight path connecting the initial node to the destination node. Regarding other instances not shown in this paper, the same tendency can be seen as in these examples.\nFor each instance, the optimal path for improving the response variable predicted by the machine learning model is represented. The order of\nthe explanatory variable change and the predicted value in the optimal path are shown in the left figures. In transition steps, the upward or\ndownward arrow represents a unit increase or decrease in the explanatory variable, respectively. Besides, 2D/3D-plots of the path are shown.\n(a) Instance 1: x1 and x2 were selected for the 2D-plot. (b) Instance 2: x2 and x3 were selected for the 2D-plot.\nApplication on actual health checkup dataset\nWe used the Iwaki Health Promotion Project (IHPP) dataset, an actual health checkup dataset, to demonstrate that the proposed framework can plan actionable paths for treatment. The IHPP has annually acquired a wide range of health checkup data that comprise the molecular biology, physiology, biochemistry, personal lifestyle, and socio-environment of participants. We considered a scenario to improve systolic blood pressure (SBP). Table 1 shows an overview of the IHPP dataset. Because the dataset comprised more than 2,000 measurement items, we reduced the explanatory variables before building a regression model in our framework. We excluded measurement items related to blood pressure from the explanatory variables. Furthermore, ambiguous items such as answers to questionnaires and items with 25% or more missing values were excluded. Subsequently, XGBoost-based recursive feature elimination (RFE) was performed to reduce the explanatory variables using the training data24. We applied one-hot encoding for categorical variables and replaced the missing values with the median for simplicity. RFE was performed with 5-fold cross-validation split by participants, and the explanatory variables were reduced to 25 (Fig. 4a; the details of the variables are described in Supplementary Table S1). Important features comprised items related to hypertension, such as age, body composition (leg score, BMI, and waist), blood glucose, and g-GTP25\u201333; therefore, the selected explanatory variables were considered to be reasonable for SBP predictive models from the clinical perspective.\nwhich is a more precise imputation method for missing values. To estimate multiple imputations, Bayesian ridge and random forest34 were used for continuous and discrete variables, respectively. Consequently, the regression model yielded a rootmean-squared error (RMSE) of 15.42 and an R-squared of 0.330 (Fig. 4b). Subsequently, hierarchical Bayesian modeling was performed to construct the surrogate model. The lowest WBIC was obtained when the number of mixture components was five (Fig. 4c). Path planning was performed using the surrogate model. As intervention variables, five variables that can be intervened were selected from the top of the feature importance: leg points, blood glucose, BMI, waist, and g-GTP. The unit cell size of the grid was set to 0.2-\u03c3 for each explanatory variable, where \u03c3 represents a standard deviation in the training data. Assuming a scenario to lower the SBP in participants with higher values, the instances were selected according to the following criteria: SBP above the mean + 1-\u03c3, and no missing values in the intervention variables. The number of applicable instances was 391. We performed the path search algorithm with L = 20,000 for each instance and acquired a path with the lowest predictive SBP value. For quantitative evaluation, we introduce the actionability score for each instance, which indicates how actionable the planned path was compared to the baseline path (detailed in the method section). The histogram of the actionability score is shown in Figure 4d. The actionability scores were greater than zero, i.e., planned paths were more actionable, in 341/391 instances, and the median was 0.78. This result suggested that even if the response variable value after improvement was the same, the path planned by our framework had a higher actionability than the baseline path in most cases.\nNext, we show the paths of three randomly selected instances (Fig. 5). The actual data scatters also support that the path was planned through areas with high node probabilities. In instance 1, it was shown that the path improving the values in the order of blood glucose, leg score, and g-GTP was more effective (Fig. 5a). These variables are related to each other, and the path in which multiple variables fluctuated to improve the blood pressure was reasonable35\u201337. In instance 2, the path improving the values in the order of g-GTP, leg score, and again g-GTP was more valid (Fig. 5b). The SBP values predicted by the regression model increased temporarily compared with the original SBP value. In instance 3, the optimal path was planned only based on the improvement of one explanatory variable, leg score (Fig. 5c). The actionability score shows zero because the optimal path was identical to the baseline path in such cases.\n(a) (b) (c) (d)"
    },
    {
      "heading": "Discussion",
      "text": "In this study, we proposed a framework for planning paths to improve the prediction values of ML models. We demonstrated that the proposed framework could plan paths through nodes with high probabilities using the synthetic dataset. Furthermore, our proposed framework was capable of planning actionable paths to improve the predicted SBP values in the actual health dataset. Our framework suggests realistic concrete treatment processes which are human-actionable in personal health improvement. Conventional XAI methods, such as LIME and SHAP, cannot provide concrete improvement paths.\nAs shown in Figure 5, our framework could visually present concrete improvement paths at a personal level. The paths mainly consisted of a sequence of changes in leg score, blood glucose, and g-GTP among the intervention variables. The direction of change in these variables was consistent with conventional clinical knowledge for improving blood pressure 27\u2013 33, e.g., high blood glucose level has been reported to be a risk factor of hypertension. Tool-assisted personal goal-settings are expected to help time-constrained clinicians and contribute to better health improvement in patients38. Our framework can provide clinicians with understandable and acceptable health improvement plans based on patient health data and given intervention variables, which is suitable for patient\u2013clinician collaborative decision making about health interventions.\nIn the remaining part of this section, we provide methodological considerations of the proposed framework. Although experiments were performed under specific settings, our framework has generality as a methodology from three perspectives. First, we used XGBoost to build the regression model to be explained. Because our framework operates in a model-agnostic manner, other high-performance regression models such as deep learning can be used. Second, although we assumed normal or categorical distributions for the explanatory variables in the hierarchical Bayesian modeling (Fig. 2), distributions can be selected according to the data. This is expected to apply to some extent with medical data, which is often accompanied by a significant amount of noise and missing values. Finally, we selected intervention variables from the top of feature importances and conducted path planning to vary them by specific units. According to patient preferences and environments, any variable can be selected as intervention variables, and the units for more finely measurable variables can be adjustable.\nOur objective in path planning was to obtain a path to the best-predicted value with the set conditions of the number of iterations L. In real situations, application-dependent or clinical constraints might exist. A typical case is that the values of explanatory and/or response variables should be less/more than the reference values in all nodes along the path. For example, there were cases where the predicted SBP values were temporarily increased from the original value in our experiment (Fig. 5b), which might be preferable to avoid in clinical situations. By slightly changing the path search condition to exclude unpreferable nodes, our framework can be applied to such cases. Another typical situation is that when the target value of the response variable is determined by guidelines or clinical knowledge, our framework can also be applied by modifying the termination conditions of the search to reach the target value.\nA theme to be addressed in expanding our framework is the high computational cost when many intervention variables exist or when calculating a long-term path for treatment. Under our experimental conditions, approximately 10 min was required for path planning per instance. A more practical path planning can be expected by combining our framework with techniques for finding intervention points, such as counterfactual explanations39\u201343. Counterfactual explanations usually present intervention goal values of the explanatory variables for changing the response variable without considering the intervention process. Our framework can plan actionable paths to the intervention goal values decided by counterfactual explanations. For this use case, a more efficient path planning algorithm, such as A* search algorithm, can be applied in our framework. As a topic similar to our approach to actionable path planning, studies to obtain intervention points with minimum costs have been performed in recent years43. These approaches enable a fast search by assuming linearity. Our framework is more suitable for use with sophisticated nonlinear ML models, i.e., in cases where linearity is difficult to assume, such as those pertaining to medical checkup data.\nOur study has some limitations. First, the health checkup dataset used in this study was obtained from a single area and had a small sample size. This may have contributed to the low prediction score of the SBP regression model (Fig. 4b). Although the dataset problem does not impair the validity of the proposed framework as a methodology, we performed supplementary experiments applying the framework on the public datasets to support the validity of our framework (Supplementary Information). Furthermore, we encountered a problem when verifying the clinical effectiveness of the paths planned using our framework. Although we evaluated that the change directions of intervention variables in some paths were consistent with clinical knowledge in Experiment 2, it is necessary to verify the effectiveness of the paths through a\nprospective cohort study to suit the real-world applications of our framework."
    },
    {
      "heading": "Conclusion",
      "text": "In this study, we proposed a novel framework to plan actionable health improvement processes at a personal level. Using the synthetic dataset, we proved that our framework could plan actionable paths through the nodes with high probabilities. Furthermore, we successfully demonstrated that health-improving paths planned for lowering blood pressure by applying our framework to the actual health checkup dataset were actionable, concrete, and consistent with clinical knowledge. Our framework can present reasonable and personalized health-improving processes based on ML model predictions in a wide range of situations, which is expected to contribute to decision making in the medical field. The prospective clinical validation of actionable paths planned using our framework should be performed in future studies. Our framework may provide clinicians deeper insights by proposing specific and actionable treatment paths based on the ML model."
    },
    {
      "heading": "Materials & methods",
      "text": "Synthetic 3D-dataset\nWe generated a simple 3D-dataset to verify whether our framework can plan paths by transiting the nodes with high probabilities in the variable space to improve the predicted response values of the ML model. The dataset was generated from three 3D-normal distributions to ensure that straight paths were not always actionable (Supplementary Figure S2). The response variables were set to the sum of x1, x2, and x3 with Gaussian noise (\u03c3 = 2). The dataset consisted of 600 data points and randomly split into training data (80%) and test data (20%)."
    },
    {
      "heading": "Iwaki Health Promotion Project dataset",
      "text": "To evaluate our framework, we used the Iwaki Health Promotion Project (IHPP) dataset. In this study, we considered the use case to plan actionable paths to improve SBP, which is a risk factor for cardiovascular diseases26.\nThe IHPP has annually acquired a wide range of health checkup data that comprise the molecular biology, physiology, biochemistry, personal lifestyle, and socio-environmental aspects of residents of Iwaki district, Hirosaki City, Aomori Prefecture, Japan. In this study, we targeted 12,803 health checkup instances with SBP values for 13 years from 2005 to 2017. Since cases existed where the same person participated over multiple years, the number of unique participants was 3,132 (Table 1). The dataset was randomly split into training data (80%) and test data (20%) by participants. This study was approved by the Ethics Committee of Hirosaki University School of Medicine (approval number: 2019-009) and was conducted according to the recommendations of the Declaration of Helsinki. All participants provided written informed consent."
    },
    {
      "heading": "Construction of regression model",
      "text": "In our experiments, XGBoost44, which is based on a gradient boosting decision tree algorithm, was used to create the regression model. In general, XGBoost is a high-performance non-linear model. The hyperparameters of the model were determined by 5-fold cross-validation of the training data. For preprocessing, continuous explanatory variables were standardized by the mean and standard deviation. In addition to this preprocessing, techniques such as other data-dependent preprocessing are performed. These data-dependent preprocessing is described in the experimental section. Surrogate model with hierarchical Bayesian modeling\nThe graphical model representation of the surrogate model constructed in this study is shown in Fig. 2. xcont represents continuous explanatory variables such as body composition and blood test data, xdisc represents discrete explanatory variables\nsuch as sex, and y represents a response variable such as blood pressure value. We denote the measured explanatory values as x and the predictions by the regression model as y. We used PyStan45 to estimate the parameters using the Markov chain Monte Carlo algorithm (iteration = 1,500, warmup = 500). We set 1\u20138 as the range of mixture components. For model selection, the WBIC was calculated for each model23. For a stable training, instances with values outside 3-\u03c3 calculated using the training data in the continuous explanatory variables were excluded as outliers. Path planning using surrogate model\nWe calculated an optimal path for treatment for each instance based on a breadth-first search algorithm. The intervention variable space is regarded as a grid graph, and the grid points (nodes) are connected to plan a path. The pseudocode of this algorithm is shown in Supplementary Figure S5. The purpose of this algorithm is to obtain the most actionable path to the node that achieves the most improved predictive value within the search iteration count, L. Computationally, we used the negative logarithm of actionability as a cost to minimize for path planning. We obtained a list of nodes adjacent to the currently selected node in line 3 of the pseudocode. Subsequently, the costs for these nodes were updated in lines 5\u20137. The following node was selected in line 11. After reaching the predetermined count L, the path to the node with the best regression model prediction value was selected as the optimal path in line 13. If multiple nodes with the same predictions existed, the path with the minimum cost was selected."
    },
    {
      "heading": "Actionability score",
      "text": "To evaluate the actionability of the paths, we defined the actionability score expressed by the following equation: log(optimal path actionability) - log(baseline path actionability),\nwhere the optimal path actionability is the actionability of the path planned using our framework. The baseline path actionability is the geometric mean of 10 actionabilities of paths that connect both ends of the optimal path by the shortest procedure randomly. The actionability score means the actionability of the optimal path compared with that of baseline paths. When the actionability score is zero, the optimal path has the same actionability as the baseline path."
    },
    {
      "heading": "Data availability",
      "text": "All data in this study are included in this article or are available from the corresponding author upon reasonable request."
    },
    {
      "heading": "Code availability",
      "text": "All codes used in this study are available from the corresponding author upon a reasonable request."
    },
    {
      "heading": "Acknowledgement",
      "text": "This work was supported by JST, Center of Innovation Program (JPMJCE1302), and Kyowa Hakko Bio Co., Ltd. The author, Kazuki Nakamura, thanks Kazushi Shoji, Miho Komatsu, Takashi Ishida, and Yuko Shimanami, employees of Kyowa Hakko Bio Co., Ltd., for their generous support."
    },
    {
      "heading": "Authors information",
      "text": ""
    },
    {
      "heading": "Affiliations",
      "text": ""
    },
    {
      "heading": "Research & Business Development Department, Kyowa Hakko Bio Co., Ltd., Tokyo, Japan",
      "text": "Kazuki Nakamura"
    },
    {
      "heading": "Department of Biomedical Data Intelligence, Graduate School of Medicine, Kyoto University, Kyoto, Japan",
      "text": "Kazuki Nakamura, Ryosuke Kojima, Eiichiro Uchino and Yasushi Okuno"
    },
    {
      "heading": "Center of Innovation Research Initiatives Organization, Hirosaki University, Zaifu-cho, Hirosaki, Aomori, Japan",
      "text": "Koichi Murashita"
    },
    {
      "heading": "Department of Stress Response Science, Hirosaki University Graduate School of Medicine, Zaifu-cho, Hirosaki, Aomori, Japan",
      "text": "Ken Itoh"
    },
    {
      "heading": "Department of Social Health, Hirosaki University Graduate School of Medicine, Zaifu-cho, Hirosaki, Aomori, Japan",
      "text": "Shigeyuki Nakaji"
    },
    {
      "heading": "Contributions",
      "text": "K.N. and R.K. conceived of the presented idea. K.N. contributed to analyze data and draft the manuscript. R.K., E.U. and Y.O. provided substantial contributions to analyze data. K.M., K.I. and S.N. designed the study for acquisition of data. All authors critically interpret the results, reviewed and approved the manuscript."
    },
    {
      "heading": "Corresponding authors",
      "text": "Correspondence to Kazuki Nakamura and Yasushi Okuno."
    },
    {
      "heading": "Ethics declarations",
      "text": ""
    },
    {
      "heading": "Competing interests",
      "text": "Kazuki Nakamura is an employee of Kyowa Hakko Bio Co., Ltd. Other authors declare that they have no conflict of interest.\nSupplementary Information\nHealth improvement framework for planning actionable treatment process using surrogate Bayesian model Kazuki Nakamura1,2, Ryosuke Kojima2, Eiichiro Uchino2, Koichi Murashita3, Ken Itoh4, Shigeyuki Nakaji5 and Yasushi\nOkuno2\n1 Research & Business Development Department, Kyowa Hakko Bio Co., Ltd., Tokyo, Japan. 2 Department of Biomedical Data Intelligence, Graduate School of Medicine, Kyoto University, Kyoto, Japan. 3 Center of Innovation Research Initiatives Organization, Hirosaki University, Zaifu-cho, Hirosaki, Aomori, Japan. 4 Department of Stress Response Science, Hirosaki University Graduate School of Medicine, Zaifu-cho, Hirosaki, Aomori, Japan. 5 Department of Social Health, Hirosaki University Graduate School of Medicine, Zaifu-cho, Hirosaki, Aomori, Japan."
    },
    {
      "heading": "Supplementary experiments",
      "text": "Because the regression model based on health datasets used in the main text had relatively low prediction scores, we also applied our framework on a non-health dataset and another simple health dataset.\nEvaluation on real estate dataset We obtained a dataset from the UCI Machine Learning Repository1,2. This dataset was used to conduct a regression of the house price of unit area from six continuous explanatory variables about real estate data. The dataset contains no missing values. The dataset was randomly split into training data (80%) and test data (20%).\nThe trained regression model yielded an RMSE of 6.78 and an R-squared of 0.735 in the test data (Supplementary Figure S6a). A surrogate model was constructed by hierarchical Bayesian modeling using the original data and the predicted values of the regression model. The lowest WBIC value was obtained when the number of mixture components was two (Supplementary Figure S6b).\nSubsequently, path planning was performed using the surrogate model. Of the six explanatory variables, X1 (the transaction date) was a variable that was difficult to intervene. Therefore, X1 was fixed, and the remaining five variables were selected as intervention variables. The unit cell size of the grid was set to 0.2-\u03c3 in the training data for each explanatory variable. We performed the path search algorithm with L = 20,000 for each instance, and the path with the highest predicted value was acquired. The histogram of the actionability score for each instance is shown in Supplementary Figure S6c. The actionability scores were greater than zero in 75/82 instances, and the median was 5.25.\nFrom these results, we have demonstrated that our framework can be applicable to datasets with higher regression model scores.\nEvaluation on public dataset for disease progression To evaluate the feasibility of our framework on another small health dataset, we used a public dataset on diabetes progression3,4. This dataset was used to conduct a regression of the quantitative measure of diabetes progression one year after the baseline from nine continuous and one discrete explanatory variables (Supplementary Table S2). The dataset is\nopenly available on Trevor Hastie\u2019s Software page at https://web.stanford.edu/~hastie/Papers/LARS/. This dataset contains no missing values. The dataset was randomly split into training data (80%) and test data (20%).\nThe feature importance of the trained model was shown in Supplementary Figure S7a. The regression model yielded a RMSE of 62.19 and an R-squared of 0.246 in the test data (Supplementary Figure S7b). A surrogate model was constructed by hierarchical Bayesian modeling using the original data and the predicted values of the regression model. The lowest WBIC value was obtained when the number of mixture components was two (Supplementary Figure S7c).\nSubsequently, path planning was performed using the surrogate model. As intervention variables, five variables were selected from the top of the feature importance of the regression model: body mass index (BMI), blood pressure, T-cells, high-density lipoproteins, and lamotrigine (Supplementary Figure S7a). The remaining variables were fixed. The unit cell size of the grid was set to 0.2-\u03c3 in the training data for each explanatory variable. We performed the path search algorithm with L = 20,000 for each instance, and the path with the lowest predicted value was acquired. The histogram of the actionability score for each instance is shown in Supplementary Figure S7d. The actionability scores were greater than zero in 83/87 instances, and the median was 2.06. Examples of proposed paths planned using our framework are shown in Supplementary Figure S8. This experiment supports the feasibility of our framework to plan actionable paths to improve the predictions of the regression model."
    },
    {
      "heading": "Feature Description",
      "text": ""
    },
    {
      "heading": "Response variable",
      "text": "Disease progression A quantitative measure of disease progression one year after baseline"
    },
    {
      "heading": "Explanatory variables",
      "text": "age Age in years\nsex\nbmi Body mass index\nbp Average blood pressure\ns1 T-cells (a type of white blood cells)\ns2 Low-density lipoproteins\ns3 High-density lipoproteins\ns4 Thyroid stimulating hormone\ns5 Lamotrigine\ns6 Blood sugar level"
    }
  ],
  "title": "Health improvement framework for planning actionable treatment process using surrogate Bayesian model",
  "year": 2020
}
