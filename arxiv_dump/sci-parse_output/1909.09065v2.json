{"abstractText": "Many high-performance models suffer from a lack of interpretability. There has been an increasing influx of work on explainable artificial intelligence (XAI) in order to disentangle what is meant and expected by XAI. Nevertheless, there is no general consensus on how to produce and judge explanations. In this paper, we discuss why techniques integrating connectionist and symbolic paradigms are the most efficient solutions to produce explanations for non-technical users and we propose a reasoning model, based on definitions by Doran et al. [2017], to explain a neural network\u2019s decision. We use this explanation in order to correct bias in the network\u2019s decision rationale. We accompany this model with an example of its potential use, based on the image captioning method in Burns et al. [2018]. 1 Existing perspectives in Explainable AI The last years have been characterized by an upsurge of opaque decision systems, such as Deep Neural Networks (DNN). Although they have great generalization and prediction skills, their functioning does not allow detailed explanations of their behaviour to be obtained. As opaque machine learning models are increasingly being employed to make important predictions in critical environments, the danger is to create and use decisions that are not justifiable or legitimate. While it is not systematically necessary to obtain from the system an intelligible explanation, for example when the model has already been extensively studied and evaluated, the demand for interpretability is increasing from the various stakeholders in Artificial Intelligence. There is a general agreement on the importance of providing interpretability in machine learning models but desiderata differ according to the needs of each faction. Some common cases are a need for ethics [Goodman and Flaxman, 2017], for safety when using AI in high-risk environments [Caruana et al., 2015] or a need to allow the final user to trust the system [Zhu et al., 2018]. The case we are interested in is that of developers trying to debug their models in order to make them more efficient, reliable and robust. It is customary to think that by focusing solely on performance, the systems will be increasingly opaque. This is true in the sense that there is a trade-off between the performance of a model and its transparency [Do\u0161ilovi\u0107 et al., 2018]. However, an improvement in the understanding of a system can lead to the correction of its deficiencies. Since the definition of interpretability is subject to debate in the scientific community, we will use here the one proposed in Biran and Cotton [2017]: Interpretability is the degree to which an observer can understand the cause of a decision. Broad consensus exists on the importance of interpretability for AI models. However, there is no collective agreement on how to evaluate interpretation techniques. A division is regularly done between methods explaining the process of the model, called transparency methods, versus post-hoc methods. According to the Oxford dictionary, Post-hoc reasoning is \"occurring or done after the event, especially with reference to the fallacious assumption that the occurrence in question has a logical relationship with the event it follows\". This is in contrast to the search for transparency, which consists of a direct clarification of the model. Lipton [2018] call transparency the opposition of black boxness, the search for a direct understanding of the mechanism by which a model works. The contrast with post-hoc methods, all those that do not clarify the model, is not exclusive, as a post-hoc method could also be considered as transparent if it provides an intuitive explanation of the model parameters. The latter definition is also assumed by Montavon et al. [2018], and states, as a further remark, that the goal of post-hoc methods is to understand what the system predicts given a trained model. In Do\u0161ilovi\u0107 et al. [2018], however, the authors add two subapproaches to transparent methods: pure transparent ones, i.e., those that use model families considered as transparent such as linear models or decision trees, and hybrid ones that combine transparent model families with black box methods. This work also explains that human thinking is not transparent to us and, as human beings, we are used to justify our own decision thanks to a post-hoc mechanism, without fully knowing our decision process. Slightly different definitions behind these two terms are set in Preece et al. [2018], as they only place methods that do not derive from an internal state of the model (such as e.g., feature visualization [Olah et al., 2018]), in the post-hoc category. This means that visualizing activations of different layers of a network is not purely post-hoc, but transparency-based. ar X iv :1 90 9. 09 06 5v 2 [ cs .L G ] 2 2 O ct 2 01 9 A distinction with more hindsight is made in Adadi and Berrada [2018] by separating methods that take into consideration both the process and the outcome of the model on the one hand, and those that focus only on the outcome, on the other hand. They use the term of model-based methods, which aims at understanding how the prediction process works as a transparency method, versus post-hoc methods. An explanation is considered as post-hoc if it is the produce of a separate method explaining the prediction produced by the black box while ignoring the decision process. Confronting transparency with post-hoc generates most of the time an opposition between symbolic and connectionist methods. On the one hand, symbolic methods are popularly considered less efficient, while they offer greater explainability. On the other hand, connectionist methods are more precise but opaque. 2 The needs for neural-symbolic interpretability It has been proven that using a background knowledge within a DNN can bring robustness to the learning system [Donadello et al., 2017; Donadello, 2018; d\u2019Avila Garcez et al., 2019]. The use of a Knowledge Base (KB) to learn and reason with symbolic representation has the advantage of promoting the production of explanations while making a prediction [Donadello et al., 2019]. Neural-symbolic computation Manhaeve et al. [2018] is a promising path in order to move forward XAI In his paper, Miller [2019] highlighted major findings that should be considered when creating an explainable AI model. First, explanations are better when constrictive, meaning that a prerequisite for a good explanation is that it does not only indicate why the model made a decision X, but also why it made decision X rather than decision Y. The ability to refer to established reasoning rules allows symbolic methods to fulfill this property. It is also explained in Miller\u2019s article that probabilities are not as important as causal links in order to provide a satisfying explanation. Considering that black box models tend to process data in a quantitative manner, it would be necessary to translate the probabilistic results into qualitative notions containing causal links. Again, the use of symbols could carry this property as the use of a knowledge base (KB) such as an ontology can allow data to be processed directly in a qualitative way. In addition, they state that explanations are selective, meaning that focusing solely on the main causes of a decision-making process is sufficient. It is known that there is a trade-off between interpretability and accuracy [Gilpin et al., 2018], i.e., between the simplicity of the information given by the system on its internal functioning, and the exhaustiveness of this description. Considering that additional variables and equations must be introduced in order to test whether a correlation between two variables is genuine or spurious [Simon, 1954], being selective is less straight-forward for connectionist models than for symbolic ones. Finally, considering that a good explanation needs to influence the mental model of the user, i.e. the representation of the external reality using, among other things, symbols, it seems obvious that the use of the symbolic learning paradigm is appropriate to produce an explanation. One of the goals of having interpretability in a model is to explain its reasoning by expressing it in a way that is understandable and readable by human beings, while highlighting the biases learned by the model, in order to validate or invalidate its decision rationale [Guidotti et al., 2018]. It is customary to think that by focusing solely on performance, the systems will be increasingly opaque. This is true in the sense that there is a trade-off between the performance of a model and its transparency [Do\u0161ilovi\u0107 et al., 2018]. We consider that the advocacy for interpretability may lead to a generic performance improvement for 3 reasons: i) it will help ensure impartiality in decision-making, i.e. to highlight, and consequently, correct from bias in the training data-set, ii) interpretability facilitates the provision of robustness by highlighting potential adversarial perturbations that could change the prediction, and finally, iii) interpretability can act as an insurance that only meaningful variables infer the output, i.e., guaranteeing that an underlying truthful causality exists in the model reasoning. Combining the prediction capabilities of connectionist models with the transparency of symbolic ones will put aside the trade-off by increasing both the interpretability and the performance of AI models. Therefore, neural-symbolic interpretability can provide convincing explanations while keeping or improving generic performance. 3 Neural-Symbolic computation for truly Explainable AI Truly explainable models should directly integrate reasoning, in order to not leave explanation generation to the human user. In the model proposed by Doran et al. [2017], the black box, i.e. the connectionist part, is giving the final output, while the KB is externally provided to the model. This allows the system to generate itself an explanation in natural language, thus linking the high level features identified by the model and the final output. It also highlights the logical path the model should have taken: since the KB is given by the user and (therefore we assume) cannot be incorrect, a reasoning error in the natural language explanation would signify a mistake in the black box between high level features and the final output. In addition, as stated in Doran et al. [2017], the inclusion of reasoning in the model eliminates the potential corruption of the explanation that could arise from using external sources to justify the actual model we want to make explainable. However, we can propose some adjustments in this architecture: the causal links given by the KB do not directly reflect the operations that took place in the black box, and it is therefore impossible to affirm that the model predicted this output for the reasons given in the natural language explanation. Since nothing connects the KB and the black box, therefore it is impossible to link the explanation and the predicted output. The objective of not leaving explanation generation to human analysts is fulfilled, as the model formulates a line of reasoning, but the explanation given is not correct (or does not have accurate provenance), as it only explains what the black box should have learned, and not what it actually learned. A possible adaptation would be to not use the output of the black box in the reasoner and solely use the high level features detected by the model so that the natural language explanation would match the reasoning that led to this result. This would mean truncating the potential of the black box. It is possible to link the reasoner and the black box by considering that the output is no longer the final result, but rather high level features. The model would then produce an explanation on what the system should conclude when seeing those features but not why it detected those features. A last option to achieve an explanation of the model decision would be to directly populate the KB from the data. This would allow to provide an explanation in natural language directly from the black box, emphasizing in the meantime the model\u2019s reasoning errors and highlighting possible bias in the dataset or model. This is the option we propose pursuing as we believe it provides the most faithful explanation of how the model actually works. We summarize the different scenarios in Table 1. We derive two prerequisites that are necessary to create a truly reasoning AI: i) The KB must inherently emerge from the black box model in order to conceptually (symbolically) reflect what the model learned. ii) The symbolic part must constraint the connectionist part to improve the prediction performance of the model. Figure 1: Proposed neural-symbolic explainable model extended from Doran et al. [2017]: the black box model provides, along with its output, an explanation of its reasoning to highlight bias and improve performance. Our contribution with respect to Doran et al. [2017] is the way we populate the KB directly from the data and the way we constraint the DNN thanks to the KB. It can be seen with the dashed lines We propose an adaptation of the architecture in Fig. 1. Instead of externally providing a KB to complement the model, we propose to i) directly extract symbolic rules from a first black box and ii) reflect those rules in a second black box by constraining learning according to perceived properties, e.g., by modifying initialization protocols, loss functions or hyperparameters. Therefore, the model\u2019s ultimate output would come from the reasoner but would be directly influenced by both the black box and the KB, i.e., it would not truncate the black box potency but reveal, as expected by an explanation, the biases learned by the model and lead to performance improvement while explaining in natural language its prediction. As it seems intuitive that the presence of a KB is useful to provide an explanation, how to use it to influence a network raises some questions. The role of the reasoner is to answer to queries based on the prediction and whose answers come from the symbolic rules stored in the KB. 4 Towards a model for XAI through neural-symbolic computation One barrier to transparency is a \"mismatch between the mathematical optimization using high-dimensionality characteristics of machine learning and the demands of human-scale reasoning and styles of interpretation\" [Burrell, 2016]. With the objective of reducing this gap, and inspired by the work of Burns et al. [2018], we hypothesize that the use of loss functions that have a concrete and more graspable perceptible meaning could make it easier to provide an explanation than a classic non intuitive cross-entropy. In Burns et al. [2018], authors introduce two new loss functions: the \"Appearance Confusion Loss\" and the \"Confident Loss\" in order to counterbalance gender bias during an image captioning process. The Appearance Confusion Loss is based on the fact that for an image devoid of gender information, the probability of predicting man or woman should be equal; and the Confident Loss exists to encourage the model to predict gender words correctly when gender evidence is present. In order to test our model, we address the problem of reducing the bias in image captioning explained in Burns et al. [2018]. In a succinct manner, it consists in training a neural network using images I, image captions S, and image segmentation annotation masks M, with a Neural Image Caption network [Vinyals et al., 2014] as a base. We chose this problem because it represents a case where the creation of a KB from the data is possible, and because captioning is vulnerable to bias. We propose creating the reasoning-facilitating KB by performing word-embedding on the black box model labels in order to determine which words are particularly exposed to a risk of errors due to learning priors or biased data collection. Interchangeable words are more likely to be victims of overuse of context [Zhao et al., 2017]. To show a trivial example, if seniors are represented with park benches more often than young adults, the model may tend to misuse the context by predicting a senior each time a bench is detected, without further caring about the person on the picture. Our explainable model proposes extracting a list noted as Bword and used in a similar syntax layout than a chosen word, such as Bperson = [man, teenager, boy, senior]. This means that man, teenager, boy and senior are often used in the same context as the word person. The extracted list will constitute a set of words base for which the model will have to hesitate when trying to predict one word rather than another. We call person a class while man, teenager, boy Knowledge Base Provenance External Black box Model\u2019s final output origin Reasoner No explanation about the black box Does not highlight reasoning mistakes + Explanation about the black box + Highlights reasoning mistakes Black box No explanation of the black box + Highlight reasoning mistakes Table 1: Scenarios for Neural-Symbolic Reasoning, depending on the origin of the KB and the origin of the final output. The cell with text in bold is our contributed proposed model to achieve faithful neural-symbolic visual reasoning. and senior are ontological sub-classes. We want to force the system to hesitate on which ontological sub-class it should predict when a class is present on an image, in order to not make any mistakes, but to be confident enough to nevertheless predict an ontological sub-class rather than a class, in order to be as specific as possible. We propose to generalize the gender specific loss functions from Burns et al. [2018] in an attempt to force the system to be confused (or confident, resp.) when predicting any biasprone word, i.e, any ontological sub-class from the set Bword belonging to the word class. Just like Burns et al. [2018], we want to force our model to be confused when making predictions if the input image does not contain appropriate evidence for the prediction to be made. We use masked images I \u2032, where the information relevant to making a decision, such as the interior of a segmentation mask for a human in the image (if we are trying to determine whether or not the human classified is a senior or not), is removed. To ensure equiprobability among the different words in Bword when there is no appropriate information for the system to predict a specific word, but rather its generic category, we generalize the confusion function from Burns et al. [2018] to the general case where gender is not the only source of potential bias. We note confusion function C which operates over the predicted distribution of words p(w\u0303t):", "authors": [{"affiliations": [], "name": "Adrien Bennetot"}, {"affiliations": [], "name": "Natalia D\u00edaz-Rodr\u00edguez"}], "id": "SP:23b80b4af1e1045b6bccadcb894450988e0299ee", "references": [{"authors": ["Amina Adadi", "Mohammed Berrada"], "title": "Peeking inside the black-box: A survey on explainable artificial intelligence (xai)", "venue": "IEEE Access,", "year": 2018}, {"authors": ["Or Biran", "Courtenay Cotton"], "title": "Explanation and justification in machine learning: A survey", "venue": "In IJCAI-17 workshop on explainable AI (XAI),", "year": 2017}, {"authors": ["Kaylee Burns", "Lisa Anne Hendricks", "Kate Saenko", "Trevor Darrell", "Anna Rohrbach"], "title": "Women also Snowboard: Overcoming Bias in Captioning Models", "venue": "arXiv e-prints, page arXiv:1803.09797,", "year": 2018}, {"authors": ["Jenna Burrell"], "title": "How the machine \u2018thinks\u2019: Understanding opacity in machine learning algorithms", "venue": "Big Data & Society,", "year": 2016}, {"authors": ["Artur S. d\u2019Avila Garcez", "Marco Gori", "Lu\u00eds C. Lamb", "Luciano Serafini", "Michael Spranger", "Son N. Tran"], "title": "Neuralsymbolic computing: An effective methodology for principled integration of machine learning and reasoning", "year": 1905}, {"authors": ["Ivan Donadello", "Luciano Serafini", "Artur D\u2019Avila Garcez"], "title": "Logic tensor networks for semantic image interpretation", "venue": "Proceedings of the Twenty-Sixth International Joint Conference on Artificial Intelligence,", "year": 2017}, {"authors": ["Ivan Donadello", "Mauro Dragoni", "Claudio Eccher"], "title": "Persuasive explanation of reasoning inferences on dietary data", "venue": "In First Workshop on Semantic Explainability @ ISWC", "year": 2019}, {"authors": ["Ivan Donadello"], "title": "Semantic image interpretation-integration of numerical data and logical knowledge for cognitive vision", "year": 2018}, {"authors": ["Derek Doran", "Sarah Schulz", "Tarek R. Besold"], "title": "What Does Explainable AI Really Mean? A New Conceptualization of Perspectives", "venue": "arXiv e-prints, page arXiv:1710.00794,", "year": 2017}, {"authors": ["Filip Karlo Do\u0161ilovi\u0107", "Mario Br\u010di\u0107", "Nikica Hlupi\u0107"], "title": "Explainable artificial intelligence: A survey", "venue": "41st International Convention on Information and Communication Technology, Electronics and Microelectronics (MIPRO),", "year": 2018}, {"authors": ["Leilani H. Gilpin", "David Bau", "Ben Z. Yuan", "Ayesha Bajwa", "Michael Specter", "Lalana Kagal"], "title": "Explaining Explanations: An Overview of Interpretability of Machine Learning", "venue": "arXiv e-prints, page arXiv:1806.00069,", "year": 2018}, {"authors": ["Bryce Goodman", "Seth Flaxman"], "title": "European union regulations on algorithmic decision-making and a \"right to explanation", "venue": "AI Magazine,", "year": 2017}, {"authors": ["Riccardo Guidotti", "Anna Monreale", "Salvatore Ruggieri", "Franco Turini", "Fosca Giannotti", "Dino Pedreschi"], "title": "A survey of methods for explaining black box models", "venue": "ACM Comput. Surv.,", "year": 2018}, {"authors": ["Zachary C. Lipton"], "title": "The mythos of model interpretability", "year": 2018}, {"authors": ["Tim Miller"], "title": "Explanation in artificial intelligence: Insights from the social sciences", "venue": "Artif. Intell.,", "year": 2019}, {"authors": ["Gr\u00e9goire Montavon", "Wojciech Samek", "Klaus-Robert M\u00fcller"], "title": "Methods for interpreting and understanding deep neural networks", "venue": "Digital Signal Processing, 73:1\u201315,", "year": 2018}, {"authors": ["Christopher Olah", "Arvind Satyanarayan", "Ian Johnson", "Shan Carter", "Ludwig Schubert", "Katherine Ye", "Alexander Mordvintsev"], "title": "The building blocks of interpretability", "year": 2018}, {"authors": ["Alun Preece", "Dan Harborne", "Dave Braines", "Richard Tomsett", "Supriyo Chakraborty"], "title": "Stakeholders in Explainable AI", "venue": "arXiv e-prints, page arXiv:1810.00184,", "year": 2018}, {"authors": ["Herbert A. Simon"], "title": "Spurious correlation: A causal interpretation", "venue": "Journal of the American Statistical Association,", "year": 1954}, {"authors": ["Oriol Vinyals", "Alexander Toshev", "Samy Bengio", "Dumitru Erhan"], "title": "Show and Tell: A Neural Image Caption Generator", "venue": "arXiv e-prints, page arXiv:1411.4555,", "year": 2014}, {"authors": ["Jieyu Zhao", "Tianlu Wang", "Mark Yatskar", "Vicente Ordonez", "Kai-Wei Chang"], "title": "Men Also Like Shopping: Reducing Gender Bias Amplification using Corpus-level Constraints", "venue": "arXiv e-prints, page arXiv:1707.09457,", "year": 2017}, {"authors": ["Jichen Zhu", "Antonios Liapis", "Sebastian Risi", "Rafael Bidarra", "Gregory Michael Youngblood"], "title": "Explainable ai for designers: A human-centered perspective on mixed-initiative co-creation", "venue": "IEEE Conference on Computational Intelligence and Games (CIG),", "year": 2018}], "sections": [{"heading": "1 Existing perspectives in Explainable AI", "text": "The last years have been characterized by an upsurge of opaque decision systems, such as Deep Neural Networks (DNN). Although they have great generalization and prediction skills, their functioning does not allow detailed explanations of their behaviour to be obtained. As opaque machine learning models are increasingly being employed to make important predictions in critical environments, the danger is to create and use decisions that are not justifiable or legitimate.\nWhile it is not systematically necessary to obtain from the system an intelligible explanation, for example when the model has already been extensively studied and evaluated, the demand for interpretability is increasing from the various stakeholders in Artificial Intelligence. There is a general agreement on the importance of providing interpretability in machine learning models but desiderata differ according to the needs of each faction. Some common cases are a need for ethics [Goodman and Flaxman, 2017], for safety when using AI in high-risk environments [Caruana et al., 2015] or a need to allow the final user to trust the system [Zhu et al., 2018]. The case we are interested in is that of developers trying to debug their models in order to make them more efficient, reliable and robust. It is customary to think that by focusing solely on performance, the systems will be increasingly opaque. This is\ntrue in the sense that there is a trade-off between the performance of a model and its transparency [Do\u0161ilovic\u0301 et al., 2018]. However, an improvement in the understanding of a system can lead to the correction of its deficiencies.\nSince the definition of interpretability is subject to debate in the scientific community, we will use here the one proposed in Biran and Cotton [2017]:\nInterpretability is the degree to which an observer can understand the cause of a decision.\nBroad consensus exists on the importance of interpretability for AI models. However, there is no collective agreement on how to evaluate interpretation techniques. A division is regularly done between methods explaining the process of the model, called transparency methods, versus post-hoc methods. According to the Oxford dictionary, Post-hoc reasoning is \"occurring or done after the event, especially with reference to the fallacious assumption that the occurrence in question has a logical relationship with the event it follows\". This is in contrast to the search for transparency, which consists of a direct clarification of the model.\nLipton [2018] call transparency the opposition of black boxness, the search for a direct understanding of the mechanism by which a model works. The contrast with post-hoc methods, all those that do not clarify the model, is not exclusive, as a post-hoc method could also be considered as transparent if it provides an intuitive explanation of the model parameters. The latter definition is also assumed by Montavon et al. [2018], and states, as a further remark, that the goal of post-hoc methods is to understand what the system predicts given a trained model. In Do\u0161ilovic\u0301 et al. [2018], however, the authors add two subapproaches to transparent methods: pure transparent ones, i.e., those that use model families considered as transparent such as linear models or decision trees, and hybrid ones that combine transparent model families with black box methods. This work also explains that human thinking is not transparent to us and, as human beings, we are used to justify our own decision thanks to a post-hoc mechanism, without fully knowing our decision process.\nSlightly different definitions behind these two terms are set in Preece et al. [2018], as they only place methods that do not derive from an internal state of the model (such as e.g., feature visualization [Olah et al., 2018]), in the post-hoc category. This means that visualizing activations of different layers of a network is not purely post-hoc, but transparency-based.\nar X\niv :1\n90 9.\n09 06\n5v 2\n[ cs\n.L G\n] 2\n2 O\nct 2\n01 9\nA distinction with more hindsight is made in Adadi and Berrada [2018] by separating methods that take into consideration both the process and the outcome of the model on the one hand, and those that focus only on the outcome, on the other hand. They use the term of model-based methods, which aims at understanding how the prediction process works as a transparency method, versus post-hoc methods. An explanation is considered as post-hoc if it is the produce of a separate method explaining the prediction produced by the black box while ignoring the decision process.\nConfronting transparency with post-hoc generates most of the time an opposition between symbolic and connectionist methods. On the one hand, symbolic methods are popularly considered less efficient, while they offer greater explainability. On the other hand, connectionist methods are more precise but opaque."}, {"heading": "2 The needs for neural-symbolic interpretability", "text": "It has been proven that using a background knowledge within a DNN can bring robustness to the learning system [Donadello et al., 2017; Donadello, 2018; d\u2019Avila Garcez et al., 2019]. The use of a Knowledge Base (KB) to learn and reason with symbolic representation has the advantage of promoting the production of explanations while making a prediction [Donadello et al., 2019]. Neural-symbolic computation Manhaeve et al. [2018] is a promising path in order to move forward XAI\nIn his paper, Miller [2019] highlighted major findings that should be considered when creating an explainable AI model. First, explanations are better when constrictive, meaning that a prerequisite for a good explanation is that it does not only indicate why the model made a decision X, but also why it made decision X rather than decision Y. The ability to refer to established reasoning rules allows symbolic methods to fulfill this property. It is also explained in Miller\u2019s article that probabilities are not as important as causal links in order to provide a satisfying explanation. Considering that black box models tend to process data in a quantitative manner, it would be necessary to translate the probabilistic results into qualitative notions containing causal links. Again, the use of symbols could carry this property as the use of a knowledge base (KB) such as an ontology can allow data to be processed directly in a qualitative way. In addition, they state that explanations are selective, meaning that focusing solely on the main causes of a decision-making process is sufficient. It is known that there is a trade-off between interpretability and accuracy [Gilpin et al., 2018], i.e., between the simplicity of the information given by the system on its internal functioning, and the exhaustiveness of this description. Considering that additional variables and equations must be introduced in order to test whether a correlation between two variables is genuine or spurious [Simon, 1954], being selective is less straight-forward for connectionist models than for symbolic ones. Finally, considering that a good explanation needs to influence the mental model of the user, i.e. the representation of the external reality using, among other things, symbols, it seems obvious that the use of the symbolic learning paradigm is appropriate to produce an explanation.\nOne of the goals of having interpretability in a model is to explain its reasoning by expressing it in a way that is understandable and readable by human beings, while highlighting the biases learned by the model, in order to validate or invalidate its decision rationale [Guidotti et al., 2018]. It is customary to think that by focusing solely on performance, the systems will be increasingly opaque. This is true in the sense that there is a trade-off between the performance of a model and its transparency [Do\u0161ilovic\u0301 et al., 2018]. We consider that the advocacy for interpretability may lead to a generic performance improvement for 3 reasons: i) it will help ensure impartiality in decision-making, i.e. to highlight, and consequently, correct from bias in the training data-set, ii) interpretability facilitates the provision of robustness by highlighting potential adversarial perturbations that could change the prediction, and finally, iii) interpretability can act as an insurance that only meaningful variables infer the output, i.e., guaranteeing that an underlying truthful causality exists in the model reasoning. Combining the prediction capabilities of connectionist models with the transparency of symbolic ones will put aside the trade-off by increasing both the interpretability and the performance of AI models.\nTherefore, neural-symbolic interpretability can provide convincing explanations while keeping or improving generic performance."}, {"heading": "3 Neural-Symbolic computation for truly Explainable AI", "text": "Truly explainable models should directly integrate reasoning, in order to not leave explanation generation to the human user. In the model proposed by Doran et al. [2017], the black box, i.e. the connectionist part, is giving the final output, while the KB is externally provided to the model. This allows the system to generate itself an explanation in natural language, thus linking the high level features identified by the model and the final output. It also highlights the logical path the model should have taken: since the KB is given by the user and (therefore we assume) cannot be incorrect, a reasoning error in the natural language explanation would signify a mistake in the black box between high level features and the final output. In addition, as stated in Doran et al. [2017], the inclusion of reasoning in the model eliminates the potential corruption of the explanation that could arise from using external sources to justify the actual model we want to make explainable.\nHowever, we can propose some adjustments in this architecture: the causal links given by the KB do not directly reflect the operations that took place in the black box, and it is therefore impossible to affirm that the model predicted this output for the reasons given in the natural language explanation. Since nothing connects the KB and the black box, therefore it is impossible to link the explanation and the predicted output. The objective of not leaving explanation generation to human analysts is fulfilled, as the model formulates a line of reasoning, but the explanation given is not correct (or does not have accurate provenance), as it only explains what the black box should have learned, and not what it actually learned.\nA possible adaptation would be to not use the output of the black box in the reasoner and solely use the high level features\ndetected by the model so that the natural language explanation would match the reasoning that led to this result. This would mean truncating the potential of the black box. It is possible to link the reasoner and the black box by considering that the output is no longer the final result, but rather high level features. The model would then produce an explanation on what the system should conclude when seeing those features but not why it detected those features.\nA last option to achieve an explanation of the model decision would be to directly populate the KB from the data. This would allow to provide an explanation in natural language directly from the black box, emphasizing in the meantime the model\u2019s reasoning errors and highlighting possible bias in the dataset or model. This is the option we propose pursuing as we believe it provides the most faithful explanation of how the model actually works.\nWe summarize the different scenarios in Table 1. We derive two prerequisites that are necessary to create a truly reasoning AI: i) The KB must inherently emerge from the black box model in order to conceptually (symbolically) reflect what the model learned. ii) The symbolic part must constraint the connectionist part to improve the prediction performance of the model.\nWe propose an adaptation of the architecture in Fig. 1. Instead of externally providing a KB to complement the model, we propose to i) directly extract symbolic rules from a first black box and ii) reflect those rules in a second black box by constraining learning according to perceived properties, e.g., by modifying initialization protocols, loss functions or hy-\nperparameters. Therefore, the model\u2019s ultimate output would come from the reasoner but would be directly influenced by both the black box and the KB, i.e., it would not truncate the black box potency but reveal, as expected by an explanation, the biases learned by the model and lead to performance improvement while explaining in natural language its prediction.\nAs it seems intuitive that the presence of a KB is useful to provide an explanation, how to use it to influence a network raises some questions. The role of the reasoner is to answer to queries based on the prediction and whose answers come from the symbolic rules stored in the KB."}, {"heading": "4 Towards a model for XAI through neural-symbolic computation", "text": "One barrier to transparency is a \"mismatch between the mathematical optimization using high-dimensionality characteristics of machine learning and the demands of human-scale reasoning and styles of interpretation\" [Burrell, 2016]. With the objective of reducing this gap, and inspired by the work of Burns et al. [2018], we hypothesize that the use of loss functions that have a concrete and more graspable perceptible meaning could make it easier to provide an explanation than a classic non intuitive cross-entropy. In Burns et al. [2018], authors introduce two new loss functions: the \"Appearance Confusion Loss\" and the \"Confident Loss\" in order to counterbalance gender bias during an image captioning process. The Appearance Confusion Loss is based on the fact that for an image devoid of gender information, the probability of predicting man or woman should be equal; and the Confident Loss exists to encourage the model to predict gender words correctly when gender evidence is present.\nIn order to test our model, we address the problem of reducing the bias in image captioning explained in Burns et al. [2018]. In a succinct manner, it consists in training a neural network using images I, image captions S, and image segmentation annotation masks M, with a Neural Image Caption network [Vinyals et al., 2014] as a base. We chose this problem because it represents a case where the creation of a KB from the data is possible, and because captioning is vulnerable to bias.\nWe propose creating the reasoning-facilitating KB by performing word-embedding on the black box model labels in order to determine which words are particularly exposed to a risk of errors due to learning priors or biased data collection. Interchangeable words are more likely to be victims of overuse of context [Zhao et al., 2017].\nTo show a trivial example, if seniors are represented with park benches more often than young adults, the model may tend to misuse the context by predicting a senior each time a bench is detected, without further caring about the person on the picture. Our explainable model proposes extracting a list noted as Bword and used in a similar syntax layout than a chosen word, such as Bperson = [man, teenager, boy, senior]. This means that man, teenager, boy and senior are often used in the same context as the word person. The extracted list will constitute a set of words base for which the model will have to hesitate when trying to predict one word rather than another. We call person a class while man, teenager, boy\nand senior are ontological sub-classes. We want to force the system to hesitate on which ontological sub-class it should predict when a class is present on an image, in order to not make any mistakes, but to be confident enough to nevertheless predict an ontological sub-class rather than a class, in order to be as specific as possible.\nWe propose to generalize the gender specific loss functions from Burns et al. [2018] in an attempt to force the system to be confused (or confident, resp.) when predicting any biasprone word, i.e, any ontological sub-class from the set Bword belonging to the word class.\nJust like Burns et al. [2018], we want to force our model to be confused when making predictions if the input image does not contain appropriate evidence for the prediction to be made. We use masked images I \u2032, where the information relevant to making a decision, such as the interior of a segmentation mask for a human in the image (if we are trying to determine whether or not the human classified is a senior or not), is removed. To ensure equiprobability among the different words in Bword when there is no appropriate information for the system to predict a specific word, but rather its generic category, we generalize the confusion function from Burns et al. [2018] to the general case where gender is not the only source of potential bias. We note confusion function C which operates over the predicted distribution of words p(w\u0303t):\nC(w\u0303t, I \u2032) = \u2211 b\u2208Bword (p(w\u0303t = b|w0:t\u22121, I \u2032)\u2212 1 J )2 (1)\nwhere J is the length of Bword. As we try to minimize C(w\u0303t, I\n\u2032), we have a sum of squares that tends toward zero. Given that if a sum of squares is zero, each term must be zero, each probability tends to be equal. As in Burns et al. [2018], we define the confusion loss LConfusion as:\nLConfusion = 1 N N\u2211 n=0 T\u2211 t=0 1(wt \u2208 Bword)C(w\u0303t, I \u2032), (2)\nwith 1 an indicator variable that denotes whether or not wt is a bias-prone word, N the batch size, and T the number of words in the given sentence. As we want the model to be confident about its prediction when there is an appropriate information on the image, this time we use complete (i.e., non masked) images I as input instead of masked ones I \u2032. With j the index of word b in list Bword, we have the confidence function F j .\nF j(w\u0303t, I) = \u2211 b\u2208Bword\\bj p(w\u0303t = b|w0:t\u22121, I) p(w\u0303t = bj |w0:t\u22121, I) +\n(3)\nAs in Burns et al. [2018], we add an for numerical stability. F j will tend towards zero if p(w\u0303t = bj) dominates the sum of the predicted distribution of every other bias-prone word.\nWe use F j to define the confident loss LConfidence:\nLConfidence = 1 N N\u2211 n=0 T\u2211 t=0 J\u2211 j=1 (1(wt = bj)F j(w\u0303t, I)) (4)\nBy adding a standard cross-entropy loss LCE to non-biasprone words, we obtain a model able to use context priors when there is no interchangeable word for the predicted one and to be confused/confident when the question arises thanks to the loss L:\nL = \u03b1LCE + \u03b2LConfidence + \u00b5LConfusion (5) with \u03b1, \u03b2 and \u00b5 hyper-parameters. The reasoner can provide a state-based explanation of the learning of the neural network, depending on the output result: i.e., it can naturally provide a confident explanation state if it succeeds to predict an ontological sub-class or a confused explanation state if it predicted a class, as shown in Fig. 2.\nThis model, when applied to image captioning or object recognition tasks, has several advantages: i) it detects the provenance of bias in a black box model such as a neural network, ii) gives an unbiased prediction for which the context has not been overused, and iii) gives an explanation in natural language on the neural network\u2019s functioning; particularly, on its loss-based optimization procedure."}, {"heading": "5 Conclusion", "text": "Models combining connectionism and symbolism are not widely represented in the state of the art of XAI. These paradigms are rarely combined when providing explanations. The use of a symbolic basis with a neural network can provide explanations close to the functioning of human reasoning while maintaining the state-of-the-art performance at the same time. We build upon Doran et al. [2017] and extend Burns et al. [2018] to further characterize what a neural-symbolic explainable model could output. We propose a model endowed with a non-external KB, i.e., directly built on the learning data of a neural network, that allows to influence its learning and to correct bias thoroughly, while giving a fair explanation\nfrom its predictions. As the user or expert external knowledge does not interfere the predictions in the explanation process, it constitutes a truly explainable model that is faithful to communicate the reasoning behind its output decisions. Future work will evaluate and challenge the model in realistic datasets."}], "title": "Towards Explainable Neural-Symbolic Visual Reasoning", "year": 2019}