{"abstractText": "Machine learning has proved to be very successful for making predictions in travel behavior modeling. However, most machine-learning models have complex model structures and offer little or no explanation as to how they arrive at these predictions. Interpretations about travel behavior models are essential for decision makers to understand travelers\u2019 preferences and plan policy interventions accordingly. Therefore, this paper proposes to apply and extend the model distillation approach, a model-agnostic machine-learning interpretation method, to explain how a black-box travel mode choice model makes predictions for the entire population and subpopulations of interest. Model distillation aims at compressing knowledge from a complex model (teacher) into an understandable and interpretable model (student). In particular, the paper integrates model distillation with market segmentation to generate more insights by accounting for heterogeneity. Furthermore, the paper provides a comprehensive comparison of student models with the benchmark model (decision tree) and the teacher model (gradient boosting trees) to quantify the fidelity and accuracy of the students\u2019 interpretations.", "authors": [], "id": "SP:ccfa0d38bdcdf1a9ebaca64680275b5af8f447e0", "references": [{"authors": ["X. Zhao", "X. Yan", "A. Yu", "P. Van Hentenryck"], "title": "Modeling stated preference for mobilityon-demand transit: A comparison of machine learning and logit models", "venue": "arXiv preprint arXiv:1811.01315,", "year": 2018}, {"authors": ["X. Zhao", "X. Yan", "P. Van Hentenryck"], "title": "Modeling Heterogeneity in Mode-Switching Be- Zhao et al. 16 havior Under a Mobility-on-Demand Transit System: An Interpretable Machine Learning Approach", "year": 1902}, {"authors": ["J.H. Friedman"], "title": "Greedy function approximation: A gradient boosting machine", "venue": "Annals of Statistics,", "year": 2001}, {"authors": ["A. Goldstein", "A. Kapelner", "J. Bleich", "E. Pitkin"], "title": "Peeking inside the black box: Visualizing statistical learning with plots of individual conditional expectation", "venue": "Journal of Computational and Graphical Statistics,", "year": 2015}, {"authors": ["G. Hooker", "L. Mentch"], "title": "Please Stop Permuting Features: An Explanation and Alternatives", "venue": "arXiv preprint arXiv:1905.03151,", "year": 2019}, {"authors": ["Y. Zhou", "Z. Zhou", "G. Hooker"], "title": "Approximation trees: Statistical stability in model distillation", "venue": "arXiv preprint arXiv:1808.07573,", "year": 2018}, {"authors": ["R.D. Gibbons", "G. Hooker", "M.D. Finkelman", "D.J. Weiss", "P.A. Pilkonis", "E. Frank", "T. Moore", "D.J. Kupfer"], "title": "The CAD-MDD: A computerized adaptive diagnostic screening tool for depression", "venue": "The Journal of Clinical Psychiatry,", "year": 2013}, {"authors": ["G. Hinton", "O. Vinyals", "J. Dean"], "title": "Distilling the knowledge in a neural network", "venue": "arXiv preprint arXiv:1503.02531,", "year": 2015}, {"authors": ["N. Papernot", "P. McDaniel", "X. Wu", "S. Jha", "A. Swami"], "title": "Distillation as a defense to adversarial perturbations against deep neural networks", "venue": "In 2016 IEEE Symposium on Security and Privacy (SP),", "year": 2016}, {"authors": ["D. McFadden"], "title": "Conditional Logit Analysis of Qualitative Choice Behaviour", "venue": "In Frontiers in Econometrics (P. Zarembka,", "year": 1973}, {"authors": ["M. Ben-Akiva", "M. Bierlaire"], "title": "Discrete choice methods and their applications to short term travel decisions", "venue": "In Handbook of Transportation Science,", "year": 1999}, {"authors": ["D.A. Hensher", "W.H. Greene"], "title": "The mixed logit model: The state of practice", "venue": "Transportation, Vol. 30, No", "year": 2003}, {"authors": ["C. Xie", "J. Lu"], "title": "Parkany, Work travel mode choice modeling with data mining: decision trees and neural networks", "venue": "Transportation Research Record: Journal of the Transportation Research Board,", "year": 2003}, {"authors": ["H. Omrani"], "title": "Predicting travel mode of individuals by machine learning", "venue": "Transportation Research Procedia,", "year": 2015}, {"authors": ["A. Lh\u00e9ritier", "M. Bocamazo", "T. Delahaye"], "title": "Acuna-Agost, Airline itinerary choice modeling using machine learning", "venue": "Journal of Choice Modelling,", "year": 2018}, {"authors": ["F. Wang", "C.L. Ross"], "title": "Machine Learning Travel Mode Choices: Comparing the Performance of an Extreme Gradient Boosting Model with a Multinomial", "venue": "Logit Model. Transportation Research Record: Journal of the Transportation Research Board,", "year": 2018}, {"authors": ["W.J. Murdoch", "C. Singh", "K. Kumbier", "R. Abbasi-Asl", "B. Yu"], "title": "Interpretable machine learning: definitions, methods, and applications", "venue": "arXiv preprint arXiv:1901.04592,", "year": 2019}, {"authors": ["F. Doshi-Velez", "B. Kim"], "title": "Towards a rigorous science of interpretable machine learning", "venue": "arXiv preprint arXiv:1702.08608,", "year": 2017}, {"authors": ["C. Molnar"], "title": "Interpretable Machine Learning", "venue": "https://christophm.github.io/interpretable-mlbook/,", "year": 2019}, {"authors": ["Q. Zhao", "T. Hastie"], "title": "Causal interpretations of black-box models", "venue": "Journal of Business & Economic Statistics,", "year": 2019}, {"authors": ["S. Wager", "S. Athey"], "title": "Estimation and Inference of Heterogeneous Treatment Effects using Random Forests", "venue": "Journal of the American Statistical Association,", "year": 2018}, {"authors": ["S. Athey"], "title": "Beyond prediction: Using big data for policy problems", "venue": "Science, Vol. 355,", "year": 2017}, {"authors": ["A. Adadi", "M. Berrada"], "title": "Peeking inside the black-box: A survey on Explainable Artificial Intelligence (XAI)", "venue": "IEEE Access,", "year": 2018}, {"authors": ["S. Tan", "R. Caruana", "G. Hooker", "Y. Lou"], "title": "Distill-and-Compare: Auditing Black-Box Models Using Transparent Model Distillation", "venue": "In Proceedings of the 2018 AAAI/ACM Conference on AI, Ethics, and Society,", "year": 2018}, {"authors": ["Y. Lou", "R. Caruana", "J. Gehrke"], "title": "Intelligible models for classification and regression", "venue": "In Proceedings of the 18th ACM SIGKDD international conference on Knowledge discovery and data mining,", "year": 2012}, {"authors": ["T.A. Arentze", "H.J. Timmermans"], "title": "A learning-based transportation oriented simulation system", "venue": "Transportation Research Part B: Methodological,", "year": 2004}, {"authors": ["R.M. Pendyala", "R. Kitamura", "D.P. Reddy"], "title": "Application of an activity-based traveldemand model incorporating a rule-based algorithm", "venue": "Environment and Planning B: Planning and Design,", "year": 1998}, {"authors": ["C.R. Bhat"], "title": "Incorporating observed and unobserved heterogeneity in urban work travel mode choice modeling", "venue": "Transportation Science,", "year": 2000}, {"authors": ["J. Anable"], "title": "Complacent Car Addicts\u2019 or \u2018Aspiring Environmentalists\u2019? Identifying travel behaviour segments using attitude theory", "venue": "Transport Policy,", "year": 2005}, {"authors": ["X. Yan", "J. Levine", "X. Zhao"], "title": "Integrating ridesourcing services with public transit: An evaluation of traveler responses combining revealed and stated preference data", "venue": "Transportation Research Part C: Emerging Technologies,", "year": 2018}, {"authors": ["T. Hastie", "R. Tibshirani", "J. Friedman"], "title": "The Elements of Statistical Learning, Vol. 1. Springer series in statistics", "year": 2001}, {"authors": ["G. Ridgeway"], "title": "gbm: Generalized Boosted Regression Models, 2017, R package version 2.1.3", "year": 2017}, {"authors": ["B. Ripley"], "title": "tree: Classification and Regression Trees, 2016, R package version 1.0-37", "year": 2016}], "sections": [{"text": "Keywords: model distillation, travel mode choice, black-box, interpretation, heterogeneity"}, {"heading": "INTRODUCTION", "text": "Applying machine learning to model travel behavior has become popular in the past several years. With much higher predictive accuracy compared to traditional random utility models, the machinelearning approach has become appealing for making predictions, especially at the individual level. However, many machine-learning models are black-box and are often deemed as uninterpretable; interpretation, on the other hand, is an important aspect of travel behavior modeling\u2014to conduct policy analysis and facilitate decision making. Interpretable or explainable machine learning, an emerging field in Statistics and Computer Science, has attracted a lot of attention in the past two years. It aims at peeking into the black box to extract relevant knowledge and provides useful insights about the importance of various features and how they impact predictions. Zhao et al. (1, 2) have explored applying several model-agnostic machine-learning interpretation methods, including variable importance, partial dependence plots (3), individual conditional expectation plots (4), marginal effects, and elasticity to explain the black-box travel mode choice models. However, most of these methods are permutation-based, and they may produce misleading diagnostics, particularly when strong dependences exist among features (5). As an alternative, model distillation methods have been advocated by some researchers to offer more direct interpretations about black-box models (6\u20138). Model distillation operates by developing intelligible student models that mimic the predictions of the original black-box teacher model. The model distillation approach may be able to provide direct explanations from the transparent student models, whose fidelity (how well the mimic model\u2019s outputs agree with the teacher model\u2019s predictions) and accuracy (how many test-set instances can be correctly classified) can be quantitatively measured. These insights then can be used to guide transportation planning and policy interventions. However, to the best of our knowledge, model distillation has not been applied to interpret black-box travel behavior models. This paper aims at addressing this research gap by using model distillation to interpret a black-box travel mode choice model that evaluates travelers\u2019 preferences for a new mobility-on-demand (MOD) transit system. Moreover, model distillation applications have traditionally focused on interpreting predictions for the entire population under evaluation (e.g., (7, 9)). However, in travel behavior modeling, researchers and practitioners may be more interested in specific segments of the population, such as car users, female population, and low-income population to name only a few (10). Therefore, this paper proposes to integrate model distillation with market segmentation (a widely-adopted econometric method) to investigate the taste heterogeneity of the population and develop better-targeted policies for various groups under evaluation.\nThe unique contributions of this paper are summarized as follows: \u2022 Apply model distillation, an interpretable machine learning tool, to explain black-box\ntravel mode choice models, aiming at drawing useful insights from complex machinelearning models for policy analysis and decision making; \u2022 Integrate model distillation with market segmentation to generate more insights by accounting for heterogeneity and design better-targeted policies; \u2022 Propose a methodological framework to guide machine-learning travel behavior modelers to implement the overall idea.\nThe rest of the paper is organized as follows. Section 2 reviews existing literature on travel mode choice modeling using traditional random utility models and machine learning. Section 3 describes the methodological framework, including the fundamentals of model distillation and\nthe integration of model distillation with market segmentation. Section 4 applies the proposed framework to a case study of stated-preference data for a new MOD transit system in Ann Arbor, Michigan. Lastly, the paper concludes by summarizing the major findings and suggesting future research directions."}, {"heading": "LITERATURE REVIEW Random Utility Models and Their Applications in Travel Behavior Modeling", "text": "The random utility model is a class of econometric models based on random utility maximization theory (11), and has been widely applied to model travel mode choice since 1970s (12). It assumes that each travel mode has its own utility, and an individual tends to choose the travel mode with the highest utility. There are various types of random utility models, and the simplest and most popular one is the multinomial logit (MNL) model. However, the MNL model is often challenged for its major assumption, i.e., the independence of irrelevant alternatives (IIA) property, and its inability to model taste heterogeneity among different individuals. In order to tackle these limitations, the nested logit model and mixed logit model were later developed (13). The nested logit model was specifically invented to account for the correlated alternatives (i.e., travel modes). The mixed logit model, as a more advanced random utlity model, does not rely on the IIA property and can accommodate individual heterogeneity (14). Even though random utility models are based on sound behavioral assumptions and can offer intuitive interpretations, they often suffer from poor predictive capabilities, especially at the individual level (e.g., 1, 15\u201317)."}, {"heading": "Interpretable Machine Learning and Its Applications in Travel Behavior Modeling", "text": "Machine learning, with flexible modeling structure and high predictive accuracy, has gained a lot of popularity in the research area of travel behavior modeling (e.g., 15\u201319). For instance, Xie et al. (15) used decision trees and artificial neural networks to model travel mode choice and showed improved predictive accuracy over the MNL model. Later, Omrani (16) compared the MNL model with the support vector machine, multi-layer perceptron network, and the radial basis function network, and found that the latter three machine-learning models have significant better predictive capability than the MNL model in terms of overall accuracy and accuracy for each travel mode. Then, Hagenauer and Helbich (17) conducted a comprehensive comparison of multiple machine-learning algorithms for modeling travel mode choice and found that the random forest model outperformed all the other models in terms of prediction. However, these studies mainly focused on improving the predictive accuracy by using machine learning, with little discussion on how to interpret these machine-learning models for better decision-making. Fortunately, interpretable or explainable machine learning has drawn much attention in the fields of Statistics and Computer Science over the past two years (e.g 6, 20\u201325), in order to \u201cX-ray the black box\u201d and facilitate knowledge extraction from machine learning. In particular, Zhao et al. (1) applied several popular machine-learning interpretation tools to model and explain travel mode choice for the entire population under evaluation. Subsequently, Zhao et al. (2) looked into how to account for the taste heterogeneity in travel mode choice by applying existing and inventing new interpretable machine learning techniques. However, some of the tools used in these two studies are permutation-based, and as pointed out by Hooker and Mentch (5), they may generate misleading results, when there are strong dependencies among features.\nIn contrast, model distillation is another major approach for interpretable machine learning that can overcome the limitations of permutation-based methods and offer transparent explanations. For instance, Bucilu\u00c7O\u030b et al. (26) trained compact artificial neural nets to mimic the functioned learned by an ensemble methods. They used the term model compression instead of distillation as their main purpose is to compress the large model without significant loss in prediction performance. A successful application was presented in (7), where the authors resorted to decision trees as student model for shortening medical questionnaires, reducing data collection burden and improving interpretation. Hinton et al. (8) further developed model distillation using a different compression technique. Most recently, Zhou et al. (6) examined statistical stability in model distillation using regression trees. They developed tests to stabilize the choice of splits and a stopping rule to indicate how deep the tree should be built. Nevertheless, the model distillation approach has not been used to examine how black-box travel behavior models arrive at these predictions and how to draw useful insights for decision making."}, {"heading": "METHODOLOGY", "text": "This section first introduces the fundamentals of model distillation. It then discusses how to integrate model distillation with market segmentation to account for heterogeneity across different subpopulations. Lastly, it proposes the overall methodological framework."}, {"heading": "Fundamentals of Model Distillation", "text": "It is difficult to explain how black-box machine-learning models work. The task of extracting knowledge from a black-box model is to summarize, in a comprehensible way, the knowledge learned by a black-box model during training (27). A popular technique for knowledge extraction of black-box models is called model distillation. Distillation can be seen as a model compression process to transfer knowledge from a large, complex teacher model to an interpretable student model (8, 28). In other words, model distillation gains insights and draws conclusions about the teacher model by interpreting the student model. Model distillation is typically achieved by using the teacher model to make predictions for the unlabeled samples (either new unlabeled data or training data with labels discarded), and then training the student model to mimic the teacher\u2019s predictions (28). Furthermore, in order to transfer the generalization ability of the teacher to a student model, one can use the soft predictions (i.e., the predicted class probabilities) of the teacher model as the target to train the student model. Compared with a hard label, the predicted class probabilities can offer much richer information about similarity between the classes and reveal teacher model\u2019s confidence in prediction (8). In order to measure the student model\u2019s performance in approximating the teacher\u2019s model (referred to as the fidelity), different evaluation methods can be used. One commonly-adopted method is the R-squared measure (or R2) (22):\nR2 = 1\u2212 \u2211 n i=1(Y\u0302i\u2212 Y\u0303i)2\n\u2211ni=1(Y\u0302i\u2212 \u00af\u0302Y )2\n,\nwhere Y\u0302i is the prediction for the ith observation of the teacher model, Y\u0303i is the prediction for the ith observation of the student model, \u00af\u0302Y is the mean of the teacher model\u2019s predictions, and n is the total number of observations. R2 quantifies how much variance can be explained by the student\nmodel. If R2 is close to 1, it indicates that the student model can approximate the teacher model very well; in contrast, if it is close to 0, it shows poor performance of the student model to interpret the teacher model. The student model is trained to interpret the teacher model, so the interpretation gained from the student model is all about exploring the internal prediction mechanism of the black-box model. The main question then is whether this interpretation can be used and trusted for policy analysis and decision making? This paper argues that this depends on three major conditions. The first condition is the predictive capability of the teacher model. Without an accurate teacher model, the interpretation of the student model may become irrelevant. The second condition is the fidelity of the student model. If a student model is highly faithful to the teacher, the interpretations gained from the teacher can be trusted with high confidence. The third condition is the predictive accuracy of the student model. The student model is typically evaluated against in-sample R2 for its fidelity (22); however, a student model may overfit the training data (showing high R2) but lack out-ofsample predictive capability. This paper argues that it is necessary to leverage the ground-truth outcome information of a separate test set to evaluate the student model\u2019s out-of-sample predictive accuracy. Within model distillation, any interpretable model can be used as student models, which offers lots of flexibility for further analysis and explanation. Common student model classes include (generalized) linear models (28), generalized additive models (29) and decision trees (6, 7). Decision trees are the focus in this paper: They present an intelligible graphical representation and may automatically capture complex high-dimensional data, making them appealing as student models. Moreover, their rule-based structure can be directly fed into some activity-based travel demand model, such as ALBATROSS (30) and AMOS (31)."}, {"heading": "Integrating Model Distillation with Market Segmentation", "text": "In travel mode choice modeling, understanding taste heterogeneity is an important research topic within the random utility framework. From a modeler\u2019s standpoint, taste heterogeneity can be divided into two parts, including observed and unobserved heterogeneity. The observed heterogeneity mainly results from the observed individual features and/or their interactions with the level-ofservice features, while the unobserved heterogeneity is usually caused by the unobserved individual features, such as the individuals\u2019 intrinsic bias towards different travel modes and/or their different degrees of sensitivity to the level-of-service features (32). In particular, the observed heterogeneity can be modeled by adding observed individual socio-demographic or behavioral features as alternative specific variables and/or by modeling interactions between level-of-service features and observed individual features, e.g., by applying a market segmentation approach or introducing interaction terms (32). In the market segmentation approach, sub-populations from a market are selected according to the observed feature(s) and thus declared as \u201csegments.\u201d Market segmentation aims at analyzing a manageable number of groups that share well-defined underlying features and generating more innovative and better-targeted strategies for different groups (33). Zhao et al. (2) have demonstrated that applying the market segmentation approach to partial dependence plots and individual conditional expectation plots can help extract additional insights for various market segments. Therefore, this paper proposes to apply the market segmentation approach to model distillation, aiming at better understanding heterogeneous population and generating more effective policies for the subpopulations of interest."}, {"heading": "Proposed Methodological Framework", "text": "This paper proposes an overall methodological framework to guide transportation planners and engineers to extract insights from black-box travel behavior models, which is illustrated in Figure 1. It assumes the availability of a dataset that includes individual travel mode choice before and after a new mobility service is introduced. The tth observation of the dataset is represented as (X t ,Yt), t = 1,2, ...,T , where X t = [Xt1, ...,Xt p], a vector of p features for individual t, Yt is the response variable, and T is the total number of observations. To be specific, X t include important information of each individual such as her socio-demographic information, her travel preference, and her level-of-service variables for each travel mode under evaluation. The response variable Yt is binary with 0 indicating that individual t stays with her current mode and 1 if she switches to the new mobility option; that is to say, Yt \u2208 {0,1}. As shown in Figure 1, the original dataset is split into two separate subsets, with N observations in the training set and M observations in the test set, where N +M = T . The training set is used to train the black-box teacher model. Then, additional synthetic data are generated to form a new training dataset. The main reason for doing this step is because the decision trees (the focus of this paper) may be sensitive to small perturbations and lead to unstable model structures.\nHence, as discussed in (6, 7), synthetic data can be generated from a kernel density estimate based on the observed features. For the original training data along with the generated synthetic data, i.e., X k,k = 1, ...,K, the teacher model is used to make soft predictions (i.e., switching probabilities) for each instance, where the soft predictions can be denoted as Y\u0302i \u2208 [0,1]. Thus, X k and Y\u0302k form the new training set, D = {X k,Y\u0302k}Kk=1, which can be directly used to train the student model for the entire market (which is celled here the overall student model). The new training data can also be further divided into disjoint subsets by applying a market segmentation approach as discussed earlier. Consider a categorical feature X s and its set of possible values, i.e., S = {S1, ...,SQ}. The market segmentation approach based on feature X s divides the entire new training set D into Q disjoint subsets, i.e., DS1,DS2, ...,DSQ , where DSq represents a subset with each Xs = Sq,q = 1, ...,Q. Consider now another categorical feature X v,v 6= s with possible values V = {V1, ...,VL}. Then, the market segmentation approach based on X s and X v divides the new training set D into Q\u00d7L disjoint subsets, and a subset DSq,Vl indicates a subset with Xs = Sq and Xv = Vl . These definitions can be naturally extended to market segmentation based on multiple features and to non-categorical features by partitioning its domain. Observe that, when a decision tree is used as a student model to train on the whole data set, a similar phenomenon may be observed as its splits are essentially partition the data into disjoint subsets. However, manual market segmentation offers several advantages. First, decision trees are restricted to binary splits, but it may be more desirable to segment the domain into more subsections depending on the specific feature used. Moreover, market segmentation is usually conducted using some expert knowledge as to which feature to use, and the resulting subsets ideally exhibit more homogeneity, thus improving prediction accuracy and interpretation. These subsets are then used to train different student models for different subpopulations (e.g., student model 1 for subset 1). Note that the model class of the students is typically determined by the modelers based on their preferences and needs. The evaluation of the the student models\u2019 performance, computes and compares two metrics, including R2 (for fidelity) and out-of-sample prediction error (for accuracy). The resulting student models can be used for drawing inferences, extracting knowledge, and facilitating decision making."}, {"heading": "CASE STUDY", "text": "The proposed methodological framework aims at guiding those using machine learning for modeling travel behavior in how to apply model distillation to achieve various explanations and insights. This framework was implemented in the following case study of Ann Arbor, Michigan to illustrate the process and show the feasibility of the approach."}, {"heading": "The Data and Pre-Processing", "text": "The data was collected from a stated-preference survey conducted at the University of Michigan, Ann Arbor, in 2017. It collected responses from the participants (including faculty, staff, and students) about the estimated travel time, travel cost, and wait time for their commuting trip from one of following travel modes: Car, Walk, Bike, and Bus. Then, the survey presented the participants a new mobility option (i.e., MOD Transit) that would replace the existing bus system, and asked them to re-evaluate their mode choices in various state-choice experiments with different levels of service for MOD Transit. The detailed description for the survey design is included in (34). This paper aims at evaluating the factors underlying individuals\u2019 intention to switch to the new travel mode, i.e., MOD Transit. In other words, the goal is to model modal shift from people\u2019s\ncurrent travel mode to the new MOD Transit: Other travel behavior changes, such as switching from Walk to Bike, is not of interest here. The response variable is binary with 1 indicating the decision of switching to MOD Transit and 0 denoting the decision of not switching to MOD Transit. As MOD Transit is deemed as a new travel mode, hence, individuals who currently use bus services are considered as switching to MOD Transit if she chooses the new travel mode. In total, 8,141 observations were collected from 1,163 individuals, as each individual conducted seven state-choice experiments. The statistics for 14 selected features and the response variables are provided in Table 1. Note that the Income feature indicates the annual household income for faculty/staff and the annual living expenditure for students, and the detailed definition of the six different income levels for faculty/staff and students is presented in Table 2.\nBefore training the teacher and student models, the data was checked for multicollinearity: All features have a variance inflation factor of no more than five (a commonly-used threshold), indicating that multicollinearity is not an issue in this study. As each individual filled out seven experiments, the test set consisted of a randomly sampled experiment for each individual (i.e., 1,163 instances are held out for testing the out-of-sample prediction capability). The remaining\n85.7% of the data (with 6,978 instances) is used for training. As discussed earlier, additional synthetic data should be generated to enhance the stability of decision trees; however, our original data is relatively high-dimensional and the kernel density method (used in (6, 7)) is difficult to be applied here to generate additional data. Additionally, the size of our dataset seems to be adequate to fit relatively stable decision trees. Therefore, instead of generating synthetic data, we randomly hold out 30% of the training data as the \u201cadditional\u201d data and use the remaining 70% to fit the teacher model (i.e., 60% of the entire dataset). This makes it possible to test out the proposed methodological framework (see Figure 1) and evaluate its performance in a holistic manner. The process is repeated for 30 times to generate mean estimate and its standard deviations as shown in Table 3."}, {"heading": "Teacher Model: Boosting Trees Model", "text": "When training a teacher model, one is advised to select a set of candidate machine-learning models first and then compare the model performance through cross validation or holdout testing. Zhao et al. (2) used the same dataset1 and identified the boosting trees model as the best-performing model among seven different machine learning classifiers, including logistic regression, Naive Bayes, classification and regression tree (CART), bagging trees, boosting trees, random forests, and artificial neural networks. Therefore, in this paper, the boosting trees model is used as the teacher model. Boosting trees is one of the most popular tree-based ensemble methods that aims at forming robust, stable, and accurate classifiers compared to a single decision tree (3, 35). For a classification problem, the boosting trees model generates a sequence of decision trees, where each successive decision tree seeks to improve the classification accuracy of the previous one. For the boosting trees model, the final predicted outcomes are based on a weighted voting among all the trees. This paper applies the gradient boosting method to create the boosting trees model (3). Specifically, the hyperparameters are selected as: 500 trees are used, with the shrinkage parameter set to 0.062 and the interaction depth to 45, and the minimum number of observations in leaves is 10. The R package gbm (36) is used for conducting the modeling and analysis. Then, according to the methodological framework (see Figure 1), the class labels of the training data are discarded, and the teacher model is used to make soft predictions (i.e., the switching probabilities) for the same training data. The input features together with the predicted outcome of the teacher model form the new training data, which will be used to train student models."}, {"heading": "Student Models", "text": "As mentioned, this paper focuses on decision trees to fit student models. Decision trees recursively partition the feature space into sub-regions until some stopping rule is applied (35, p. 305). Decision trees can be used for both regression and classification, and in this paper, the CART algorithm is applied through the R package tree (37). The decision tree is good at modeling the nonlinearity between the outcome and features as well as capturing the interactions between input features. Moreover, decision trees can present a straightforward visualization and offer good interpretability (as long as the tree size is not too large). Therefore, to control the complexity of the decision trees for transparent interpretations, we limit the tree size (i.e. the number of terminal nodes or leaves) to be no more than 10. However, as discussed in Molnar (22), the decision tree lacks smoothness in\n1A slight difference is that, in this paper, three binary features used in (2), including Current_Mode_Car, Current_Mode_Walk, and Current_Mode_Bike, are combined into a four-level feature, i.e., Current_Mode.\npredictions or stability of the tree structure; in addition, the trees cannot model linear relationships efficiently since the linear relationships are approximated by splits (i.e., a step function). In this paper, multiple decision-tree-based student models are trained for the entire market and different subgroups (categorized by the current travel mode or by the income levels). As a comparison, we fit a benchmark decision tree model using the same data (i.e., 60% of the entire dataset) that is used to train the teacher model."}, {"heading": "Model Comparison", "text": "This section compares the performance of the student models, the benchmark decision tree model, and the teacher model, in terms of fidelity and accuracy. Additionally, it investigates the model interpretation of the overall student model and the benchmark decision tree model, and further looks into the explanations of the student models for different subpopulations. Some of the key observations are summarized here: 1) The overall student model can improve performance compared to the benchmark decision tree; 2) Segmented by income levels, the resulting student models can be significantly improved compared to the overall student model and the benchmark decision tree; 3) The interpretation gained from the overall student model is similar but has differences (more sophisticated) than that obtained from the benchmark decision tree; and 4) The student models for different income levels present various decision rules, leading to rich insights for policy design."}, {"heading": "Fidelity and Accuracy", "text": "Table 3 shows the comparison of student models, the benchmark decision tree, and the teacher model, with R2 quantifying how the student model is faithful to the teacher\u2019s predictions and the out-of-sample accuracy capturing the predictive capability of different models.\nThe results of R2 are shown in the first column of Table 3. Some of the student models have relatively high R2 statistics, i.e., well above 0.5; however, some of them have R2 less than 0.3, showing relatively poor variance explanation for the teacher. However, it remains unclear\nhow to determine the best threshold for R2 in order to be confident about the student model\u2019s interpretation (22). An important observation is that the overall student model has a fair R2 value (0.3018), but by splitting the entire population by income levels and fit different student models, the corresponding R2 values are all improved, especially for income levels 3 through 6. In contrast, when disaggregating the population by the current travel mode choice, the corresponding R2 has mixed outcomes: It is improved for Walk and Bike, but becomes worse for Car and MOD Transit. One possible explanation is that people who are currently using motorized modes are presenting very heterogeneous switching behavior and cannot be fully captured by a single decision tree; similar results can be found in Zhao et al. (2). For the out-of-sample accuracy, the overall student model (0.7333) is showing significantly better performance than the benchmark decision tree (0.7197), according to the p-value (2.152 \u00d710\u22125) of a one-sided t-test of the mean estimates for the benchmark decision tree and the overall student model. That is to say, by applying model distillation, the student decision tree can make better predictions than the benchmark decision tree. This is a reasonable phenomenon to expect as the teacher model is able to capture more complex signal in the data and by mimicking its predictions, the student decision tree can extract additional information from an enriched training data and more meaningful target values (7, 8). Furthermore, by segmenting the entire population by the current travel mode and the income level, the resulting student models all show higher out-of-sample accuracy than the benchmark decision tree. The main reason is that the benchmark decision tree is fitted for the entire population while these student models only focus on specific market segments and offer more specialized interpretations. Notably, some of the student models (e.g., Bike and Income = 5) can achieve similar predictive accuracy compared to the teacher model and produce high R2 values (showing its high faithfulness to the teacher\u2019s predictions), so they may be used to replace the teacher model in these cases. Another finding is that R2 and the out-of-sample predictive accuracy are not necessarily positively correlated: Even though R2 for Income = 3 is significantly higher than that for Income = 1, the corresponding predictive accuracy for Income = 3 is lower. This is probably due to overfitting. Furthermore, R2 for Walk is not high (0.3100) and it is high (0.5647) for Income = 4, but Walk and Income = 4 have the same level of out-of-sample predictive accuracy (0.8130 and 0.7937, respectively).\nModel Interpretation To interpret the student models and compare their interpretation with that gained from the benchmark decision tree model, we present the visualization of the fitted decision trees from a random realization. Figure 2 presents the benchmark decision tree and the overall student model. Note that the benchmark decision tree is trained on the original training data with the response variable being binary, so the fitted tree is a classification tree; on the other hand, the overall student model is trained on the new training data with the response variable being the switching probability predictions provided by the teacher model, so the fitted tree is a regression tree. Thus, according to the benchmark decision tree (see Figure 2a), we can find that only when the biking time is more than 12.5 min, the current travel mode is Bus, and the number of transfers is less than 1.5, the travelers will switch to MOD Transit. Figure 2b shows the overall student model for the entire population. If we transfer the switching probability to a binary outcome (i.e., if the switching probability is less than 0.50, it indicates not switching, and vice versa), then we find that under two sets of decision rules people\nwill switch to MOD Transit: One is the same set of rules as the benchmark decision tree; the other is when the biking time is over 12.5 min, the current mode is driving, walking, or biking, and the travel time of MOD Transit is less than 16.5 min. Apparently, the switching logic presented by the benchmark decision tree is too simple, indicating no people will switch to MOD Transit other than the existing bus users. In contrast, the overall student model presents two different sets of decision rules, and one of them shows how non-transit users can be attracted to the new travel mode, i.e., MOD Transit, and this insight is particularly of interest for transportation planners. To summarize, the interpretation obtained from the overall student tree shares many similarities with the benchmark decision tree, but offers new and more sophisticated insights compared to that gained from its counterpart. Figure 3 illustrates the student models for income = 1, 3, 5. These three models share some similarities: For example, features such as travel times for different modes and the current travel mode are used in all the three decision trees to determine splits. Despite their similarities, they have much more differences. For the student model for income = 1 (see Figure 3a), we can find that the decision rules for switching to MOD Transit are very similar to those for the overall student model with some variations; in particular, TT_Walk instead of TT_Bike is used at the top node for splitting, and the waiting time plays an important role in the decision making process\nfor the low-income population. The student model for income = 3 resembles the student model for income = 1, but becomes more complex and has Female as an important feature for splitting. On the other hand, the student model for income = 5 becomes rather different from the student models for income = 1, 3; for the high-income population, in addition to travel times and current mode, people consider car ownership, the importance of bike- and walk-ability, and the number of additional pickups in MOD to decide if MOD Transit is a preferred mode for commuting. From these observations above, we may conclude that people with different income levels have very\ndiverse decision-making processes for switching or not to MOD Transit. These insights can help design better-targeted policies to promote the modal shift from private vehicles to MOD Transit."}, {"heading": "DISCUSSION AND CONCLUSION", "text": "This paper applied and extended model distillation to interpret black-box travel mode choice models. By compressing the knowledge from complex teacher models into understandable and interpretable student models, model distillation and its proposed extension can help transportation planners and engineers gain valuable insights for decision-making. In particular, the integration of model distillation with market segmentation generates unique insights that can be translated into more focused policies. The student models have a tree structure with clear visualizations and transparent interpretations. For agencies that plan to use black-box machine-learning methods to model travel behavior, model distillation can serve as a decision-support tool for policy makers to extract the underlying prediction mechanism of the black-box model, understand the relationships between the input features and outcomes, conduct policy analysis to assess different strategies, and plan interventions accordingly. From an accuracy standpoint, the results show that student models can achieve better performance than the benchmark decision tree models. By using the predicted soft target (instead of using the binary hard label) to train the student models, they can learn more information about the prediction mechanism of the teacher model and thus achieve better out-of-sample predictive capability. To further support this argument, we fitted another benchmark decision tree model using the same data (i.e., 85.7% of the entire dataset) that is used to train the overall student model, but with the observed switching choice as the response variable. The results show that the out-of-sample accuracy of the new benchmark decision tree model is 0.7226 (versus 0.7333 for the overall student model). A one-sided t-test was also conducted and the results show that the overall student model is significantly better than the benchmark decision tree model (p-value = 1.821\u00d7 10\u22124). This shows that model distillation can help student models directly learn from the teacher model (via the predicted soft target) and thus achieve better performance. In addition, with the teacher model, additional synthetic data can be generated to train student models, which can not only help further improve the predictive capability of student models but also make the student decision trees more stable (6). More accurate student models, especially student models for subpopulations, may be used to replace the black-box teacher model for undertaking the forecasting task as well as offering crisp explanations. For example, the learned student models can be used as an input into some activity-based travel demand models, such as (30, 31), to improve their predictive accuracy."}, {"heading": "ACKNOWLEDGEMENTS", "text": "This research was partly funded by the Georgia Institute of Technology, the Michigan Institute of Data Science (MIDAS), and Grant 7F-30154 from the Department of Energy."}], "year": 2019}