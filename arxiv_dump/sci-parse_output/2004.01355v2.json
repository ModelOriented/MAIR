{"abstractText": "Algorithmic decision making based on computer vision and machine learning technologies continue to permeate our lives. But issues related to biases of these models and the extent to which they treat certain segments of the population unfairly, have led to concern in the general public. It is now accepted that because of biases in the datasets we present to the models, a fairness-oblivious training will lead to unfair models. An interesting topic is the study of mechanisms via which the de novo design or training of the model can be informed by fairness measures. Here, we study mechanisms that impose fairness concurrently while training the model. While existing fairness based approaches in vision have largely relied on training adversarial modules together with the primary classification/regression task, in an effort to remove the influence of the protected attribute or variable, we show how ideas based on well-known optimization concepts can provide a simpler alternative. In our proposed scheme, imposing fairness just requires specifying the protected attribute and utilizing our optimization routine. We provide a detailed technical analysis and present experiments demonstrating that various fairness measures from the literature can be reliably imposed on a number of training tasks in vision in a manner that is interpretable. A project page is available on //GitHub.", "authors": [{"affiliations": [], "name": "Vishnu Suresh Lokhande"}, {"affiliations": [], "name": "Aditya Kumar Akash"}, {"affiliations": [], "name": "Sathya N. Ravi"}, {"affiliations": [], "name": "Vikas Singh"}], "id": "SP:f60e9ce90dfebcbc3887974b30ddbc078ef3597a", "references": [{"authors": ["Alekh Agarwal", "Alina Beygelzimer", "Miroslav Dud\u0131\u0301k", "John Langford", "Hanna Wallach"], "title": "A reductions approach to fair classification", "venue": "arXiv preprint arXiv:1803.02453,", "year": 2018}, {"authors": ["Hilal Asi", "John C Duchi"], "title": "Stochastic (approximate) proximal point methods: Convergence, optimality, and adaptivity", "venue": "SIAM Journal on Optimization,", "year": 2019}, {"authors": ["Samuel A Barnett"], "title": "Convergence problems with generative adversarial networks (gans)", "venue": "arXiv preprint arXiv:1806.11382,", "year": 2018}, {"authors": ["Yahav Bechavod", "Katrina Ligett"], "title": "Penalizing unfairness in binary classification", "venue": "arXiv preprint arXiv:1707.00044,", "year": 2017}, {"authors": ["Dimitri P Bertsekas"], "title": "Constrained optimization and Lagrange multiplier methods", "venue": "Academic press,", "year": 2014}, {"authors": ["Kelsey Blackburn", "James Schirillo"], "title": "Emotive hemispheric differences measured in real-life portraits using pupil diameter and subjective aesthetic preferences", "venue": "Experimental Brain Research,", "year": 2012}, {"authors": ["Marc B\u00f6hlen", "Varun Chandola", "Amol Salunkhe"], "title": "Server, server in the cloud. who is the fairest in the crowd", "venue": "arXiv preprint arXiv:1711.08801,", "year": 2017}, {"authors": ["Tolga Bolukbasi", "Kai-Wei Chang", "James Y Zou", "Venkatesh Saligrama", "Adam T Kalai"], "title": "Man is to computer programmer as woman is to homemaker? debiasing word embeddings", "venue": "In Advances in neural information processing systems,", "year": 2016}, {"authors": ["Joy Buolamwini", "Timnit Gebru"], "title": "Gender shades: Intersectional accuracy disparities in commercial gender classification", "venue": "In Conference on fairness, accountability and transparency,", "year": 2018}, {"authors": ["Flavio Calmon", "Dennis Wei", "Bhanukiran Vinzamuri", "Karthikeyan Natesan Ramamurthy", "Kush R Varshney"], "title": "Optimized pre-processing for discrimination prevention", "venue": "In Advances in Neural Information Processing Systems,", "year": 2017}, {"authors": ["L Elisa Celis", "Lingxiao Huang", "Vijay Keswani", "Nisheeth K Vishnoi"], "title": "Classification with fairness constraints: A meta-algorithm with provable guarantees", "venue": "In Proceedings of the Conference on Fairness, Accountability, and Transparency,", "year": 2019}, {"authors": ["Pratik Chaudhari", "Stefano Soatto"], "title": "Stochastic gradient descent performs variational inference, converges to limit cycles for deep networks", "venue": "Information Theory and Applications Workshop (ITA)", "year": 2018}, {"authors": ["Caitlin Chin"], "title": "Assessing employer intent when ai hiring tools are biased, Dec 2019", "year": 2019}, {"authors": ["Alexandra Chouldechova"], "title": "Fair prediction with disparate impact: A study of bias in recidivism prediction instruments", "venue": "Big data,", "year": 2017}, {"authors": ["Andrew Cotter", "Heinrich Jiang", "Karthik Sridharan"], "title": "Twoplayer games for efficient non-convex constrained optimization", "venue": "arXiv preprint arXiv:1804.06500,", "year": 2018}, {"authors": ["Andrew Cotter", "Heinrich Jiang", "Serena Wang", "Taman Narayan", "Maya Gupta", "Seungil You", "Karthik Sridharan"], "title": "Optimization with non-differentiable constraints with applications to fairness, recall, churn, and other goals", "venue": "arXiv preprint arXiv:1809.04198,", "year": 2018}, {"authors": ["Michele Donini", "Luca Oneto", "Shai Ben-David", "John S Shawe-Taylor", "Massimiliano Pontil"], "title": "Empirical risk minimization under fairness constraints", "venue": "In Advances in Neural Information Processing Systems,", "year": 2018}, {"authors": ["John C Duchi", "Peter L Bartlett", "Martin J Wainwright"], "title": "Randomized smoothing for stochastic optimization", "venue": "SIAM Journal on Optimization,", "year": 2012}, {"authors": ["Alhussein Fawzi", "Pascal Frossard"], "title": "Measuring the effect of nuisance variables on", "venue": "classifiers. pages 137.1\u2013137.12,", "year": 2016}, {"authors": ["Benjamin Fish", "Jeremy Kun", "\u00c1d\u00e1m D Lelkes"], "title": "A confidence-based approach for balancing fairness and accuracy", "venue": "In Proceedings of the 2016 SIAM International Conference on Data Mining,", "year": 2016}, {"authors": ["Gabriel Goh", "Andrew Cotter", "Maya Gupta", "Michael P Friedlander"], "title": "Satisfying real-world goals with dataset constraints", "venue": "In Advances in Neural Information Processing Systems,", "year": 2016}, {"authors": ["Bryce Goodman", "Seth Flaxman"], "title": "European union regulations on algorithmic decision-making and a right to explanation", "venue": "AI Magazine,", "year": 2017}, {"authors": ["Moritz Hardt", "Eric Price", "Nati Srebro"], "title": "Equality of opportunity in supervised learning", "venue": "In Advances in neural information processing systems,", "year": 2016}, {"authors": ["Rebecca Heilweil"], "title": "Artificial intelligence will help determine if you get your next job, Dec 2019", "year": 2019}, {"authors": ["Stefan Jaeger", "Sema Candemir", "Sameer Antani", "Y\u0131\u0300-Xi\u00e1ng J W\u00e1ng", "Pu-Xuan Lu", "George Thoma"], "title": "Two public chest 9 x-ray datasets for computer-aided screening of pulmonary diseases", "venue": "Quantitative imaging in medicine and surgery,", "year": 2014}, {"authors": ["Faisal Kamiran", "Toon Calders"], "title": "Classification with no discrimination by preferential sampling", "venue": "In Proc. 19th Machine Learning Conf. Belgium and The Netherlands,", "year": 2010}, {"authors": ["Michael Kearns", "Seth Neel", "Aaron Roth", "Zhiwei Steven Wu"], "title": "Preventing fairness gerrymandering: Auditing and learning for subgroup fairness", "venue": "arXiv preprint arXiv:1711.05144,", "year": 2017}, {"authors": ["Ziwei Liu", "Ping Luo", "Xiaogang Wang", "Xiaoou Tang"], "title": "Large-scale celebfaces attributes (celeba) dataset", "venue": "Retrieved August,", "year": 2018}, {"authors": ["Novi Quadrianto", "Viktoriia Sharmanska", "Oliver Thomas"], "title": "Discovering fair representations in the data domain", "venue": "In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition,", "year": 2019}, {"authors": ["Hee Jung Ryu", "Hartwig Adam", "Margaret Mitchell"], "title": "Inclusivefacenet: Improving face attribute detection with race and gender diversity", "venue": "arXiv preprint arXiv:1712.00193,", "year": 2017}, {"authors": ["Shai Shalev-Shwartz"], "title": "Online learning and online convex optimization", "venue": "Foundations and Trends R \u00a9 in Machine Learning,", "year": 2012}, {"authors": ["Berk Ustun", "Cynthia Rudin"], "title": "Learning optimized risk scores from large-scale", "venue": "datasets. stat,", "year": 2016}, {"authors": ["Blake Woodworth", "Suriya Gunasekar", "Mesrob I Ohannessian", "Nathan Srebro"], "title": "Learning non-discriminatory predictors", "venue": "arXiv preprint arXiv:1702.06081,", "year": 2017}, {"authors": ["Sirui Yao", "Bert Huang"], "title": "Beyond parity: Fairness objectives for collaborative filtering", "venue": "In Advances in Neural Information Processing Systems,", "year": 2017}, {"authors": ["Mark Yatskar", "Luke Zettlemoyer", "Ali Farhadi"], "title": "Situation recognition: Visual semantic role labeling for image understanding", "venue": "In Conference on Computer Vision and Pattern Recognition,", "year": 2016}, {"authors": ["Muhammad Bilal Zafar", "Isabel Valera", "Manuel Gomez Rodriguez", "Krishna P Gummadi"], "title": "Fairness beyond disparate treatment & disparate impact: Learning classification without disparate mistreatment", "venue": "In Proceedings of the 26th International Conference on World Wide Web,", "year": 2017}, {"authors": ["Muhammad Bilal Zafar", "Isabel Valera", "Manuel Rodriguez", "Krishna Gummadi", "Adrian Weller"], "title": "From parity to preference-based notions of fairness in classification", "venue": "In Advances in Neural Information Processing Systems,", "year": 2017}, {"authors": ["Brian Hu Zhang", "Blake Lemoine", "Margaret Mitchell"], "title": "Mitigating unwanted biases with adversarial learning", "venue": "In Proceedings of the 2018 AAAI/ACM Conference on AI, Ethics, and Society,", "year": 2018}, {"authors": ["Chiyuan Zhang", "Samy Bengio", "Moritz Hardt", "Benjamin Recht", "Oriol Vinyals"], "title": "Understanding deep learning requires rethinking generalization", "venue": "arXiv preprint arXiv:1611.03530,", "year": 2016}, {"authors": ["Jieyu Zhao", "Tianlu Wang", "Mark Yatskar", "Ryan Cotterell", "Vicente Ordonez", "Kai-Wei Chang"], "title": "Gender bias in contextualized word embeddings", "year": 1904}, {"authors": ["Jieyu Zhao", "Tianlu Wang", "Mark Yatskar", "Vicente Ordonez", "Kai-Wei Chang"], "title": "Men also like shopping: Reducing gender bias amplification using corpus-level constraints", "venue": "arXiv preprint arXiv:1707.09457,", "year": 2017}, {"authors": ["Bolei Zhou", "Aditya Khosla", "\u00c0gata Lapedriza", "Aude Oliva", "Antonio Torralba"], "title": "Learning deep features for discriminative localization", "venue": "CoRR, abs/1512.04150,", "year": 2015}, {"authors": ["Hao Henry Zhou", "Vikas Singh", "Sterling C Johnson", "Grace Wahba"], "title": "Statistical tests and identifiability conditions for pooling and analyzing multisite datasets", "venue": "Proceedings of the National Academy of Sciences,", "year": 2018}, {"authors": ["Ortrun Zuber-Skerritt", "Eva Cendon"], "title": "Critical reflection on professional development in the social sciences: interview results", "venue": "International Journal for Researcher Development,", "year": 2014}], "sections": [{"heading": "1. Introduction", "text": "Fairness and non-discrimination is a core tenet of modern society. Driven by advances in vision and machine learning systems, algorithmic decision making continues to permeate our lives in important ways. Consequently, ensuring that the decisions taken by an algorithm do not exhibit serious biases is no longer a hypothetical topic, rather a key concern that has started informing legislation [22] (e.g., Algorithmic Accountability act). On one extreme, some types of biases can be bothersome \u2013 a biometric access system\ncould be more error-prone for faces of persons from certain skin tones [9] or a search for homemaker or programmer may return gender-stereotyped images [8]. But there are serious ramifications as well \u2013 an individual may get pulled aside for an intrusive check while traveling [47] or a model may decide to pass on an individual for a job interview after digesting his/her social media content[13, 24]. Biases in automated systems in estimating recidivism within the criminal judiciary have been reported [35]. There is a growing realization that these problems need to be identified and diagnosed, and then promptly addressed. In the worst case, if no solutions are forthcoming, we must step back and reconsider the trade-off between the benefits versus the harm of deploying such systems, on a case by case basis.\nWhat leads to unfair learning models? One finds that learning methods in general tend to amplify biases that exist in the training dataset [43]. While this creates an incentive for the organization training the model to curate datasets that are \u201cbalanced\u201d in some sense, from a practical standpoint, it is often difficult to collect data that is balanced along multiple predictor variables that are \u201cprotected\u201d, e.g.,\nar X\niv :2\n00 4.\n01 35\n5v 2\n[ cs\n.C V\n] 2\n4 Ju\nn 20\ngender, race and age. If a protected feature is correlated with the response variable, a learning model can cheat and find representations from other features that are collinear or a good surrogate for the protected variable. A thrust in current research is devoted to devising ways to mitigate such shortcuts. If one does not have access to the underlying algorithm, a recent result [23] shows the feasibility of finding thresholds that can impose certain fairness criteria. Such a threshold search can be post-hoc applied to any learned model. But in various cases, because of the characteristics of the dataset, a fairness-oblivious training will lead to biased models. An interesting topic is the study of mechanisms via which the de novo design or training of the model can be informed by fairness measures.\nSome general strategies for Fair Learning. Motivated by the foregoing issues, recent work which may broadly fall under the topic of algorithmic fairness has suggested several concepts or measures of fairness that can be incorporated within the learning model. While we will discuss the details shortly, these include demographic parity [37], equal odds and equal opportunities [23], and disparate treatment [39]. In general, existing work can be categorized into a few distinct categories. The first category of methods attempts to modify the representations of the data to ensure fairness. While different methods approach this question in different ways, the general workflow involves imposing fairness before a subsequent use of standard machine learning methods [10, 26]. The second group of methods adjusts the decision boundary of an already trained classifier towards making it fair as a post-processing step while trying to incur as little deterioration in overall performance as possible [21, 20, 36]. While this procedure is convenient and fast, it is not always guaranteed to lead to a fair model without sacrificing accuracy. Part of the reason is that the search space for a fair solution in the post-hoc tuning is limited. Of course, we may impose fairness during training directly as adopted in the third category of papers such as [40, 4], and the approach we take here. Indeed, if we are training the model from scratch and have knowledge of the protected variables, there is little reason not to incorporate this information directly during model training. In principle, this strategy provides the maximum control over the model. From the formulation standpoint, it is slightly more involved because it requires satisfying a fairness constraint derived from one or more fairness measure(s) in the literature, while concurrently learning the model parameters. The difficulty varies depending both on the primary task (shallow versus deep model) as well as the specific fairness criteria. For instance, if one were using a deep network for classification, we would need to devise ways to enforce constraints on the output of the network, efficiently.\nScope of this paper and contributions. Many studies on fairness in learning and vision are somewhat recent\nand were partly motivated in response to more than a few controversial reports in the news media. As a result, the literature on mathematically sound and practically sensible fairness measures that can still be incorporated while training a model is still in a nascent stage. In vision, current approaches have largely relied on training adversarial modules in conjunction with the primary classification or regression task, to remove the influence of the protected attribute. In contrast, the contribution of our work is to provide a simpler alternative. We show that a number of fairness measures in the literature can be incorporated by viewing them as constraints on the output of the learning model. This view allows adapting ideas from constrained optimization, to devise ways in which training can be efficiently performed in a way that at termination, the model parameters correspond to a fair model. For a practitioner, this means that no changes in the architecture or model are needed: imposing fairness only requires specifying the protected attribute, and utilizing our proposed optimization routine."}, {"heading": "2. A Primer on Fairness Functions", "text": "In this section, we introduce basic notations and briefly review several fairness measures described in the literature. Basic notations. We denote classifiers using h : x 7\u2192 y where x and y are random variables that represent the features and labels respectively. A protected attribute is a random variable s on the same probability space as x and y \u2013 for example, s may be gender, age, or race. Collectively, a training example would be z := (x, y, s). So, our goal is to learn h (predict y given x) while imposing fairness-type constraints over s. We will use H = {h1, h2, . . . , hN} to denote a set/family of possible classifiers and \u2206N to denote the probability simplex in RN , i.e., \u2206 := {q : \u2211N i=1 qi = 1, qi \u2265 0} where qi is the i-th coordinate of q. Throughout the paper, we will assume that the distribution of s has finite support. Unless explicitly specified, we will assume that y \u2208 {0, 1} in the main paper. For each h \u2208 H, we will use eh to denote the misclassification rate of h and eH \u2208 RN to be the vector containing all misclassification rates. We will use superscript to denote conditional expectations. That is, if \u00b5h corresponds to expectation of some function \u00b5 (that depends on h \u2208 H), then the conditional expectation/moment of \u00b5h with respect to s will be denoted by \u00b5sh. With a slight abuse of notation, we will use \u00b5s0h to denote the elementary conditional expectation \u00b5h|(s = s0) whenever it is clear from the context. We will use dh to denote the difference between the conditional expectation of the two groups of s, that is, dh := \u00b5 s0 h \u2212\u00b5 s1 h . For example, let s be the random variable representing gender, that is, s0 and s1 may correspond to male and female. Then, esih corresponds to the misclassification rate of h on group si, and dh = es0h \u2212 e s1 h . Finally, \u00b5 si,tj h := \u00b5h|(s = si, t = tj) denotes the elementary con-\nditional expectation with respect to two random variables s, t."}, {"heading": "2.1. Fairness through the lens of Confusion Matrix", "text": "Recall that a fairness constraint corresponds to a performance requirement of a classifier h on subgroups of features x induced by a protected attribute s. For instance, say that h predicts the credit-worthiness y of an individual x. Then, we may require that eh be \u201capproximately\u201d the same across individuals for different races given by s. Does it follow that functions/metrics that are used to evaluate fairness may be written in terms of the error of a classifier eh conditioned on the protected variable s (or in other words esh)? Indeed, it does turn out to be the case! In fact, many widely used functions in practice can be viewed as imposing constraints on the confusion matrix as our intuition suggests. We will now discuss few common fairness metrics to illustrate this idea.\n(a) Demographic Parity (DP) [37]. A classifier h is said to satisfy Demographic Parity (DP) if h(x) is independent of the protected attribute s. Equivalently, h satisfies DP if dh = 0 where we set \u00b5sih = e si h (using notations introduced above). DP can be seen as equating the total false positives and false negatives between the confusion matrices of the two groups. We denote DDP by the difference of the demographic parity between the two groups.\n(b) Equality of Opportunity (EO) [23]. A classifier h is said to satisfy EO if h(x) is independent of the protected attribute s for y \u2208 {0, 1}. Equivalently, h satisfies EO if dyh = 0 where we set \u00b5 si h = e si h |(y \u2208 {0, 1}) =: e si,yj h conditioning on both s and y. Depending on the choice of y in \u00b5sih , we get two different metrics: (i) y = 0 corresponds to h with equal False Positive Rate (FPR) across si [14], whereas (ii) y = 1 corresponds to h with equal False Negative Rate (FNR) across si [14]. Moreover, h satisfies Equality of Odds if d0h + d 1 h = 0, i.e., h equalizes both TPR and FPR across s [23]. We denote the difference in EO by DEO.\n(c) Predictive Parity (PP) [11]. A classifier h satisfies PP if the likelihood of making a misclassification among the positive predictions of the classifier is independent of the protected variable s. Equivalently, h satisfies PP if dy\u0302h = 0 where we set \u00b5sihi = e si h |(y\u0302 = 1). It corresponds to matching the False Discovery Rate between the confusion matrices of the two groups."}, {"heading": "3. How to learn fair models?", "text": "At a high level, the optimization problem that we seek to solve is written as,\nmin h\u2208H Ez:(x,y,s)\u223cDL(h; (x, y)) subject to h \u2208 Fdh , (1)\nwhere L denotes the loss function that measures the accuracy of h in predicting y from x, and Fdh denotes the set\nof fair classifiers. Our approach to solve (1) provably efficiently involves two main steps: (i) first, we reformulate problem (1) to compute a posterior distribution q over H; (ii) second, we incorporate fairness as soft constraints on the output of q using the augmented Lagrangian of Problem (1). We assume that we have access to sufficient number of samples to approximate D and solve the empirical version of Problem (1)."}, {"heading": "3.1. From Fair Classifiers to Fair Posteriors", "text": "The starting point of our development is based on the following simple result that follows directly from the definitions of fairness metrics in Section 2:\nObservation 1. Fairness metrics such as DP/EO are linear functions of h, whereas PP takes a linear fractional form due to the conditioning on y\u0302, see [11].\nObservation 1 immediately implies that Fdh can be represented using linear (fractional) equations in h. To simplify the discussion, we will focus on the case when Fdh is given by the DP metric. Hence, we can reformulate (1) as,\nmin q\u2208\u2206 \u2211 i qiehi s.t. qi(\u00b5 s0 hi \u2212 \u00b5s1hi) = 0 \u2200i \u2208 [N ], (2)\nwhere q represents a distribution overH."}, {"heading": "3.2. Imposing Fairness via Soft Constraints", "text": "In general, there are two ways of treating the N constraints qidhi = 0 in Problem (2) viz., (i) as hard constraints; or (ii) as soft constraints. Algorithms that can handle explicit constraints efficiently require access to an efficient oracle that can minimize a linear or quadratic function over the feasible set in each iteration. Consequently, algorithms that incorporate hard constraints come with high periteration computational cost since the number of constraints is (at least) linear in N , and is not applicable in large scale settings. Hence, we propose to use algorithms that incorporate fairness as soft constraints. With these two minor modifications, we will now describe our approach to solve problem (2)."}, {"heading": "4. Fair Posterior from Proximal Dual", "text": "Following the reductions approach in [1], we first write the Lagrangian dual problem of DP constrained risk minimization problem (2) using dual variables \u03bb as,\nmax \u03bb\u2208RN min q\u2208\u2206\nL(q, \u03bb) := \u3008q, eh\u3009+ \u03bb\u3008q, \u00b5s0h \u2212 \u00b5 s1 h \u3009 (3)\nInterpreting the Lagrangian. Problem 3 can be understood as a game between two players a q-player and a \u03bbplayer [16]. We recall an important fact regarding the dual problem (3):\nAlgorithm 1 FairALM: Linear Classifier 1: Notations: Dual step size \u03b7\nht \u2208 {h1, h2, . . . , hN}. 2: Input: Error Vector eH, Conditional mean vector \u00b5sH 3: Initializations: \u03bb0 = 0 4: for t = 0, 1, 2, ..., T do 5: (Primal) ht \u2190 argmini(ehi + \u03bbt(\u00b5 s0 hi \u2212 \u00b5s1hi)) 6: (Dual) \u03bbt+1 \u2190 \u03bbt + \u03b7(\u00b5s0ht \u2212 \u00b5 s1 ht\n)/t 7: end for 8: Output: hT\nFact 2. The objective function of the dual problem (3) is always nonsmooth with respect to \u03bb because of the inner minimization problem in q.\nTechnically, there are two main reasons why optimizing nonsmooth functions can be challenging [18]: (i) finding a descent direction in high dimensions N can be challenging; and (ii) subgradient methods can be slow to converge in practice. Due to these difficulties arising from Fact 2, using a first order algorithm such as gradient descent to solve the dual problem in (3) directly can be problematic, and may be suboptimal.\nAccelerated optimization using Dual Proximal Functions. To overcome the difficulties due to the nonsmoothness of the dual problem, we propose to augment the Lagrangian with a proximal term. Specifically, for some \u03bbT , the augmented Lagrangian function can be written as,\nLT (q, \u03bb) = \u3008q, eh\u3009+ \u03bb\u3008q, \u00b5s0h \u2212 \u00b5 s1 h \u3009 \u2212 1 2\u03b7 (\u03bb\u2212 \u03bbT ) 2 (4)\nNote that, as per our simplified notation, LT \u2261 L\u03bbT . The following lemma relates the standard Lagrangian in (3) with its proximal counterpart in (4).\nLemma 3. At the optimal solution (q\u2217, \u03bb\u2217) to L, we have max\u03bb minq\u2208\u2206 L = max\u03bb minq\u2208\u2206 L\u03bb\u2217 .\nThis is a standard property of proximal objective functions, where \u03bb\u2217 forms a fixed point of minq\u2208\u2206 L\u03bb\u2217(q, \u03bb\u2217) (section 2.3 of [30]). Intuitively, Lemma 3 states that L and LT are not at all different for optimization purposes.\nRemark 4. While the augmented Lagrangian LT still may be nonsmooth, the proximal (quadratic) term can be exploited to design provably faster optimization algorithms as we will see shortly."}, {"heading": "5. Our Algorithm \u2013 FairALM", "text": "It is common [1, 16, 27] to consider the minimax problem in (4) as a zero sum game between the \u03bb-player and the q-player. The Lagrangian(s) LT (or L) specify the\ncost which the q-player pays to the \u03bb-player after the latter makes its choice. An iterative procedure leads to a regret minimizing strategy for the \u03bb-player [34] and a best response strategy for the q-player [1]. While the q-player\u2019s move relies on the availability of an efficient oracle to solve the minimization problem, LT (q, \u03bb), being a linear program in q makes it less challenging. We describe our algorithm in Alg. 1 and call it FairALM: Linear Classifier."}, {"heading": "5.1. Convergence Analysis", "text": "As the game with respect to \u03bb is a maximization problem, we get a reverse regret bound as shown in the following Lemma. Due to space, proofs appear in the Appendix.\nLemma 5. Let rt denote the reward at each round of the game. The reward function ft(\u03bb) is defined as ft(\u03bb) = \u03bbrt\u2212 12\u03b7 (\u03bb\u2212\u03bbt) 2. We choose \u03bb in round T +1 to maximize\nthe cumulative reward: \u03bbT+1 = argmax\u03bb \u2211T t=1 ft(\u03bb). Define L = maxt |rt|. The following bound on the cumulative reward holds, for any \u03bb\n\u2211T t=1 ( \u03bbrt \u2212 12\u03b7 (\u03bb\u2212 \u03bbt) 2 ) \u2264 \u2211T t=1 \u03bbtrt + \u03b7 2L 2O(log T ) (5)\nThe above lemma indicates that the cumulative reward grows in time as O(log T ). The proximal term in the augmented Lagrangian gives us a better bound than an `2 or an entropic regularizer (which provides a \u221a T bound [34]).\nNext, we evaluate the cost function LT (q, \u03bb) after T rounds of the game. We observe that the average play of both the players converges to a saddle point with respect to LT (q, \u03bb). We formalize this in the following theorem,\nTheorem 6. Recall that dh represents the difference of conditional means. Assume that ||dh||\u221e \u2264 L and consider T rounds of the game described above. Let the average plays of the q-player be q\u0304 = 1T \u2211T t=1 qt and the \u03bb-player be\n\u03bb\u0304 = 1T \u2211T t=1 \u03bbt. Then under the following conditions on q, \u03bb and \u03b7, we have LT (q\u0304, \u03bb\u0304) \u2264 LT (q, \u03bb\u0304)+\u03bd and LT (q\u0304, \u03bb\u0304) \u2265 LT (q\u0304, \u03bb)\u2212 \u03bd \u2022 If \u03b7 = O( \u221a B2T L2(log T+1) ), \u03bd = O( \u221a B2L2(log T+1) T );\n\u2200|\u03bb| \u2264 B, \u2200q \u2208 \u2206 \u2022 If \u03b7 = 1T , \u03bd = O( L2(log T+1)2 T ); \u2200\u03bb \u2208 R, \u2200q \u2208 \u2206\nThe above theorem indicates that the average play of the q-player and the \u03bb-player reaches a \u03bd-approximate saddle point. Our bounds for \u03bd = 1T and \u03bb \u2208 R are strictly better than [1].\n5.2. Can we train Fair Deep Neural Networks by adapting Alg. 1?\nThe key difficulty from the analysis standpoint we face in extending these results to the deep networks setting is\nAlgorithm 2 FairALM: DeepNet Classifier 1: Notations: Dual step size \u03b7, Primal step size \u03c4 2: Input: Training Set D 3: Initializations: \u03bb0 = 0, w0 4: for t = 0, 1, 2, ..., T do 5: Sample z \u223c D 6: Pick vt \u2208 \u2202 ( e\u0302hw (z)+(\u03bbt+\u03b7)\u00b5\u0302 s0 hw (z)\u2212(\u03bbt\u2212\u03b7)\u00b5\u0302s1hw (z) )\n7: (Primal) wt \u2190 wt\u22121 \u2212 \u03c4vt 8: (Dual) \u03bbt+1 \u2190 \u03bbt + \u03b7(\u00b5\u0302s0hwt (z)\u2212 \u00b5\u0302 s1 hwt (z))\n9: end for 10: Output: wT\nthat the number of classifiers |H| may be exponential in number of nodes/layers. This creates a potential problem in computing Step 5 of Algorithm 1 \u2013 if viewed mechanistically, is not practical since an epsilon net over the family H (representable by a neural network) is exponential in size. Interestingly, notice that we often use overparameterized networks for learning. This is a useful fact here because it means that there exists a solution where argmini(ehi + \u03bbtdhi) is 0. While iterating through all his will be intractable, we may still able to obtain a solution via standard stochastic gradient descent (SGD) procedures [42]. The only unresolved question then is if we can do posterior inference and obtain classifiers that are \u201cfair\u201d. It turns out that the above procedure provides us an approximation if we leverage two facts: first, SGD can find the minimum ofL(h, \u03bb) with respect to h and second, recent results show that SGD, in fact, performs variational inference, implying that the optimization provides an approximate posterior [12]. Having discussed the issue of the exponential sized |H| \u2013 for which we settle for an approximate posterior \u2013 we make three additional adjustments to the algorithm to make it suitable for training deep networks. First, the non-differentiable indicator function 1[\u00b7] is replaced with a smooth surrogate function (such as a logistic function). Second, as it is hard to evaluate eh/\u00b5sh due to unavailability of the true data distribution, we instead calculate their empirical estimates z = (x; y; s), and denote it by e\u0302h(z)/\u00b5\u0302sh(z). Third, by exchanging the \u201cmax\u201d and \u201cmin\u201d in (3), we obtain an objective that upper-bounds our current objective in (3). This provides us with a closed-form solution to \u03bb thus reducing the minmax objective to a single simpler minimization problem. We present the algorithm for deep neural network training in Alg. 2 and call it FairALM: DeepNet Classifier."}, {"heading": "6. Experiments", "text": "A central theme in our experiments is to assess whether our proposed algorithm, FairALM, can indeed obtain meaningful fairness measure scores without compromising\nthe test set performance. We evaluate FairALM on a number of problems where the dataset reflects certain inherent societal/stereotypical biases. Our evaluations are also designed with a few additional goals in mind.\nOverview. Our first experiment on the CelebA dataset seeks to predict the value of a label for a face image while controlling for certain protected attributes (gender, age). We discuss how prediction of some labels is unfair in an unconstrained model and contrast with our FairALM. Next, we focus on the label where predictions are the most unfair and present comparisons against methods available in the literature. For our second experiment, we use the ImSitu dataset where images correspond to a situation (activities, verb). Expectedly, some activities such as driving or cooking are more strongly associated with a specific gender. We inspect if an unconstrained model is unfair when we ask it to learn to predict two gender correlated activities/verbs. Comparisons with baseline methods will help measure FairALM\u2019s strengths/weaknesses. We can use heat map visualizations to qualitatively interpret the value of adding fairness constraints. We threshold the heat-maps to get an understanding of a general behavior of the models. Our third experiment addresses an important problem in medical/scientific studies. Small sample sizes necessitate pooling data from multiple sites or scanners [46], but introduce a site or scanner specific nuisance variable which must be controlled for \u2013 else a deep (also, shallow) model may cheat and use site specific (rather than disease-specific) artifacts in the images for prediction even when the cohorts are age or gender matched [19]. We study one simple setting here: we use FairALM to mitigate site (hospital) specific differences in predicting \u201ctuberculosis\u201d from X-ray images acquired at two hospitals, Shenzhen and Montgomery (and recently made publicly available [25]).\nIn all the experiments, we impose Equality of Opportunity (EO) constraint (defined in Section 2.1). We adopt NVP (novel validation procedure) used in [17] to evaluate FairALM. It is a two-step procedure: first, we search for the hyper-parameters that achieve the best accuracy, and then, we report the minimum fairness measure (DEO) for accuracies within 90% of the highest accuracy. This offers some robustness of the reported numbers to hyper-parameter selection. We describe these experiments one by one.\nRemark from authors. Certain attributes such as attractiveness, obtained via crowd-sourcing, may have socio-cultural ramifications. Similarly, the gender attribute in the dataset is binary (male versus female) which may be insensitive to some readers. We clarify that our goal is to present evidence showing that our algorithm can impose fairness in a sensible way on datasets used in the literature rather than the higher level question of whether\nour community needs to invest in culturally sensitive datasets with more societally relevant themes."}, {"heading": "6.1. CelebA dataset", "text": "Data and Setup. CelebA [28] consists of 200K celebrity face images from the internet annotated by a group of paid adult participants [7]. There are up to 40 labels available in the dataset, each of which is binary-valued.\nQuantitative results. We begin our analysis by predicting each of the 40 labels with a 3-layer ReLU network. The protected variable, s, are the binary attributes like Male and Young representing gender and age respectively. We train the SGD algorithm for 5-epochs and select the labels predicted with at least at 70% precision and with a DEO of at least 4% across the protected variables. The biased set of labels thus estimated are shown in Table 1. These labels are consistent with other reported results [32]. It is important to bear in mind that the bias in the labels should not be attributed to its relatedness to a specific protected attributed alone. The cause of bias could also be due to the skew in the label distributions. When training a 3-layer ReLU net with FairALM, the precision of the model remained almost the same (\u00b15% ) while the DEO measure reduced significantly as indicated in the Table 1. Next, choosing the most unfair label in Table 1 (i.e., attractive), we train a ResNet18 for a longer duration of about 100 epochs and contrast the\nperformance with a simple `2-penalty baseline. The training profile is observed to be more stable for FairALM as indicated in Fig. 2. This finding is consistent with the seminal works such as [5, 29] that discuss the ill-conditioned landscape of non-convex penalties. Comparisons to more recent works such as [33, 31] is provided in Table 2. Here, we present a new state-of-the-art result for the DEO measure with the label attractive and protected attribute gender.\nQualitatively assessing Interpretability. While the DEO measure obtained by FairALM is lower, we can ask an interesting question: when we impose the fairness constraint, precisely which aspects of the image are no longer \u201clegal\u201d for the neural network to utilize? This issue can be approached via visualizing activation maps from models such as CAM [45]. As a representative example, our analysis suggests that in general, an unconstrained model uses the entire face image (including the gender-revealing parts). We find some consistency between the activation maps for attractiveness and activation maps of an unconstrained model trained to predict gender! In contrast, when we impose the fairness constraint, the corresponding activation maps turn out to be clustered around specific regions of the face which are not gender revealing. In particular, a surprising finding was that the left regions in the face were far more prominent which turns out to be consistent with studies in psychology [6].\nSummary. FairALM minimized the DEO measure without compromising the test error. It has a more stable training profile than an `2 penalty and is competitive with recent fairness methods in vision. The activation maps in FairALM concentrate on non-gender revealing features of the face when controlled for gender."}, {"heading": "6.2. Imsitu Dataset", "text": "Data and Setup. ImSitu [38] is a situation recognition dataset consisting of \u223c 100K color images taken from the web. The annotations for the image is provided as a summary of the activity in the image and includes a verb describing it, the interacting agents and their roles. The protected variable in this experiment is gender. Our objective is to classify a pair of verbs associated with an image. The pair is chosen such that if one of the verbs is biased towards males then the other would be biased towards females. The authors in [44] report the list of labels in the ImSitu dataset that are gender biased: we choose our verb pairs from this list. In particular, we consider the verbs Cooking vs Driving, Shaving vs Moisturizing, Washing vs Saluting and Assembling vs Hanging. We compare our results against multiple baselines such as (1) Unconstrained (2) `2-penalty,\nthe penalty applied on the DEO measure (3) Re-weighting, a weighted loss functions where the weights account for the dataset skew (4) Adversarial [41] (5) Lagrangian [44] (6) Proxy-Lagrangian [15]. The supplement includes more details of the baseline methods.\nQuantitative results. From Fig. 5, it can be seen that FairALM reaches a zero DEO measure very early in training and attains better test errors than an unconstrained model. Within the family of Lagrangian methods such as [44, 15], FairALM performs better on verb pair \u2018Shaving vs Moisturizing\u2019 in both test error and DEO measure as indicated in Table 3 . While the results on the other verb pairs are comparable, FairALM was observed to be more stable to different hyper-parameter choices. This finding is in accord with recent studies by [2] who prove that proximal function models are robust to step-size selection. Detailed analysis is provided in the supplement. Turning now to an adversarial method such as [44], results in Table 3 show that the DEO measure is not controlled as competently as FairALM. Moreover, complicated training routines and unreliable convergence [3] makes model-training harder.\nInterpretable Models. We used CAM [45] to inspect the image regions used by the model for target prediction.\nWe observe that the unconstrained model ends up picking features from locations that may not be relevant for the task description but merely co-occur with the verbs in this particular dataset (and are gender-biased). Fig. 4 highlights this observation for the selected classification tasks. Overall, we observe that the semantic regions used by the constrained model are more aligned with the action verb present in the image, and this adds to the qualitative advantages of the model trained using FairALM in terms of interpretability.\nLimitations. We also note that there are cases where both the unconstrained model and FairALM look at incorrect image regions for prediction, owing to the small dataset sizes. However, the number of such cases are far fewer for FairALM than the unconstrained setup.\nSummary. FairALM successfully minimizes the fairness measure while classifying verb/action pairs associated with an image. FairALM uses regions in an image that are more relevant to the target class and less gender revealing."}, {"heading": "6.3. Chest X-Ray datasets", "text": "Data and Setup. The datasets we examine here are publicly available from the U.S. National Library of Medicine [25]. The images come from two sites/sources. Images for the first site are collected from patients in Montgomery county, USA and includes 138 x-rays. The second set of images includes 662 images collected at a hospital in Shenzhen, China. Our task is to predict pulmonary tuberculosis (TB) from the x-ray images. The images are collected from different x-ray machines with different characteristics, and\nhave site-specific markings or artifacts, see Fig 6. 25% of the samples from the pooked dataset are set aside for testing.\nQuantitative Results. We treat the site information, Montgomery or Shenzhen, as a nuisance/protected variable and seek to decorrelate it from the TB labels. We train a ResNet18 network and compare an unconstrained model with FairALM model. Our datasets of choice are small in size, and so deep models easily overfit to site-specific biases present in the training data. Our results corroborate this conjecture, the training accuracies reach 100% very early and the test set accuracies for the unconstrained model has a large variance over multiple experimental runs. Conversely, as depicted in Fig. 7, a FairALM model not only maintains a lower variance in the test set errors and DEO measure but also attains improved performance on these measures. What stands out in this experiment is that the number of\nepochs to reach a certain test set error is lower for FairALM indicating that the model generalizes faster compared to an unconstrained model.\nSummary. FairALM is effective at learning from datasets from two different sites/sources, minimizes sitespecific biases and accelerates generalization."}, {"heading": "7. Conclusion", "text": "We introduced FairALM, an augmented Lagrangian framework to impose constraints on fairness measures studied in the literature. On the theoretical side, we provide\nstrictly better bounds \u2013 O (\nlog2 T T\n) versus O ( 1\u221a T ) , for\nreaching a saddle point. On the application side, we provide extensive evidence (qualitative and quantitative) on image datasets commonly used in vision to show the potential benefits of our proposal. Finally, we use FairALM to mitigate site specific differences when performing analysis of pooled medical image datasets. In applying deep learning to scientific/biomedical problems, this is an important issue since sample sizes at individual sites/institutions are often smaller. The overall procedure is simple which we believe will lead to broader adoption and follow-up work on this socially relevant topic."}, {"heading": "8. Appendix", "text": "8.1. Experiments on FairALM: Linear Classifier\nData. We consider four standard datasets, Adult, COMPAS, German and Law Schools [17, 1]. The Adult dataset is comprised of demographic characteristics where the task is to predict if a person has an income higher (or lower) than $50K per year. The protected attribute here is gender. In COMPAS dataset, the task is to predict the recidivism of individuals based on features such as age, gender, race, prior offenses and charge degree. The protected attribute here is race, specifically, whether the individual is white or black. The German dataset classifies people as good or bad credit risks with the person being a foreigner or not as the protected attribute. The features available in this dataset are credit history, saving accounts, bonds, etc. Finally, the Law Schools dataset, which comprises of \u223c 20K examples, seeks to predict a person\u2019s passage of the bar exam. Here, a binary attribute race is considered as the protected attribute.\nSetup. We use Alg. 1 in the paper for experiments in this section. Recall from \u00a7 3 of the paper that Alg. 1 requires the specification of H. We use the space of logistic regression classifiers as H. At the start of the algorithm we have an empty set of classifiers. In each iteration, we add a newly trained classifier h \u2208 H to the set of classifiers only if h has a smaller Lagrangian objective value among all the classifiers already in the set.\nQuantitative Results. For the Adult dataset, FairALM attains a smaller test error and smaller DEO compared to the baselines considered in Table 4. We see big improvements on the DEO measure in COMPAS dataset and test error in German dataset using FairALM. While the performance of FairALM on Law Schools is comparable to other methods, it obtains a better false-positive rate than [1] which is a better metric as this dataset is skewed towards it\u2019s target class.\nSummary. We train Alg. 1 on standard datasets specified in [17, 1]. We observe that FairALM is competitive with the popular methods in the fairness literature."}, {"heading": "8.2. Proofs for theoretical claims in the paper", "text": "Prior to proving the convergence of primal and dual variables of our algorithm with respect to the augmented lagrangian LT (q, \u03bb), we prove a regret bound on the function ft(\u03bb) which is defined in the following lemma. As ft(\u03bb) is a strongly concave function (which we shall see shortly), we obtain a bound on the negative regret.\nLemma 7. Let rt denote the reward at each round of the game. The reward function ft(\u03bb) is defined as ft(\u03bb) = \u03bbrt \u2212 1 2\u03b7 (\u03bb\u2212\u03bbt) 2. We choose \u03bb in the round T + 1 to maximize the cumulative reward, i.e., \u03bbT+1 = argmax\u03bb \u2211T t=1 ft(\u03bb). Define L = maxt | rt |. We obtain the following bound on the cumulative reward, for any \u03bb,\nT\u2211 t=1 ( \u03bbrt \u2212 1 2\u03b7 (\u03bb\u2212 \u03bbt)2 ) \u2264 T\u2211 t=1 \u03bbtrt + \u03b7L 2O(log T ) (6)\nProof. As we are maximizing the cumulative reward function, in the (t + 1)th iteration \u03bbt+1 is updated as \u03bbt+1 = argmax\u03bb \u2211t i=1 fi(\u03bb). This learning rule is also called the Follow-The-Leader (FTL) principle which is discussed in Section 2.2 of [34]. Emulating the proof of Lemma 2.1 in [34], a bound on the negative regret of FTL, for any \u03bb \u2208 R, can be derived\ndue to the concavity of ft(\u03bb),\nT\u2211 t=1 ft(\u03bb)\u2212 T\u2211 t=1 ft(\u03bbt) \u2264 T\u2211 t=1 ft(\u03bbt+1)\u2212 T\u2211 t=1 ft(\u03bbt) (7)\nOur objective, now, is to obtain a bound on RHS of (7). Solving argmax\u03bb \u2211t i=1 fi(\u03bb) for \u03bb will show us how \u03bbt and \u03bbt+1 are related,\n\u03bbt+1 = \u03b7\nt t\u2211 i=1 ri + 1 t t\u2211 i=1 \u03bbi =\u21d2 \u03bbt+1 \u2212 \u03bbt = \u03b7 t rt (8)\nUsing (8), we obtain a bound on ft(\u03bbt+1)\u2212 ft(\u03bbt), we have,\nft(\u03bbt+1)\u2212 ft(\u03bbt) \u2264 \u03b7\nt r2t\nWith L = maxt |rt| and using the fact that \u2211T i=1 1 i \u2264 (log T + 1),\nT\u2211 t=1 ( ft(\u03bbt+1)\u2212 ft(\u03bbt) ) \u2264 \u03b7L2(log T + 1) (9)\nLet us denote \u03beT = \u03b7L2(log T + 1), we bound (7) with (9),\n\u2200\u03bb \u2208 R T\u2211 t=1 ( \u03bbrt \u2212 1 2\u03b7 (\u03bb\u2212 \u03bbt)2 ) \u2264 ( T\u2211 t=1 \u03bbtrt ) + \u03beT\nCumulative Reward Bound\n(10)\nNext, using the Cumulative Reward Bound (10), we prove the theorem stated in the paper. The theorem gives us the number of iterations required by Alg. 1 (in the paper) to reach a \u03bd\u2212approximate saddle point. Our bounds for \u03b7 = 1T and \u03bb \u2208 R are strictly better than [1]. We re-state the theorem here,\nTheorem 8. Recall that dh represents the difference of conditional means. Assume that ||dh||\u221e \u2264 L and consider T rounds of Alg 1 (in the paper). Let q\u0304 := 1T \u2211T t=1 qt and \u03bb\u0304 := 1 T \u2211T t=1 \u03bbt be the average plays of the q-player and the \u03bb-player respectively. Then, we have LT (q\u0304, \u03bb\u0304) \u2264 LT (q, \u03bb\u0304) + \u03bd and LT (q\u0304, \u03bb\u0304) \u2265 LT (q\u0304, \u03bb)\u2212 \u03bd, under the following conditions,\n\u2022 If \u03b7 = O( \u221a\nB2T L2(log T+1) ), \u03bd = O(\n\u221a B2L2(log T+1)\nT ); \u2200|\u03bb| \u2264 B, \u2200q \u2208 \u2206\n\u2022 If \u03b7 = 1T , \u03bd = O( L2(log T+1)2 T ); \u2200\u03bb \u2208 R, \u2200q \u2208 \u2206\nProof. Recall the definition of LT (q, \u03bb) from the paper,\nLT (q, \u03bb) = (\u2211\ni\nqiehi ) + \u03bb (\u2211\ni\nqidhi ) \u2212 1\n2\u03b7\n( \u03bb\u2212 \u03bbT )2 (11)\nFor the sake of this proof, let us define \u03b6T in the following way,\n\u03b6T (\u03bb) = 1\n2\u03b7 T\u2211 t=1 ( (\u03bb\u2212 \u03bbt)2 \u2212 (\u03bb\u2212 \u03bbT )2 + (\u03bbt \u2212 \u03bbT )2 ) (12)\nRecollect from (10) that \u03beT = \u03b7L2(log T + 1). We outline the proof as follows,\n1. First, we compute an upper bound on LT (q\u0304, \u03bb\u0304),\nLT (q\u0304, \u03bb\u0304) \u2264 LT (q, \u03bb\u0304) + \u03b6T (\u03bb\u0304) T + \u03beT T \u2200q \u2208 \u2206\nAlso, LT (q\u0304, \u03bb) \u2264 LT (q, \u03bb\u0304) + \u03b6T (\u03bb) T + \u03beT T \u2200\u03bb \u2208 R,\u2200q \u2208 \u2206\nAverage Play Upper Bound\n(13)\n(14)\n2. Next, we determine an lower bound on LT (q\u0304, \u03bb\u0304),\nLT (q\u0304, \u03bb\u0304) \u2265 LT (q\u0304, \u03bb)\u2212 \u03b6T (\u03bb) T \u2212 \u03beT T \u2200\u03bb \u2208 R\nAverage Play Lower Bound\n(15)\n3. We bound \u03b6T (\u03bb)T + \u03beT T for the case |\u03bb| \u2264 B and show that a \u03bd\u2212approximate saddle point is attained.\n4. We bound \u03b6T (\u03bb)T + \u03beT T for the case \u03bb \u2208 R and, again, show that \u03bd\u2212approximate saddle point is attained.\nWe write the proofs of the above fours parts one-by-one. Steps 1,2 in the above outline are intermediary results used to prove our main results in Steps 3,4. Reader can directly move to Steps 3,4 to see the main proof.\n1. Proof for the result on Average play Upper Bound\nLT (q, \u03bb\u0304) = \u2211 iqiehi + (\u2211 t\u03bbt T )(\u2211 iqidhi ) \u2212 1 2\u03b7 (\u2211 t\u03bbt T \u2212 \u03bbT )2 (16)\nExploiting convexity of 12\u03b7 (\u2211 t \u03bbt T \u2212 \u03bbT )2 via Jenson\u2019s Inequality,\n\u2265 1 T \u2211 t (\u2211 iqiehi + \u03bbt \u2211 iqidhi \u2212 1 2\u03b7 (\u03bbt \u2212 \u03bbT )2 ) (17)\nAs ht = argminqLT (q, \u03bbt), we have LT (q, \u03bbt) \u2265 LT (ht, \u03bbt), hence,\n\u2265 1 T \u2211 t ( eht + \u03bbtdht \u2212 1 2\u03b7 (\u03bbt \u2212 \u03bbT )2 ) (18)\nUsing the Cumulative Reward Bound (10),\n\u2265 \u2211 teht T + \u03bb \u2211 tdht T \u2212 1 T \u2211 t ( (\u03bb\u2212 \u03bbt)2 2\u03b7 + (\u03bbt \u2212 \u03bbT )2 2\u03b7 ) \u2212 \u03beT T\n(19)\nAdd and subtract 1T \u2211T t=1 1 2\u03b7 (\u03bb\u2212 \u03bbT ) 2, use \u03b6T from (12) and regroup the terms,\n= ( \u2211 iq\u0304iehi) + (\u03bb \u2211 iq\u0304idhi)\u2212 1\n2\u03b7 (\u03bb\u2212 \u03bbT )2 \u2212\n\u03b6T (\u03bb) T \u2212 \u03beT T\n(20)\n= LT (q\u0304, \u03bb)\u2212 \u03b6T (\u03bb) T \u2212 \u03beT T\n(21)\n2. Proof for the result on Average play Lower Bound Proof is similar to Step 1 so we skip the details. The proof involves finding a lower bound for LT (q\u0304, \u03bb) using the Cumulative Reward Bound (10). With simple algebraic manipulations and exploiting the convexity of LT (q\u0304, \u03bb) via the Jenson\u2019s inequality, we obtain the bound that we state."}, {"heading": "3. Proof for the case |\u03bb| \u2264 B", "text": "For the case |\u03bb| \u2264 B, we have \u03b6T (\u03bb) \u2264 B 2T \u03b7 , which gives,\n\u03b6T (\u03bb) T + \u03beT T \u2264 B\n2 \u03b7 + \u03b7L2(log T + 1) T (22)\nMinimizing R.H.S in (22) over \u03b7 gives us a \u03bd\u2212 approximate saddle point,\nLT (q\u0304, \u03bb\u0304) \u2264 LT (q, \u03bb\u0304) + \u03bd and LT (q\u0304, \u03bb\u0304) \u2265 LT (q\u0304, \u03bb)\u2212 \u03bd\nwhere \u03bd = 2\n\u221a B2L2(log T + 1)\nT and \u03b7 =\n\u221a B2T\nL2(log T + 1)\n\u03bd\u2212 approximate saddle point for |\u03bb| \u2264 B\n(23)\n(24)"}, {"heading": "4. Proof for the case \u03bb \u2208 R", "text": "We begin the proof by bounding \u03b6T (\u03bb)T + \u03beT T . Let \u03bb\u2217 = argmax\u03bbLT (q\u0304, \u03bb). We have a closed form for \u03bb\u2217 given by\n\u03bb\u2217 = \u03bbT + \u03b7 \u2211 iq\u0304idhi . Substituting \u03bb\u2217 in \u03b6T gives,\n\u03b6T (\u03bb\u2217) T + \u03beT T = 1 2\u03b7 1 T \u2211 t ( 2(\u03bbt \u2212 \u03bbT )2 + 2\u03b7(\u03bbT \u2212 \u03bbt)( \u2211 iq\u0304idhi) ) + \u03beT T\n(25)\nRecollect that \u03bbt+1\u2212\u03bbt = \u03b7t dht (from (8)). Using telescopic sum on \u03bbt, we get (\u03bbT\u2212\u03bbt) \u2264 \u03b7L(log T+1) and (\u03bbT\u2212\u03bbt) 2 \u2264 \u03b72L2(log T + 1)2. We substitute these in the previous equation (25),\n\u03b6T (\u03bb\u2217) T + \u03beT T \u2264 \u03b7L2(log T + 1)2 + \u03b7L2(log T + 1) + \u03b7L\n2(log T + 1)\nT (26)\nSetting \u03b7 = 1T , we get\n\u03b6T (\u03bb\u2217) T + \u03beT T \u2264 O(L\n2(log T + 1)2\nT ) := \u03bd (27)\nUsing (27), we prove the convergence of \u03bb in the following way, LT (q\u0304, \u03bb) \u2264 LT (q\u0304, \u03bb\u2217) ( as \u03bb\u2217 is the maximizer of LT (q\u0304, \u03bb) )\n(28)\n\u2264 LT (q\u0304, \u03bb\u0304) + \u03b6T (\u03bb\u2217) T + \u03beT T\n( Average Play Lower Bound ) (29)\n\u2264 LT (q\u0304, \u03bb\u0304) + \u03bd ( from (27) )\n(30)\nWe prove the convergence of q in the following way. For any \u03bb \u2208 R,\nLT (q, \u03bb\u0304) \u2265 LT (q\u0304, \u03bb\u2217)\u2212 \u03b6T (\u03bb\u2217) T \u2212 \u03beT T\n( Average Play Upper Bound (21) ) (31)\n\u2265 LT (q\u0304, \u03bb\u2217)\u2212 \u03bd ( from (27) )\n(32) \u2265 LT (q\u0304, \u03bb\u0304)\u2212 \u03bd ( as \u03bb\u2217 is the maximizer of LT (q\u0304, \u03bb) ) (33)\nTherefore,\nLT (q\u0304, \u03bb\u0304) \u2264 LT (q, \u03bb) + \u03bd and LT (q\u0304, \u03bb\u0304) \u2265 LT (q\u0304, \u03bb)\u2212 \u03bd where \u03bd = O ( L2(log T + 1)2\nT\n) and \u03b7 = 1\nT\n\u03bd\u2212 approximate saddle point for \u03bb \u2208 R\n(34)\n(35)\n8.3. More details on FairALM: DeepNet Classifier\nRecall that in \u00a7 5.2 in the paper, we identified a key difficulty when extending our algorithm to deep networks. The main issue is that the set of classifiers |H| is not a finite set. We argued that leveraging stochastic gradient descent (SGD) on an over-parameterized network eliminates this issue. When using SGD, few additional modifications of Alg 1 (in the paper) are helpful, such as replacing the non-differentiable indicator function 1[\u00b7] with a smooth surrogate function and computing the empirical estimates of the errors and conditional means denoted by e\u0302h(z)/\u00b5\u0302sh(z) respectively. These changes modify our objective to a form that is not a zero-sum game,\nmax \u03bb min w\n( e\u0302hw + \u03bb(\u00b5\u0302 s0 hw \u2212 \u00b5\u0302s1hw)\u2212 1 2\u03b7 (\u03bb\u2212 \u03bbt)2 ) (36)\nWe use DP constraint in (36), other fairness metrics discussed in the paper are valid as well. A closed-form solution for \u03bb can be achieved by solving an upper bound to (36) obtained by exchanging the \u201cmax\u201d/\u201cmin\u201d operations.\nmax \u03bb min w\n( e\u0302hw + \u03bb(\u00b5\u0302 s0 hw \u2212 \u00b5\u0302s1hw)\u2212 1 2\u03b7 (\u03bb\u2212 \u03bbt)2 ) (37)\n\u2264 min w max \u03bb\n( e\u0302hw + \u03bb(\u00b5\u0302 s0 hw \u2212 \u00b5\u0302s1hw)\u2212 1 2\u03b7 (\u03bb\u2212 \u03bbt)2 ) (38)\nSubstituting the closed form solution \u03bb = \u03bbt + \u03b7(\u00b5\u0302s0hw \u2212 \u00b5\u0302 s1 hw ) in (38),\n\u2264 min w\n( e\u0302hw + +\u03bbt(\u00b5\u0302 s0 hw \u2212 \u00b5\u0302s1hw) + \u03b7 2 (\u00b5\u0302s0hw \u2212 \u00b5\u0302 s1 hw )2 )\n(39)\nNote that the surrogate function defined within \u00b5\u0302shw is convex and non-negative, hence, we can exploit Jenson\u2019s inequality to eliminate the power 2 in (39) to give us a convenient upper bound,\n\u2264 min w\n( e\u0302hw + (\u03bbt + \u03b7)\u00b5\u0302 s0 hw \u2212 (\u03bbt \u2212 \u03b7)\u00b5\u0302s1hw ) (40)\nIn order to obtain a good minima in (40), it may be essential to run the SGD on (40) a few times: for ImSitu experiments, SGD was run on (40) for 5 times. We also gradually increase the parameter \u03b7 with time as \u03b7t = \u03b7t\u22121(1 + \u03b7\u03b2) for a small non-negative value for \u03b7\u03b2 , e.g., \u03b7\u03b2 \u2248 0.01. This is a common practice in augmented Lagrangian methods, see [5] (page 104). The overall algorithm is available in the paper as Alg. 2. The key primal and dual steps can be seen in the following section."}, {"heading": "8.4. Algorithm for baselines", "text": "We provide the primal and dual steps used for the baseline algorithms for the ImSitu experiments from the paper. The basic framework for all the baselines remains the same as Alg. 2 in the paper. For Proxy-Lagrangian, only the key ideas in [15] were adopted for implementation.\nPRIMAL: vt \u2208 \u2202e\u0302hw DUAL: None\nUnconstrained\nPRIMAL: vt \u2208 \u2202 ( e\u0302hw + \u03b7(\u00b5\u0302 s0 hw \u2212 \u00b5\u0302s1hw) 2 )\nDUAL: None Parameters: Penalty Parameter \u03b7\n`2 Penalty\nPRIMAL: vt \u2208 \u2202 ( e\u0302hw + \u03b70\u00b5\u0302 s0 hw + \u03b71\u00b5\u0302 s1 hw ) DUAL: None\nParameters: \u03b7i \u221d 1/(# samples in si)\nReweight\nPRIMAL: vt \u2208 \u2202 ( e\u0302hw + \u03bb 0\\1 t (\u00b5\u0302 s0 hw \u2212 \u00b5\u0302s1hw \u2212 ) + \u03bb 1\\0 t (\u00b5\u0302 s1 hw \u2212 \u00b5\u0302s0hw \u2212 ) ) DUAL: \u03bbi\\jt+1 \u2190 max ( 0, \u03bb i\\j t + \u03b7i\\j(\u00b5\u0302 si hw \u2212 \u00b5\u0302sjhw \u2212 )\n) Parameters: Dual step sizes \u03b70\\1, \u03b71\\0 Tol. \u2248 0.05. i\\j \u2208 {0\\1, 1\\0}\nLagrangian [44]\nPRIMAL: vt \u2208 \u2202 ( e\u0302hw + \u03bb 0\\1 t (\u00b5\u0302 s0 hw \u2212 \u00b5\u0302s1hw \u2212 ) + \u03bb 1\\0 t (\u00b5\u0302 s1 hw \u2212 \u00b5\u0302s0hw \u2212 ) ) DUAL: \u03b8i\\jt+1 \u2190 \u03b8 i\\j t + \u03b7i\\j(\u00b5\u0302 si hw \u2212 \u00b5\u0302sjhw \u2212 )\n\u03bb i\\j t+1 \u2190 B\nexp \u03b8 i\\j t+1\n1 + exp \u03b8 i\\j t+1 + exp \u03b8 j\\i t+1\nParameters: Dual step sizes \u03b70\\1/\u03b71\\0. Tol. \u2248 0.05, Hyperparam. B No surrogates in DUAL for \u00b5\u0302s0hw/\u00b5\u0302 s1 hw . i\\j \u2208 {0\\1, 1\\0}\nProxy-Lagrangian [15]\nPRIMAL: vt \u2208 \u2202 ( e\u0302hw(z) + (\u03bbt + \u03b7)\u00b5\u0302 s0 hw (z)\u2212 (\u03bbt \u2212 \u03b7)\u00b5\u0302s1hw(z) )\nDUAL: \u03bbt+1 \u2190 \u03bbt + \u03b7 ( \u00b5\u0302s0hw \u2212 \u00b5\u0302 s1 hw ) Parameters: Dual Step Size \u03b7\nFairALM"}, {"heading": "8.5. Supplementary Results on CelebA", "text": "Additional Results. The dual step size \u03b7 is a key parameter in FairALM training. Analogous to the dual step size \u03b7 we have the penalty parameter in `2 penalty training, also denoted by \u03b7. It can be seen from Figure 8 and Figure 9 that FairALM is more robust to different choices of \u03b7 than `2 penalty. The target class in this section is attractiveness and protected attribute is gender.\nMore Interpretability Results. We present the activation maps obtained when running the FairALM algorithm, unconstrained algorithm and the gender classification task. We show our results in Figure 10. The target class is attractiveness and protected attribute is gender. We threshold the maps to show only the most significant colors. The maps from gender classification task look at gender-revealing attributes such as presence of long-hair. The unconstrained model looks mostly at the entire image. FairALM looks at only a specific region of the face which is not gender revealing."}, {"heading": "8.6. Supplementary Results on ImSitu", "text": "Detailed Setup. We use the standard ResNet-18 architecture for the base model. We initialize the weights of the conv layers weights from ResNet-18 trained on ImageNet (ILSVRC). We train the model using SGD optimizer and a batch size of 256. For first few epochs (\u2248 20) only the linear layer is trained with a learning rate of 0.01/0.005. Thereafter, the entire model is trained end to end with a lower learning rate of 0.001/0.0005 till the accuracy plateaus.\nMeaning of Target class (+). Target class (+) is something that a classifier tries to predict from an image. Recall the basic notations \u00a7 2 from the paper, \u00b5si,tjh := \u00b5h|(s = si, t = tj) denotes the elementary conditional expectation of some function \u00b5h with respect to two random variables s, t. When we say we are imposing DEO for a target class tj we refer to imposing constraint on the difference in conditional expectation of the two groups of s for the class tj , that is, dh = \u00b5 s0,tj h \u2212 \u00b5 s1,tj h . For example, for Cooking (+) vs Driving (\u2212) problem when we say Cooking (+) is regarded as the target class we mean that tj = cooking and hence the DEO constraint is of the form dh = \u00b5 s0,cooking h \u2212 \u00b5 s1,cooking h .\nSupplementary Training Profiles. We plot the test set errors and the DEO measure during the course of training for the verb pair classifications reported in the paper. We compare against the baselines discussed in Table 1 of the paper. The plots in Fig. 11 below supplement Fig. 5 in the paper.\nAdditional qualitative results We show the activation maps in Fig. 12 to illustrate that the features used by FairALM model are more aligned with the action/verb present in the image and are not gender leaking. The verb pairs have been chosen randomly from the list provided in [44]. In all the cases Gender is considered as the protected attribute. The activation maps\nare regulated to show colors above a fixed threshold in order to highlight the most significant regions used by a model to make a prediction."}], "title": "FairALM: Augmented Lagrangian Method for Training Fair Models with Little Regret", "year": 2020}